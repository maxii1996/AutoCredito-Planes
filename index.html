<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Plan Manager 2025</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css">
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
</head>
<body>
  <div class="app-shell">
    <aside class="sidebar">
      <div class="brand">
        <div class="brand-icon"></div>
        <div>
          <p class="brand-title">Asesor:</p>
          <p class="brand-subtitle" id="sidebarAdvisor">Planes de Ahorro Argentina</p>
        </div>
      </div>
      <nav class="nav">
        <button class="nav-link active" data-target="dashboard"><i class='bx bxs-dashboard'></i><span class="label"> Inicio</span></button>
        <button class="nav-link" data-target="clientManager"><i class='bx bx-group'></i><span class="label"> Gestor de Clientes</span></button>
        <button class="nav-link" data-target="scheduledClients"><i class='bx bx-calendar-check'></i><span class="label"> Clientes Programados</span></button>
        <button class="nav-link" data-target="templates"><i class='bx bx-message-dots'></i><span class="label"> Plantillas</span></button>
        <button class="nav-link" data-target="plans"><i class='bx bx-notepad'></i><span class="label"> Cotizaciones</span></button>
        <button class="nav-link" data-target="quoteGenerator" id="myQuotesToggle"><i class='bx bx-folder'></i><span class="label"> Mis Cotizaciones</span></button>
        <button class="nav-link" data-target="vehicles"><i class='bx bx-car'></i><span class="label"> Autos y Valores</span></button>
      </nav>
     
    </aside>
    <main class="content">
      <header class="topbar">
        <div class="title-area">
          <button id="sidebarToggle" class="ghost-btn icon-only menu-toggle" title="Mostrar u ocultar men煤"><i class='bx bx-menu-alt-left'></i></button>
          <div>
            <h1 id="sectionTitle">Inicio</h1>
          </div>
        </div>
        <div class="top-actions">
          <div class="client-file-actions">
            <label class="secondary-btn upload-btn" title="Subir archivo Excel"><i class='bx bx-upload'></i> Importar Excel<input type="file" id="clientExcel" accept=".xlsx,.xls,.csv"></label>
            <button id="exportClients" class="ghost-btn" title="Exportar clientes filtrados"><i class='bx bx-download'></i>Exportar</button>
          </div>
          <div class="menu-cluster">
            <div class="action-menu" id="actionMenu">
              <button class="menu-trigger primary" id="actionMenuToggle"><i class='bx bx-collection'></i><span>Mi Perfil</span><i class='bx bx-chevron-down'></i></button>
              <div class="menu-panel" id="actionMenuPanel">
                <div class="menu-head">
                  <p class="eyebrow">Mi Perfil</p>
                  <h4>Mi Perfil</h4>
                </div>
                                <label class="menu-item upload-btn"><i class='bx bx-upload'></i> Importar perfil<input type="file" id="importProfile" accept="application/json"></label>
                <button id="exportProfile" class="menu-item"><i class='bx bx-download'></i> Exportar perfil</button>
              </div>
            </div>
            <div class="icon-menu" id="settingsMenu">
              <button class="menu-trigger ghost" id="settingsToggle" title="Centro de control"><i class='bx bx-cog'></i><span>Opciones</span><i class='bx bx-dots-vertical-rounded'></i></button>
              <div class="menu-panel" id="settingsPanel">
                <div class="menu-head">
                  <p class="eyebrow">Opciones</p>
                  <h4>Opciones</h4>
                </div>
                <button class="menu-item" id="openPreferences"><i class='bx bx-slider-alt'></i> Mis preferencias</button>
                <button class="menu-item" id="clearStorage"><i class='bx bx-trash'></i> Limpiar datos locales</button>
                <button class="menu-item" id="resetDefaults"><i class='bx bx-refresh'></i> Restaurar valores base</button>
              </div>
            </div>
          </div>
        </div>
      </header>

      <section id="dashboard" class="panel active">
        <div class="dashboard-hero" id="welcomeHero">
            <div class="hero-main modern">
              <div class="eyebrow">Inicio</div>
              <h2 id="dashboardHeading">Control principal</h2>
              <p class="muted" id="dashboardSubtitle">Define qui茅n atiende y ajusta tu jornada.</p>
              <div class="advisor-card">
                <div class="field">
                  <label for="advisorInput">Nombre del vendedor</label>
                  <div class="advisor-input">
                    <input id="advisorInput" list="advisorSuggestions" placeholder="Ej: Sof铆a Alvarez" />
                    <datalist id="advisorSuggestions"></datalist>
                  </div>
                </div>
              <p class="muted tiny" id="advisorHelper">Selecciona el nombre de Vendedor que quieres utilizar para Primer Contacto.</p>
              </div>
            <div class="hero-actions tight">
              <button class="primary-btn" data-jump="clientManager"><i class='bx bx-group'></i>Gestor de clientes</button>
              <button class="secondary-btn" data-jump="plans"><i class='bx bx-notepad'></i>Crear plan</button>
              <button class="ghost-btn" data-jump="templates"><i class='bx bx-message-dots'></i>Plantillas</button>
            </div>
          </div>
          <div class="hero-side metrics">
            <div class="stat-tiles">
              <div class="tile" data-tone="blue">
                <div class="tile-icon"></div>
                <div>
                  <p class="label">Plantillas</p>
                  <p class="value" id="templateCount">0</p>
                </div>
              </div>
              <div class="tile" data-tone="green">
                <div class="tile-icon"></div>
                <div>
                  <p class="label">Registros de clientes</p>
                  <p class="value" id="clientCount">0</p>
                </div>
              </div>
            </div>
            <div class="scheduled-summary-card">
              <p class="label">Total Clientes Programados</p>
              <p class="value" id="scheduledTotalCount">0</p>
              <div class="scheduled-summary-row">
                <span>Clientes Programados para hoy:</span>
                <strong id="scheduledTodayCount">0</strong>
              </div>
              <button class="secondary-btn mini" data-jump="scheduledClients"><i class='bx bx-right-arrow-alt'></i>Ir a Clientes Programados</button>
            </div>
          </div>
        </div>

      </section>

      <section id="templates" class="panel">
        <div class="panel-head">
          <div>
            <p class="eyebrow">Plantillas con variables</p>
            <h2>Gestor de Plantillas</h2>
            <p class="muted subtle">Permite modificar, editar y crear nuevas plantillas para copiar y utilizar r谩pidamente en los mensajes.</p>
          </div>
          <div class="actions">
            <div class="search-field">
              <i class='bx bx-search'></i>
              <input id="templateSearch" placeholder="Buscar plantillas" />
            </div>
            <button id="addTemplate" class="ghost-btn"><i class='bx bx-plus'></i>Nueva plantilla</button>
          </div>
        </div>
        <div class="templates-layout">
          <aside class="template-list" id="templateList"></aside>
          <div class="template-editor">
            <div class="preview-stack">
              <div class="preview-box">
                <p class="eyebrow">Previsualizaci贸n</p>
                <pre id="templatePreview"></pre>
              </div>
              <div class="actions compact">
                <div class="autosave-hint">Guardado en tiempo real</div>
                <button id="copyTemplate" class="secondary-btn"><i class='bx bx-copy'></i>Copiar esta plantilla</button>
                <span id="copyStatus" class="muted"></span>
              </div>
            </div>
            <div class="field">
              <label for="templateTitle">T铆tulo</label>
              <input id="templateTitle" placeholder="Ej: Mensaje de inicio" />
            </div>
            <div class="field textarea-field">
              <label for="templateBody">Contenido</label>
              <div class="textarea-shell">
                <textarea id="templateBody" rows="10" placeholder="Escribe el mensaje con variables"></textarea>
                <div class="chips inline" id="variableChips"></div>
              </div>
            </div>
            <div class="variables-head">
              <p class="eyebrow">Variables activas</p>
              <p class="muted tiny">Solo las que est谩n en el mensaje.</p>
            </div>
            <div class="variable-grid" id="variableInputs"></div>
          </div>
        </div>
      </section>

      <section id="vehicles" class="panel">
        <div class="panel-head">
          <div>
            <p class="eyebrow">Productos y precios</p>
            <h2>Gestor de Productos y Precios</h2>
            <p class="muted">Te damos la bienvenida al Gestor de Productos y Precios.</p>
            <p class="muted subtle" id="vehicleUpdateTag">ltima actualizaci贸n: Diciembre 2025</p>
          </div>
          <div class="toggles">
            <div class="field compact">
              <label for="vehicleBrandFilter">Filtrar por marca</label>
              <select id="vehicleBrandFilter"></select>
            </div>
            <button id="viewOnlineFiles" class="ghost-btn" type="button"><i class='bx bx-cloud'></i>Ver archivos online</button>
          </div>
        </div>
        <div class="price-tabs">
          <div class="tab-manager">
            <div>
              <p class="eyebrow">Marcas de precios detectadas</p>
              <p class="muted tiny" id="priceTabSubtitle">Precios en modo local</p>
            </div>
            <div id="priceAlerts" class="alert-stack compact"></div>
            <div class="actions compact price-selector">
              <div class="field compact">
                <label for="priceTabSelect">Lista disponible</label>
                <select id="priceTabSelect"></select>
              </div>
              <button class="ghost-btn" id="openVehicleEditor" type="button"><i class='bx bx-edit'></i>Modo editor</button>
            </div>
          </div>
        </div>
        <div class="vehicle-table-stack" id="vehicleTables"></div>
      </section>

      <section id="plans" class="panel">
        <div class="panel-head">
          <div>
            <p class="muted subtle">Simulador de Cotizaciones <br><h5>Advertencia: Esto es meramente experimental:</h5> Las cotizaciones se recomienda hacerlas a mano con la informaci贸n aprendida.</p>
          </div>
          <div class="actions">
            <button id="saveClient" class="primary-btn"><i class='bx bx-save'></i>Guardar cotizaci贸n</button>
            <button id="addQuoteToMyQuotes" class="secondary-btn" type="button"><i class='bx bx-file'></i>Agregar a "Mis Cotizaciones"</button>
            <button id="copyQuote" class="secondary-btn" type="button"><i class='bx bx-copy'></i>Copiar cotizaci贸n</button>
            <button id="openQuoteModal" class="ghost-btn" type="button"><i class='bx bx-archive'></i>Ver cotizaciones guardadas</button>
          </div>
        </div>
        <div class="resource-row">
          <div class="resource-card">
            <div class="resource-preview" style="background-image:url('img/Template/InfoAuto.jpg');"></div>
            <div class="resource-meta">
              <p class="eyebrow">Logo InfoAuto</p>
              <p class="muted tiny">salo como imagen de respaldo en env铆os al cliente.</p>
            </div>
            <div class="actions compact">
              <button id="viewInfoAuto" class="ghost-btn" type="button"><i class='bx bx-show'></i>Ver imagen</button>
              <button id="downloadInfoAuto" class="secondary-btn" type="button"><i class='bx bx-download'></i>Descargar</button>
            </div>
          </div>
          <div class="resource-card">
            <div class="resource-preview" style="background-image:url('img/Template/FotosReferenciaParaCliente.jpg');"></div>
            <div class="resource-meta">
              <p class="eyebrow">Imagen de referencia</p>
              <p class="muted tiny">Desc谩rgala para compartir junto a la cotizaci贸n.</p>
            </div>
            <div class="actions compact">
              <button id="viewClientReference" class="ghost-btn" type="button"><i class='bx bx-show'></i>Ver imagen</button>
              <button id="downloadClientReference" class="secondary-btn" type="button"><i class='bx bx-download'></i>Descargar imagen de Referencia para cliente</button>
            </div>
          </div>
        </div>
        <div class="quote-layout">
          <aside class="card form quote-form">
            <div class="card-head compact">
              <p class="eyebrow">Carga r谩pida</p>
              <h3>Datos de cotizaci贸n</h3>
            </div>
            <div class="field">
              <label for="clientName">Cliente</label>
              <div class="picker-row dense">
                <input id="clientName" placeholder="Nombre y apellido" />
                <button id="openClientPicker" class="secondary-btn mini" type="button"><i class='bx bx-user-voice'></i>Cliente</button>
              </div>
              <p class="muted tiny" id="selectedClientHint">Puedes escribir los datos o aplicar uno importado.</p>
            </div>
            <div class="form-grid three">
              <div class="field">
                <div class="label-row">
                  <label for="planModel">Auto a cotizar</label>
                  <span class="muted tiny micro-tag" id="priceContextTag">Utilizando precios de: Diciembre 2025</span>
                </div>
                <select id="planModel"></select>
              </div>
              <div class="field readonly">
                <label>Plan asignado autom谩ticamente</label>
                <div class="plan-profile-cell readonly">
                  <span class="chip muted" id="planProfileChip"></span>
                  <small class="muted tiny" id="planProfileHelper">El plan se selecciona solo seg煤n el modelo.</small>
                </div>
                <input type="hidden" id="planType" value="85a120" />
              </div>
              <div class="field">
                <label class="toggle compact">
                  <input type="checkbox" id="tradeIn" checked>
                  <span>Entrega llave x llave</span>
                </label>
                <div class="money-field">
                  <span class="prefix">$</span>
                  <input id="tradeInValue" class="money" type="text" inputmode="numeric" placeholder="Valor estimado usado" />
                </div>
              </div>
            </div>
            <div class="form-grid two">
              <div class="field">
                <label for="customPrice">Ingresa el Valor del coche a Cotizar</label>
                <div class="money-field">
                  <span class="prefix">$</span>
                  <input id="customPrice" class="money" type="text" inputmode="numeric" placeholder="Valor del coche a cotizar" />
                </div>
              </div>
              <div class="field readonly">
                <label>Integraci贸n posible</label>
                <div class="integration-details" id="integrationDetails">
                  <p id="integration1">1 cuota promocionada: $0</p>
                  <p id="integration3">3 cuotas "sin inter茅s" de: $0 cada una</p>
                  <p id="integration6">6 cuotas "sin inter茅s" de: $0 cada una</p>
                </div>
                <input type="hidden" id="appliedReservation" value="1" />
              </div>
            </div>
            <div class="field-group compact">
              <div class="field-head">
                <div>
                  <p class="eyebrow">Reservas editables</p>
                  <p class="muted tiny">Valores del mes traducidos de la lista oficial.</p>
                </div>
                <div class="reservation-actions">
                  <button id="calcReservation3" class="ghost-btn mini" type="button"><i class='bx bx-calculator'></i>3 cuotas</button>
                  <button id="calcReservation6" class="ghost-btn mini" type="button"><i class='bx bx-math'></i>6 cuotas</button>
                </div>
              </div>
              <div class="reservation-grid compact">
                <div class="field">
                  <label for="reservation1">1 cuota</label>
                  <div class="money-field">
                    <span class="prefix">$</span>
                    <input id="reservation1" class="money" type="text" inputmode="numeric" placeholder="Reserva 煤nica" />
                  </div>
                </div>
                <div class="field">
                  <label for="reservation3">3 cuotas</label>
                  <div class="money-field">
                    <span class="prefix">$</span>
                    <input id="reservation3" class="money" type="text" inputmode="numeric" placeholder="Reserva 3 pagos" />
                  </div>
                </div>
                <div class="field">
                  <label for="reservation6">6 cuotas</label>
                  <div class="money-field">
                    <span class="prefix">$</span>
                    <input id="reservation6" class="money" type="text" inputmode="numeric" placeholder="Reserva 6 pagos" />
                  </div>
                </div>
              </div>
            </div>
            <div class="field">
              <label for="notes">Observaciones</label>
              <textarea id="notes" rows="3" placeholder="Chevrolet Onix LTZ Febrero 2026"></textarea>
            </div>
          </aside>

          <div class="quote-details">
            <section class="plan-folio">
              <div class="folio-head">
                <div>
                  <p class="eyebrow">Detalle simplificado</p>
                  <h3>Folleto del plan</h3>
                </div>
                <div class="folio-switch">
                  <label class="toggle">
                    <input type="checkbox" id="advancePayments">
                    <span>驴El cliente quiere adelantar cuotas?</span>
                  </label>
                  <div class="money-field compact" id="advanceAmountField">
                    <span class="prefix">$</span>
                    <input id="advanceAmount" class="money" type="text" inputmode="numeric" placeholder="Monto a adelantar" />
                  </div>
                  <p class="muted tiny">Si adelanta, se descuentan las 煤ltimas cuotas primero usando la cuota pura.</p>
                </div>
              </div>
              <div class="folio-cta-row">
                <button id="openInstallmentBreakdown" class="secondary-btn" type="button"><i class='bx bx-list-ol'></i>Ver desglose completo</button>
              </div>
              <div class="folio-body">
                <div class="folio-section">
                  <h4>Datos principales</h4>
                  <div id="planBasicsList" class="folio-list"></div>
                </div>
                <div class="folio-section">
                  <h4>Integraci贸n y cuota 1</h4>
                  <div id="planIntegrationSummary" class="folio-list"></div>
                </div>
              </div>
              <div class="folio-body">
                <div class="folio-section">
                  <h4>Saldo y aportes</h4>
                  <div id="planBalanceSummary" class="folio-list"></div>
                </div>
                <div class="folio-section">
                  <h4>Cuotas por tramo</h4>
                  <div id="planRangeList" class="range-grid"></div>
                </div>
              </div>
              <div class="folio-section wide">
                <h4>Estado de cuotas</h4>
                <div id="planCoverageList" class="coverage-grid"></div>
              </div>
            </section>
          </div>
        </div>
      </section>
      <section id="quoteGenerator" class="panel quote-generator-panel" data-view="hub">
        <div class="panel-head">
          <div>
            <h2>Mis Cotizaciones</h2>
          </div>
          <div class="actions">
            <button id="quoteGeneratorDeleteActive" class="ghost-btn danger" type="button"><i class='bx bx-trash'></i>Eliminar esta cotizaci贸n</button>
            <div class="export-actions">
              <button id="quoteGeneratorExportPdf" class="secondary-btn" type="button"><i class='bx bxs-file-pdf'></i>Exportar PDF</button>
              <button id="quoteGeneratorExportPng" class="ghost-btn" type="button"><i class='bx bx-image'></i>Exportar PNG</button>
            </div>
          </div>
        </div>
        <div class="quote-generator-shell">
          <section class="quote-generator-hub" id="quoteGeneratorHub">
            <div class="card quote-hub-card">
              <div class="card-head">
                <div>
                  <p class="eyebrow">Mis Cotizaciones</p>
                  <h3>Gestiona tus cotizaciones</h3>
                </div>
                <div class="actions">
                  <button id="quoteGeneratorCreate" class="primary-btn" type="button"><i class='bx bx-plus'></i>Nueva cotizaci贸n</button>
                </div>
              </div>
              <div class="quote-hub-empty" id="quoteGeneratorEmpty">
                <i class='bx bx-folder-open'></i>
                <div>
                  <h4>No tienes actualmente ninguna Cotizaci贸n abierta</h4>
                  <p class="muted">Crea una nueva cotizaci贸n o importa una existente para comenzar.</p>
                </div>
              </div>
              <div class="quote-hub-list" id="quoteGeneratorList"></div>
            </div>
          </section>
          <section class="quote-generator-workspace is-hidden" id="quoteGeneratorWorkspace">
            <div class="quote-generator-layout">
              <aside class="card quote-generator-form" id="quoteGeneratorForm">
            <div class="card-head compact">
              <p class="eyebrow">Panel de control</p>
              <h3>Datos principales</h3>
            </div>
            <div class="quote-tabs">
              <div class="quote-tabs-nav" role="tablist" aria-label="Secciones de la cotizaci贸n">
                <button class="quote-tab active" id="quote-tab-btn-main" type="button" data-tab-target="quote-tab-main" role="tab" aria-selected="true" aria-controls="quote-tab-main" title="Datos principales" aria-label="Datos principales">
                  <i class='bx bx-detail' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-client" type="button" data-tab-target="quote-tab-client" role="tab" aria-selected="false" aria-controls="quote-tab-client" title="Datos cliente" aria-label="Datos cliente">
                  <i class='bx bx-user' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-vehicle" type="button" data-tab-target="quote-tab-vehicle" role="tab" aria-selected="false" aria-controls="quote-tab-vehicle" title="Veh铆culo usado" aria-label="Veh铆culo usado">
                  <i class='bx bx-car' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-new-vehicle" type="button" data-tab-target="quote-tab-new-vehicle" role="tab" aria-selected="false" aria-controls="quote-tab-new-vehicle" title="Nuevo veh铆culo" aria-label="Nuevo veh铆culo">
                  <i class='bx bx-plus-circle' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-payments" type="button" data-tab-target="quote-tab-payments" role="tab" aria-selected="false" aria-controls="quote-tab-payments" title="Esquema de pagos" aria-label="Esquema de pagos">
                  <i class='bx bx-credit-card' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-prequote" type="button" data-tab-target="quote-tab-prequote" role="tab" aria-selected="false" aria-controls="quote-tab-prequote" title="Seleccionar modo de cotizaci贸n" aria-label="Seleccionar modo de cotizaci贸n">
                  <i class='bx bx-toggle-left' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-notes" type="button" data-tab-target="quote-tab-notes" role="tab" aria-selected="false" aria-controls="quote-tab-notes" title="Notas" aria-label="Notas">
                  <i class='bx bx-note' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-extras" type="button" data-tab-target="quote-tab-extras" role="tab" aria-selected="false" aria-controls="quote-tab-extras" title="Beneficios y gastos" aria-label="Beneficios y gastos">
                  <i class='bx bx-edit' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-visibility" type="button" data-tab-target="quote-tab-visibility" role="tab" aria-selected="false" aria-controls="quote-tab-visibility" title="Visibilidad" aria-label="Visibilidad">
                  <i class='bx bx-show' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-storage" type="button" data-tab-target="quote-tab-storage" role="tab" aria-selected="false" aria-controls="quote-tab-storage" title="Guardar y cargar" aria-label="Guardar y cargar">
                  <i class='bx bx-save' aria-hidden="true"></i>
                </button>
              </div>
              <div class="quote-tabs-panels">
                <section class="quote-tab-panel active" id="quote-tab-main" role="tabpanel" aria-labelledby="quote-tab-btn-main">
                  <div class="form-grid two">
                    <div class="field">
                      <label for="quoteNumber">Cotizaci贸n #</label>
                      <div class="auto-row">
                        <input id="quoteNumber" data-quote-field="meta.quoteNumber" placeholder="00000000" />
                        <button class="ghost-btn mini auto-btn" data-auto-field="meta.quoteNumber" type="button">Auto</button>
                      </div>
                    </div>
                    <div class="field">
                      <label for="quoteDate">Fecha de Cotizaci贸n</label>
                      <div class="auto-row">
                        <input id="quoteDate" data-quote-field="meta.quoteDate" placeholder="dd/mm/aaaa" />
                        <button class="ghost-btn mini auto-btn" data-auto-field="meta.quoteDate" type="button">Auto</button>
                      </div>
                    </div>
                    <div class="field">
                      <label for="quoteExpiry">Vencimiento</label>
                      <div class="auto-row">
                        <input id="quoteExpiry" data-quote-field="meta.quoteExpiry" placeholder="dd/mm/aaaa" />
                        <button class="ghost-btn mini auto-btn" data-auto-field="meta.quoteExpiry" type="button">Auto</button>
                      </div>
                    </div>
                    <div class="field">
                      <label for="quoteAdvisor">Asesor Comercial</label>
                      <div class="auto-row">
                        <input id="quoteAdvisor" data-quote-field="meta.advisor" placeholder="Nombre del asesor" />
                        <button class="ghost-btn mini auto-btn" data-auto-field="meta.advisor" type="button">Auto</button>
                      </div>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-client" role="tabpanel" aria-labelledby="quote-tab-btn-client">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Datos Cliente</p>
                        <p class="muted tiny">Completa manualmente o usa autom谩tico.</p>
                      </div>
                      <div class="actions compact">
                        <button class="ghost-btn mini auto-btn" data-auto-fill="client" type="button">Auto cliente</button>
                      </div>
                    </div>
                    <div class="form-grid two">
                      <div class="field required">
                        <label for="clientFullName">Nombre <span class="required-tag">Obligatorio</span></label>
                        <div class="auto-row">
                          <input id="clientFullName" data-quote-field="client.name" placeholder="Nombre completo" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="client.name" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field required">
                        <label for="clientDni">DNI <span class="required-tag">Obligatorio</span></label>
                        <div class="auto-row">
                          <input id="clientDni" data-quote-field="client.dni" placeholder="00.000.000" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="client.dni" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field required">
                        <label for="clientCuil">CUIL <span class="required-tag">Obligatorio</span></label>
                        <div class="auto-row">
                          <input id="clientCuil" data-quote-field="client.cuil" placeholder="20-00000000-0" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="client.cuil" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field required">
                        <label for="clientCel">CEL <span class="required-tag">Obligatorio</span></label>
                        <div class="auto-row">
                          <input id="clientCel" data-quote-field="client.cel" placeholder="+54 9 11 0000 0000" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="client.cel" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field">
                        <label for="clientProvince">Provincia</label>
                        <div class="auto-row">
                          <input id="clientProvince" data-quote-field="client.province" placeholder="Provincia" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="client.province" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field">
                        <label for="clientCity">Localidad</label>
                        <div class="auto-row">
                          <input id="clientCity" data-quote-field="client.city" placeholder="Localidad" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="client.city" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field">
                        <label for="clientPostal">CP</label>
                        <div class="auto-row">
                          <input id="clientPostal" data-quote-field="client.postalCode" placeholder="0000" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="client.postalCode" type="button">Auto</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-vehicle" role="tabpanel" aria-labelledby="quote-tab-btn-vehicle">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Datos Veh铆culo</p>
                        <p class="muted tiny">Veh铆culo a entregar y valores de referencia.</p>
                      </div>
                      <div class="actions compact">
                        <button class="ghost-btn mini auto-btn" data-auto-fill="vehicle" type="button">Auto veh铆culo</button>
                      </div>
                    </div>
                    <div class="form-grid two">
                      <div class="field required">
                        <label for="vehicleBrand">Marca <span class="required-tag">Obligatorio</span></label>
                        <div class="auto-row">
                          <input id="vehicleBrand" list="quoteBrandSuggestions" data-quote-field="vehicle.brand" placeholder="Marca" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="vehicle.brand" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field required">
                        <label for="vehicleModel">Modelo y Versi贸n <span class="required-tag">Obligatorio</span></label>
                        <div class="auto-row">
                          <input id="vehicleModel" data-quote-field="vehicle.model" placeholder="Modelo y versi贸n" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="vehicle.model" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field">
                        <label for="vehicleYear">A帽o</label>
                        <input id="vehicleYear" data-quote-field="vehicle.year" placeholder="2024" />
                      </div>
                      <div class="field">
                        <label for="vehiclePlate">Patente</label>
                        <input id="vehiclePlate" data-quote-field="vehicle.plate" placeholder="ABC123" />
                      </div>
                      <div class="field">
                        <label for="vehicleKms">Kms</label>
                        <input id="vehicleKms" data-quote-field="vehicle.kms" placeholder="0 km" />
                      </div>
                      <div class="field">
                        <label for="vehicleFactoryPriceLabel">Texto del precio cotizado</label>
                        <input id="vehicleFactoryPriceLabel" data-quote-field="vehicle.factoryPriceLabel" placeholder="Precio cotizado por F谩brica" />
                      </div>
                      <div class="field">
                        <label for="vehicleFactoryPrice">Monto del precio cotizado</label>
                        <div class="money-field">
                          <span class="prefix">$</span>
                          <input id="vehicleFactoryPrice" class="money" type="text" inputmode="numeric" data-quote-field="vehicle.factoryPrice" placeholder="0" />
                        </div>
                      </div>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-new-vehicle" role="tabpanel" aria-labelledby="quote-tab-btn-new-vehicle">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Datos nuevo Veh铆culo</p>
                        <p class="muted tiny">Informaci贸n del 0km.</p>
                      </div>
                      <div class="actions compact">
                        <button class="ghost-btn mini auto-btn" data-auto-fill="newVehicle" type="button">Auto 0km</button>
                      </div>
                    </div>
                    <div class="form-grid two">
                      <div class="field required">
                        <label for="newVehicleBrand">Marca <span class="required-tag">Obligatorio</span></label>
                        <div class="auto-row">
                          <input id="newVehicleBrand" list="quoteBrandSuggestions" data-quote-field="newVehicle.brand" placeholder="Marca" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="newVehicle.brand" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field required">
                        <label for="newVehicleModel">Modelo y Versi贸n <span class="required-tag">Obligatorio</span></label>
                        <div class="auto-row">
                          <input id="newVehicleModel" data-quote-field="newVehicle.model" placeholder="Modelo y versi贸n" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="newVehicle.model" type="button">Auto</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-payments" role="tabpanel" aria-labelledby="quote-tab-btn-payments">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Cuota pura</p>
                        <p class="muted tiny">Valor base que se imprime como una cuota adicional.</p>
                      </div>
                      <div class="actions compact">
                        <button class="ghost-btn mini auto-btn" data-auto-cuota-pura type="button">Auto cuota pura</button>
                      </div>
                    </div>
                    <div class="form-grid two">
                      <div class="field">
                        <label for="quoteCuotaPuraAmount">Monto</label>
                        <div class="money-field">
                          <span class="prefix">$</span>
                          <input id="quoteCuotaPuraAmount" class="money" type="text" inputmode="numeric" data-quote-field="cuotaPura.amount" placeholder="0" />
                        </div>
                      </div>
                      <div class="field">
                        <label for="quoteCuotaPuraDetail">Detalle</label>
                        <input id="quoteCuotaPuraDetail" data-quote-field="cuotaPura.detail" placeholder="Ej: Cuota pura base del plan" />
                      </div>
                    </div>
                  </div>
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Esquema de pagos</p>
                        <p class="muted tiny">Agrega o edita tramos seg煤n tu propuesta.</p>
                      </div>
                      <div class="actions compact">
                        <button class="ghost-btn mini auto-btn" data-auto-payments type="button">Auto esquema</button>
                        <button class="secondary-btn mini" id="addPaymentRow" type="button"><i class='bx bx-plus'></i>Agregar cuota</button>
                      </div>
                    </div>
                    <div id="paymentRows" class="payment-rows"></div>
                  </div>
                  <div class="bonified-options">
                  <div class="field-group compact bonified-option">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Opci贸n 1: 1 Pago Bonificado</p>
                        <p class="muted tiny">Configura la bonificaci贸n y el valor percibido por el cliente.</p>
                      </div>
                    </div>
                    <div class="form-grid two">
                      <div class="field">
                        <label for="bonifiedOneOriginal">Valor Original</label>
                        <div class="money-field">
                          <span class="prefix">$</span>
                          <input id="bonifiedOneOriginal" class="money" type="text" inputmode="numeric" data-quote-field="bonifiedPayments.one.fakeOriginal" placeholder="0" />
                        </div>
                      </div>
                      <div class="field bonified-bonification-field">
                        <label for="bonifiedOneDiscount">Bonif.</label>
                        <div class="money-field">
                          <span class="prefix">$</span>
                          <input id="bonifiedOneDiscount" class="money" type="text" inputmode="numeric" data-quote-field="bonifiedPayments.one.bonification" placeholder="0" readonly disabled />
                        </div>
                      </div>
                      <div class="field">
                        <label for="bonifiedOneConcept">Concepto (interno)</label>
                        <input id="bonifiedOneConcept" data-quote-field="bonifiedPayments.one.concept" placeholder="Ej: Bonificaci贸n contado" />
                      </div>
                      <div class="field">
                        <label for="bonifiedOneAmount">A pagar (1 pago)</label>
                        <div class="auto-row">
                          <div class="money-field">
                            <span class="prefix">$</span>
                            <input id="bonifiedOneAmount" class="money" type="text" inputmode="numeric" data-quote-field="bonifiedPayments.one.amount" placeholder="0" />
                          </div>
                          <button class="ghost-btn mini auto-btn" data-auto-bonified="one" type="button">Recargar</button>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="field-group compact bonified-option">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Opci贸n 2: 3 cuotas sin interes</p>
                        <p class="muted tiny">Aplica una bonificaci贸n distinta para pagos fraccionados.</p>
                      </div>
                    </div>
                    <div class="form-grid two">
                      <div class="field">
                        <label for="bonifiedThreeOriginal">Valor Original</label>
                        <div class="money-field">
                          <span class="prefix">$</span>
                          <input id="bonifiedThreeOriginal" class="money" type="text" inputmode="numeric" data-quote-field="bonifiedPayments.three.fakeOriginal" placeholder="0" />
                        </div>
                      </div>
                      <div class="field bonified-bonification-field">
                        <label for="bonifiedThreeDiscount">Bonif.</label>
                        <div class="money-field">
                          <span class="prefix">$</span>
                          <input id="bonifiedThreeDiscount" class="money" type="text" inputmode="numeric" data-quote-field="bonifiedPayments.three.bonification" placeholder="0" readonly disabled />
                        </div>
                      </div>
                      <div class="field">
                        <label for="bonifiedThreeConcept">Concepto (interno)</label>
                        <input id="bonifiedThreeConcept" data-quote-field="bonifiedPayments.three.concept" placeholder="Ej: Bonificaci贸n 3 pagos" />
                      </div>
                      <div class="field">
                        <label for="bonifiedThreeAmount">A pagar (3 pagos)</label>
                        <div class="auto-row">
                          <div class="money-field">
                            <span class="prefix">$</span>
                            <input id="bonifiedThreeAmount" class="money" type="text" inputmode="numeric" data-quote-field="bonifiedPayments.three.amount" placeholder="0" />
                          </div>
                          <button class="ghost-btn mini auto-btn" data-auto-bonified="three" type="button">Recargar</button>
                        </div>
                      </div>
                    </div>
                  </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-prequote" role="tabpanel" aria-labelledby="quote-tab-btn-prequote">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Seleccionar modo de cotizaci贸n</p>
                        <p class="muted tiny">Activa el modo Pre-Cotizaci贸n cuando necesites validaciones adicionales.</p>
                      </div>
                    </div>
                    <label class="toggle inline">
                      <input type="checkbox" id="preQuoteEnabled" data-quote-field="preQuote.enabled">
                      <span>Activar modo Pre Cotizaci贸n</span>
                    </label>
                    <div class="field textarea-field">
                      <label for="preQuoteMessage">Mensaje visible en el documento</label>
                      <textarea id="preQuoteMessage" data-quote-field="preQuote.message" rows="4" placeholder="Escribe la leyenda para el cliente."></textarea>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-notes" role="tabpanel" aria-labelledby="quote-tab-btn-notes">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Notas</p>
                        <p class="muted tiny">Informaci贸n adicional del documento.</p>
                      </div>
                    </div>
                    <div class="field">
                      <label for="quoteNotes">Notas y aclaraciones</label>
                      <textarea id="quoteNotes" data-quote-field="notes" rows="4" placeholder="Escribe el detalle que quieras imprimir."></textarea>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-extras" role="tabpanel" aria-labelledby="quote-tab-btn-extras">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Beneficios y gastos</p>
                        <p class="muted tiny">Edita los beneficios visibles y los gastos de retiro.</p>
                      </div>
                    </div>
                    <div class="field textarea-field">
                      <label for="quoteBenefits">Beneficios adicionales (uno por l铆nea)</label>
                      <textarea id="quoteBenefits" data-quote-field="benefitsText" rows="5" placeholder="Escribe cada beneficio en una l铆nea."></textarea>
                    </div>
                    <div class="field textarea-field">
                      <label for="quoteFooter">Gastos de retiro (texto final)</label>
                      <textarea id="quoteFooter" data-quote-field="footerNote" rows="3" placeholder="Texto legal o aclaratorio."></textarea>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-visibility" role="tabpanel" aria-labelledby="quote-tab-btn-visibility">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Visibilidad de campos</p>
                        <p class="muted tiny">Oculta lo que no quieras mostrar en la cotizaci贸n.</p>
                      </div>
                    </div>
                    <div class="visibility-grid">
                      <label class="check-pill"><input type="checkbox" data-visibility-field="meta.quoteNumber" checked> Cotizaci贸n #</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="meta.quoteDate" checked> Fecha de cotizaci贸n</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="meta.quoteExpiry" checked> Vencimiento</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="meta.advisor" checked> Asesor comercial</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="client.name" checked> Nombre del cliente</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="client.dni" checked> DNI</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="client.cuil" checked> CUIL</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="client.cel" checked> Celular</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="client.location" checked> Provincia y localidad</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="client.postalCode" checked> C贸digo postal</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="vehicle.title" checked> T铆tulo veh铆culo a entregar</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="vehicle.brand" checked> Marca usado</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="vehicle.model" checked> Modelo y versi贸n usado</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="vehicle.year" checked> A帽o usado</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="vehicle.plate" checked> Patente usado</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="vehicle.kms" checked> Kms usado</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="vehicle.factoryPrice" checked> Precio f谩brica usado</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="newVehicle.section" checked> Datos nuevo veh铆culo</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="newVehicle.brand" checked> Marca 0km</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="newVehicle.model" checked> Modelo y versi贸n 0km</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="payments" checked> Esquema de pagos</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="preQuote" checked> Modo Pre Cotizaci贸n</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="notes" checked> Notas</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="benefits" checked> Beneficios adicionales</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="footer" checked> Texto legal final</label>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-storage" role="tabpanel" aria-labelledby="quote-tab-btn-storage">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Guardar y cargar</p>
                        <p class="muted tiny">Administra cotizaciones guardadas.</p>
                      </div>
                    </div>
                    <div class="form-grid two">
                      <div class="field">
                        <label for="quoteGeneratorSavedList">Cotizaciones guardadas</label>
                        <select id="quoteGeneratorSavedList"></select>
                      </div>
                      <div class="field action-stack">
                        <button id="quoteGeneratorLoad" class="secondary-btn mini" type="button"><i class='bx bx-folder-open'></i>Cargar</button>
                        <button id="quoteGeneratorDelete" class="ghost-btn mini danger" type="button"><i class='bx bx-trash'></i>Eliminar</button>
                        <button id="quoteGeneratorReset" class="ghost-btn mini" type="button"><i class='bx bx-eraser'></i>Limpiar</button>
                      </div>
                    </div>
                  </div>
                </section>
              </div>
            </div>
                <datalist id="quoteBrandSuggestions"></datalist>
              </aside>
              <div class="quote-generator-preview card">
                <div class="quote-preview-shell">
                  <div class="quote-preview" id="quotePreview">
                  <div class="quote-preview-header">
                    <div>
                      <h3 data-quote-visible="meta.quoteNumber" data-focus-field="meta.quoteNumber">Cotizaci贸n <span id="previewQuoteNumber">00000000</span></h3>
                    </div>
                    <div class="quote-preview-meta">
                      <div data-quote-visible="meta.quoteDate" data-focus-field="meta.quoteDate"><strong>Fecha de Cotizaci贸n:</strong> <span id="previewQuoteDate">--/--/----</span></div>
                      <div data-quote-visible="meta.quoteExpiry" data-focus-field="meta.quoteExpiry"><strong>Vencimiento:</strong> <span id="previewQuoteExpiry">--/--/----</span></div>
                      <div data-quote-visible="meta.advisor" data-focus-field="meta.advisor"><strong>Asesor Comercial:</strong> <span id="previewQuoteAdvisor">-</span></div>
                    </div>
                  </div>
                  <div class="quote-preview-alert" id="previewPreQuote" data-quote-visible="preQuote">
                    <i class='bx bx-info-circle'></i>
                    <div>
                      <p id="previewPreQuoteMessage"></p>
                    </div>
                  </div>
                  <div class="quote-preview-section">
                    <h4>Datos Cliente</h4>
                    <div class="quote-preview-grid">
                      <div data-quote-visible="client.name" data-focus-field="client.name"><strong>Nombre:</strong> <span id="previewClientName">-</span></div>
                      <div data-quote-visible="client.dni" data-focus-field="client.dni"><strong>DNI:</strong> <span id="previewClientDni">-</span></div>
                      <div data-quote-visible="client.cuil" data-focus-field="client.cuil"><strong>CUIL:</strong> <span id="previewClientCuil">-</span></div>
                      <div data-quote-visible="client.cel" data-focus-field="client.cel"><strong>CEL:</strong> <span id="previewClientCel">-</span></div>
                      <div data-quote-visible="client.location" data-focus-field="client.province"><strong>PROV. y LOCALIDAD:</strong> <span id="previewClientLocation">-</span></div>
                      <div data-quote-visible="client.postalCode" data-focus-field="client.postalCode"><strong>CP:</strong> <span id="previewClientPostal">-</span></div>
                    </div>
                  </div>
                  <div class="quote-preview-divider"></div>
                  <div class="quote-preview-section">
                    <h4>Datos Veh铆culo</h4>
                    <div class="quote-preview-title" id="previewVehicleTitle" data-quote-visible="vehicle.title">Veh铆culo a entregar</div>
                    <div class="quote-preview-grid">
                      <div data-quote-visible="vehicle.brand" data-focus-field="vehicle.brand"><strong>Marca:</strong> <span id="previewVehicleBrand">-</span></div>
                      <div data-quote-visible="vehicle.model" data-focus-field="vehicle.model"><strong>Modelo y Versi贸n:</strong> <span id="previewVehicleModel">-</span></div>
                      <div data-quote-visible="vehicle.year" data-focus-field="vehicle.year"><strong>A帽o:</strong> <span id="previewVehicleYear">-</span></div>
                      <div data-quote-visible="vehicle.plate" data-focus-field="vehicle.plate"><strong>Patente:</strong> <span id="previewVehiclePlate">-</span></div>
                      <div data-quote-visible="vehicle.kms" data-focus-field="vehicle.kms"><strong>Kms:</strong> <span id="previewVehicleKms">-</span></div>
                      <div class="quote-preview-row spaced" data-quote-visible="vehicle.factoryPrice" data-focus-field="vehicle.factoryPrice"><strong id="previewVehicleFactoryLabel">Precio cotizado por F谩brica:</strong> <span id="previewVehicleFactoryPrice">-</span></div>
                    </div>
                  </div>
                  <div class="quote-preview-divider"></div>
                  <div class="quote-preview-section" data-quote-visible="newVehicle.section">
                    <h4>Datos nuevo Veh铆culo</h4>
                    <div class="quote-preview-grid">
                      <div data-quote-visible="newVehicle.brand" data-focus-field="newVehicle.brand"><strong>Marca:</strong> <span id="previewNewVehicleBrand">-</span></div>
                      <div data-quote-visible="newVehicle.model" data-focus-field="newVehicle.model"><strong>Modelo y Versi贸n:</strong> <span id="previewNewVehicleModel">-</span></div>
                    </div>
                  </div>
                  <div class="quote-preview-divider"></div>
                    <div class="quote-preview-section" data-quote-visible="payments">
                      <h4>Esquema de pagos</h4>
                      <div id="previewBonifiedPayments" class="quote-preview-bonified"></div>
                      <div id="previewPaymentList" class="quote-preview-payments"></div>
                    </div>
                  <div class="quote-preview-section" data-quote-visible="notes">
                    <h4>Notas y aclaraciones</h4>
                    <div class="quote-preview-notes" id="previewNotes">
                      <p></p>
                    </div>
                  </div>
                  <div class="quote-preview-section" data-quote-visible="benefits">
                    <div class="quote-preview-title-row">
                      <h4>Benef. Adicionales otorgados</h4>
                    </div>
                    <ul class="quote-preview-list" id="previewBenefitsList"></ul>
                  </div>
                  <div class="quote-preview-footer" data-quote-visible="footer">
                    <div class="quote-preview-footer-row">
                      <span id="previewFooterText">Gastos de Retiro: Acarreo, flete, patentamiento, prenda, formulario, gestor铆a, sellado, aranceles admin. ya incluidos en valor de la cuota</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          </section>
        </div>
      </section>
      <section id="clientManager" class="panel">
        <div class="panel-head">
          <div>
            <p class="eyebrow">Clientes importados</p>
            <h2>Gestor de Clientes</h2>
          </div>
        </div>

        <div class="card">
          <div class="client-controls">
            <div class="client-top-row">
              <div class="advisor-combo">
                <div class="combo-head">Asesor activo</div>
                <div class="combo-shell">
                  <i class='bx bx-user-voice'></i>
                  <select id="advisorSelector" disabled></select>
                </div>
              </div>
              <div class="advisor-filters">
                <div class="toggle filter-toggle" title="Filtrar por estado de contacto">
                  <i class='bx bx-filter-alt'></i>
                  <div class="filter-label">
                    <span class="muted tiny">Mostrar:</span>
                    <strong id="statusFilterLabel">Todos</strong>
                  </div>
                  <select id="statusFilter">
                    <option value="all">Todos</option>
                    <option value="contacted">Contactado</option>
                    <option value="no_number">N煤mero no disponible</option>
                    <option value="favorite">Favoritos</option>
                    <option value="pending">Pendientes</option>
                  </select>
                </div>
                <button class="ghost-btn" id="openDateFilter"><i class='bx bx-calendar'></i>Filtro por fecha</button>
              </div>
            </div>
            <div class="control-bar">
              <div class="control-group secondary">
                <button class="secondary-btn" id="toggleEditMode"><i class='bx bx-edit-alt'></i>Activar Modo Edici贸n</button>
                <button class="secondary-btn" id="openActionCustomizer"><i class='bx bx-show-alt'></i>Personalizar Acciones</button>
                <button class="primary-btn" id="openContactAssistant"><i class='bx bx-bot'></i>Modo Inteligente</button>
                <button class="secondary-btn" id="openContactLog"><i class='bx bx-time-five'></i>Registro de contactados</button>
              </div>
            </div>
          </div>
          <div id="dateFilterHelper" class="muted tiny"></div>
          <div class="column-pills" id="columnToggles"></div>
          <div class="search-notice hidden" id="clientSearchNotice">
            <div class="search-notice-text">
              <i class='bx bx-filter-alt'></i>
              <span>Se est谩n mostrando los resultados de la b煤squeda: <strong id="clientSearchTerm"></strong></span>
            </div>
            <button class="ghost-btn mini" id="clientSearchReset">Restablecer</button>
          </div>
          <div class="pagination-bar hidden" id="clientPaginationBar">
            <div class="pagination-controls">
              <button class="ghost-btn mini" id="clientPaginationPrev"><i class='bx bx-chevron-left'></i>Anterior</button>
              <span id="clientPaginationInfo" class="muted tiny"></span>
              <button class="ghost-btn mini" id="clientPaginationNext">Siguiente<i class='bx bx-chevron-right'></i></button>
            </div>
          </div>
          <div class="table-wrapper dense">
            <div class="table-toolbar">
              <div class="search-group">
                <div class="search-field compact expandable">
                  <i class='bx bx-search'></i>
                  <input id="clientManagerSearch" placeholder="Escribe cualquier contenido a buscar..." />
                </div>
                <button class="secondary-btn" id="clientManagerSearchBtn"><i class='bx bx-search'></i>Buscar</button>
              </div>
              <div class="table-toolbar-actions">
                <div class="field compact-field inline" id="paginationToggleField">
                  <label for="clientPaginationSelect">Paginaci贸n</label>
                  <select id="clientPaginationSelect">
                    <option value="none">Desactivada</option>
                    <option value="20">Cada 20</option>
                    <option value="50">Cada 50</option>
                    <option value="100">Cada 100</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="data-grid" id="clientManagerTable">
              <div class="grid-head"></div>
              <div class="grid-body"></div>
            </div>
          </div>
          <p id="clientManagerHelper" class="muted tiny"></p>
        </div>
      </section>

      <section id="scheduledClients" class="panel">
        <div class="panel-head">
          <div>
            <p class="eyebrow">Agenda de recontactos</p>
            <h2>Clientes Programados</h2>
            <p class="muted subtle">Organiza tus seguimientos y mant茅n tu cronograma al d铆a.</p>
          </div>
        </div>
        <div class="card schedule-summary">
          <div class="schedule-meta">
            <div>
              <p class="muted">Hoy es: <strong id="scheduledToday">--</strong></p>
              <p class="muted">Y son actualmente las: <strong id="scheduledNow">--</strong></p>
            </div>
            <div class="schedule-count">
              <span class="eyebrow">Clientes Programados</span>
              <p class="value" id="scheduledCount">0</p>
            </div>
          </div>
          <div class="schedule-divider"></div>
          <div class="schedule-agenda">
            <h3>Esta es tu agenda:</h3>
            <div id="scheduledTimeline" class="schedule-timeline"></div>
          </div>
        </div>
      </section>
    </main>
    <footer class="app-footer">
      <p>Creado por Maximiliano Martinez | version 1.1.0 (beta) | Solo uso interno autorizado</p>
    </footer>
  </div>
  <div class="popover-overlay fade" id="actionCustomizerOverlay">
    <div class="popover wide">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Configuraci贸n de acciones</p>
          <h3>Personalizar acciones r谩pidas</h3>
          <p class="muted subtle">Oculta las predeterminadas o crea tus propias acciones con icono y color.</p>
        </div>
        <button class="ghost-btn icon-only" id="closeActionCustomizer"><i class='bx bx-x'></i></button>
      </div>
      <div class="customizer-content">
        <section class="action-group">
          <header class="group-head">
            <div>
              <p class="eyebrow">Acciones por defecto</p>
              <h4>Mostrar u ocultar</h4>
            </div>
          </header>
          <div class="action-list" id="defaultActionList"></div>
        </section>
        <section class="action-group">
          <header class="group-head">
            <div>
              <p class="eyebrow">Acciones personalizadas</p>
              <h4>Tus accesos r谩pidos</h4>
            </div>
          </header>
          <div class="action-list" id="customActionList"></div>
          <div class="actions center" id="customActionCreate">
            <button class="primary-btn" id="newCustomAction"><i class='bx bx-plus'></i>Crear Nueva acci贸n Personalizada</button>
          </div>
        </section>
      </div>
    </div>
  </div>
  <div class="popover-overlay fade" id="customActionOverlay">
    <div class="popover compact" id="customActionPopover">
      <div class="popover-head">
        <div>
          <p class="eyebrow" id="customActionSubtitle">Nueva acci贸n</p>
          <h3 id="customActionTitle">Crear acci贸n personalizada</h3>
          <p class="muted subtle">Define icono, color y texto para tu acceso r谩pido.</p>
        </div>
        <button class="ghost-btn icon-only" id="closeCustomAction"><i class='bx bx-x'></i></button>
      </div>
      <div class="form-grid">
        <div class="field">
          <label for="customActionLabel">Texto a mostrar</label>
          <input id="customActionLabel" placeholder="Ej: Contactado por Whatsapp" />
        </div>
        <div class="field">
          <label for="customActionColor">Color a usar</label>
          <input type="color" id="customActionColor" value="#38bdf8" />
        </div>
      </div>
      <div class="field">
        <label>Icono a mostrar</label>
        <div class="icon-row">
          <div class="icon-preview" id="customIconPreview"><i class='bx bx-check-circle'></i></div>
          <button class="secondary-btn" id="openIconPicker"><i class='bx bx-grid-alt'></i>Elegir icono</button>
        </div>
      </div>
      <div class="form-actions">
        <button class="ghost-btn" id="cancelCustomAction">Cancelar</button>
        <button class="primary-btn" id="saveCustomAction"><i class='bx bx-save'></i>Guardar esta acci贸n personalizada</button>
      </div>
    </div>
  </div>
  <div class="popover-overlay fade" id="scheduleContactOverlay">
    <div class="popover" id="scheduleContactPopover">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Programar Contacto</p>
          <h3>Agenda un nuevo recontacto</h3>
          <p class="muted subtle">Est谩s programando recontactar a: <strong id="scheduleClientName">Cliente</strong></p>
        </div>
        <button class="ghost-btn icon-only" id="closeScheduleContact"><i class='bx bx-x'></i></button>
      </div>
      <div class="form-grid two">
        <div class="field">
          <label for="scheduleDate">Selecciona una fecha</label>
          <input type="date" id="scheduleDate">
        </div>
        <div class="field">
          <label for="scheduleTime">Selecciona un horario</label>
          <input type="time" id="scheduleTime">
        </div>
      </div>
      <div class="field textarea-field">
        <label for="scheduleMessage">Motivo de Recontacto</label>
        <div class="textarea-shell">
          <textarea id="scheduleMessage" rows="4" placeholder="Escribe el mensaje o motivo principal..."></textarea>
          <div class="chips inline" id="scheduleQuickReasons">
            <button class="chip compact" type="button" data-message="Seguimiento del plan solicitado.">Seguimiento del plan</button>
            <button class="chip compact" type="button" data-message="Enviar informaci贸n y valores actualizados.">Enviar informaci贸n</button>
            <button class="chip compact" type="button" data-message="Confirmar documentaci贸n y pr贸ximos pasos.">Confirmar documentaci贸n</button>
            <button class="chip compact" type="button" data-message="Recordatorio de propuesta y beneficios.">Recordatorio</button>
          </div>
        </div>
      </div>
      <div class="field">
        <label>Forma de Contacto</label>
        <div class="schedule-contact-options">
          <label class="toggle option-card">
            <input type="radio" name="scheduleContactMethod" value="whatsapp" checked>
            <span>Mensaje de Whatsapp</span>
          </label>
          <label class="toggle option-card">
            <input type="radio" name="scheduleContactMethod" value="phone">
            <span>Llamada telef贸nica</span>
          </label>
          <label class="toggle option-card">
            <input type="radio" name="scheduleContactMethod" value="other">
            <span>Otro</span>
          </label>
        </div>
      </div>
      <div class="field hidden" id="scheduleOtherContactField">
        <label for="scheduleOtherContact">Especificar otra forma</label>
        <input id="scheduleOtherContact" placeholder="Ej: Videollamada, email, reuni贸n presencial">
      </div>
      <div class="modal-actions">
        <button class="ghost-btn" id="cancelScheduleContact">Cancelar</button>
        <button class="primary-btn" id="confirmScheduleContact"><i class='bx bx-check-circle'></i>Programar</button>
      </div>
    </div>
  </div>
  <div class="popover-overlay fade" id="iconPickerOverlay">
    <div class="popover nested" id="iconPickerPopover">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Selector de iconos</p>
          <h3>Elige un 铆cono</h3>
          <p class="muted subtle">Explora la biblioteca y selecciona el que mejor identifique tu acci贸n.</p>
        </div>
        <button class="ghost-btn icon-only" id="closeIconPicker"><i class='bx bx-x'></i></button>
      </div>
      <div class="icon-picker" id="customActionIcons"></div>
    </div>
  </div>
  <div class="popover-overlay" id="clientActionOverlay">
    <div class="popover wide" id="clientActionMenu">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Men煤 de acciones</p>
          <h3 id="clientActionTitle">Editar contacto</h3>
          <p class="muted subtle" id="clientActionSubtitle"></p>
        </div>
        <button class="ghost-btn icon-only" id="clientActionClose"><i class='bx bx-x'></i></button>
      </div>
      <div class="action-grid" id="clientActionList"></div>
    </div>
  </div>
  <div class="popover-overlay fade" id="contactAssistantOverlay">
    <div class="popover assistant" id="contactAssistantPopover">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Ronda de pendientes</p>
          <h3>Asistente de Contactos</h3>
        </div>
        <button class="ghost-btn icon-only" id="closeContactAssistant"><i class='bx bx-x'></i></button>
      </div>
      <div class="assistant-shell">
        <div class="assistant-undo hidden" id="assistantUndo">
          <div>
            <p class="muted tiny">El cliente anterior fue:</p>
            <p class="assistant-undo-text">"<span id="assistantUndoName">-</span>" y ha sido marcado como: "<span id="assistantUndoStatus">-</span>".</p>
          </div>
          <button class="secondary-btn" id="assistantUndoBtn"><i class='bx bx-undo'></i>Deshacer esta acci贸n</button>
        </div>
        <div class="assistant-header">
          <p class="muted tiny">Cliente actual</p>
          <h3 id="assistantClientName">-</h3>
          <p class="muted tiny" id="assistantHelper"></p>
        </div>
        <div class="assistant-layout" id="contactAssistantCard">
          <div class="assistant-card" data-tone="cyan">
            <div class="card-head">
              <p class="eyebrow">Tel茅fono</p>
              <button class="glow-btn icon-only" id="assistantCopyPhone" data-tone="cyan" title="Copiar celular"><i class='bx bx-copy'></i></button>
            </div>
            <p class="assistant-value" id="assistantClientPhone">-</p>
          </div>
          <div class="assistant-card" data-tone="purple">
            <div class="card-head">
              <p class="eyebrow">Copiar mensaje</p>
              <button class="glow-btn icon-only" id="assistantCopyMessage" data-tone="purple" title="Copiar mensaje"><i class='bx bx-message-square-dots'></i></button>
            </div>
            <p class="muted" id="assistantMessagePreview"></p>
          </div>
          <div class="assistant-card actions" data-tone="green">
            <p class="eyebrow">Marcar como...</p>
            <div class="action-buttons">
              <button class="glow-btn" id="assistantMarkContacted" data-tone="green"><i class='bx bx-check-circle'></i> Contactado</button>
              <button class="glow-btn" id="assistantMarkNoNumber" data-tone="red"><i class='bx bx-block'></i> N煤mero no disponible</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="popover-overlay fade" id="preferencesOverlay">
    <div class="popover wide" id="preferencesPanel">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Mis preferencias</p>
          <h3>Personaliza tu vista</h3>
          <p class="muted subtle">Ajusta el tama帽o de texto y el formato visual de los datos.</p>
        </div>
        <button class="ghost-btn icon-only" id="closePreferences"><i class='bx bx-x'></i></button>
      </div>
      <div class="preferences-content preferences-layout">
        <aside class="preferences-nav">
          <button class="preferences-tab active" data-pref-tab="fonts"><i class='bx bx-font'></i> Tipograf铆a</button>
          <button class="preferences-tab" data-pref-tab="context"><i class='bx bx-layout'></i> Men煤 contextual</button>
          <button class="preferences-tab" data-pref-tab="display"><i class='bx bx-low-vision'></i> Visualizaci贸n</button>
        </aside>
        <div class="preferences-panels">
          <section class="preferences-section pref-panel active" data-pref-panel="fonts">
            <div class="section-head">
              <div>
                <p class="eyebrow">Tama帽o de fuente</p>
                <h4>Campos del gestor</h4>
                <p class="muted tiny">Cada ajuste afecta al Gestor de Clientes y al Asistente de Contactos.</p>
              </div>
            </div>
            <div class="preferences-grid" id="fontPreferencesList"></div>
          </section>
          <section class="preferences-section pref-panel" data-pref-panel="context">
            <div class="section-head">
              <div>
                <p class="eyebrow">Men煤 contextual</p>
                <h4>Tama帽o de fuente</h4>
                <p class="muted tiny">Define c贸mo se muestran los textos dentro del men煤 contextual.</p>
              </div>
            </div>
            <div class="preferences-grid" id="contextFontPreferencesList"></div>
            <div class="section-head">
              <div>
                <p class="eyebrow">Contenido visible</p>
                <h4>Elige qu茅 mostrar</h4>
                <p class="muted tiny">Activa o desactiva cada dato y acci贸n por separado.</p>
              </div>
            </div>
            <div class="preferences-grid" id="contextVisibilityList"></div>
          </section>
          <section class="preferences-section pref-panel" data-pref-panel="display">
            <div class="section-head">
              <div>
                <p class="eyebrow">Visualizaci贸n</p>
                <h4>Celulares en formato simple</h4>
                <p class="muted tiny">Solo afecta a la tabla y al Asistente, no al copiado.</p>
              </div>
            </div>
            <div class="field">
              <label for="phoneDisplaySelect">Visualizaci贸n sencilla de celulares</label>
              <select id="phoneDisplaySelect">
                <option value="plain">Desactivada</option>
                <option value="split2">Activada con separador de 2</option>
                <option value="split3">Activada con separador de 3</option>
              </select>
            </div>
          </section>
        </div>
      </div>
    </div>
  </div>
  <div class="modal hidden" id="clientEditModal">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow" id="clientEditEyebrow">Edici贸n</p>
          <h3 id="clientEditTitle"></h3>
          <p class="muted" id="clientEditSubtitle"></p>
        </div>
        <button id="clientEditClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="field" id="clientEditCurrent"></div>
      <div class="field" id="clientEditField"></div>
      <label class="toggle" id="uppercaseToggle" style="display:none;">
        <input type="checkbox" id="clientUppercase">
        <span>Forzar may煤sculas</span>
      </label>
      <div class="modal-actions">
        <button id="clientEditCancel" class="ghost-btn">Cancelar</button>
        <button id="clientEditSave" class="primary-btn"><i class='bx bx-save'></i>Guardar</button>
      </div>
    </div>
  </div>
  <div class="popover-overlay" id="contactLogOverlay">
    <div class="popover wide" id="contactLogPanel">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Registro de Contactados</p>
          <h3>Seguimiento en tiempo real</h3>
          <p class="muted subtle">ltimas acciones marcadas: contactado, n煤mero no disponible o favoritos.</p>
        </div>
        <button class="ghost-btn icon-only" id="contactLogClose"><i class='bx bx-x'></i></button>
      </div>
      <div class="search-field">
        <i class='bx bx-search'></i>
        <input id="contactLogSearch" placeholder="Buscar por nombre, estado o tel茅fono" />
      </div>
      <div class="contact-log-body" id="contactLogList"></div>
      <div id="contactLogEmpty" class="empty-state hidden">
        <i class='bx bx-time-five'></i>
        <p class="muted">A煤n no hay registros de contacto. Marca clientes como contactados, n煤mero no disponible o favoritos para verlos aqu铆.</p>
      </div>
    </div>
  </div>
  <div class="context-menu hidden" id="clientContextMenu">
    <div class="context-menu-head">
      <div>
        <p class="eyebrow">Seleccionaste a:</p>
        <h4 id="contextClientName">Cliente</h4>
        <p class="muted tiny" id="contextClientModel"></p>
      </div>
      <button class="ghost-btn icon-only" id="closeContextMenu"><i class='bx bx-x'></i></button>
    </div>
    <div class="context-menu-body" id="contextMenuContent"></div>
  </div>
  <div id="toastContainer" class="toast-container"></div>
  <div id="exportModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Exportar clientes</p>
          <h3>Elige c贸mo quieres exportar</h3>
          <p class="muted" id="exportHelperText">Configura el m茅todo y las columnas a incluir.</p>
        </div>
        <button id="exportClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-actions top">
        <button id="exportCancel" class="ghost-btn">Cancelar</button>
        <button id="exportConfirm" class="primary-btn"><i class='bx bx-download'></i>Exportar ahora</button>
      </div>
      <div class="option-stack two-cols">
        <label class="option-card">
          <input type="radio" name="exportMode" value="local" checked>
          <div>
            <strong>Excel - Datos Ordenados por este Sistema</strong>
            <p class="muted tiny">Usa los campos locales y respeta el orden que definas abajo.</p>
          </div>
        </label>
        <label class="option-card">
          <input type="radio" name="exportMode" value="preset">
          <div>
            <strong>Excel - Igualar Cabezales Predet.</strong>
            <p class="muted tiny">Exporta con encabezados fijos: CUIT0, DOC, FECNAC, NOMBRE, OLOC, OPCIA, CP, CELULAR12, FECHA1, MARCA, MODELO, TIPO, ESTADO.</p>
          </div>
        </label>
      </div>
      <div class="export-options">
        <div class="export-options-head">
          <div>
            <p class="eyebrow">Contenido a exportar</p>
            <h4>Activa, desactiva y reordena columnas</h4>
            <p class="muted tiny">Todo est谩 seleccionado por defecto. Usa las flechas para mover cada columna.</p>
          </div>
          <button id="exportSelectAll" class="ghost-btn"><i class='bx bx-check-double'></i>Seleccionar todo</button>
        </div>
        <div id="exportColumnsList" class="export-columns"></div>
      </div>
    </div>
  </div>
  <div id="clientPickerModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Seleccionar cliente</p>
          <h3>Contactos importados</h3>
          <p class="muted">Busca en la lista de clientes importados y aplica sus datos al plan.</p>
        </div>
        <button id="clientPickerClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="search-field expanded">
        <i class='bx bx-search'></i>
        <input id="clientPickerSearch" placeholder="Escribe cualquier contenido a buscar..." />
      </div>
      <div id="clientPickerList" class="picker-list"></div>
      <div class="modal-actions">
        <button id="clientPickerCancel" class="ghost-btn">Cerrar</button>
      </div>
    </div>
  </div>
  <div id="clientVehicleModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Modelo asociado</p>
          <h3>Confirmar veh铆culo del cliente</h3>
          <p class="muted" id="clientVehicleContext">Selecciona el veh铆culo vinculado al cliente.</p>
        </div>
        <button id="clientVehicleClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="field">
        <label for="clientVehicleOptions">El cliente tiene asociado el auto:</label>
        <select id="clientVehicleOptions"></select>
      </div>
      <div class="modal-actions">
        <button id="clientVehicleCancel" class="ghost-btn">Cancelar</button>
        <button id="clientVehicleApply" class="primary-btn"><i class='bx bx-check'></i>Utilizar selecci贸n</button>
      </div>
    </div>
  </div>
  <div id="clientNoteModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Notas</p>
          <h3 id="clientNoteTitle"></h3>
          <p class="muted" id="clientNoteSubtitle"></p>
        </div>
        <button id="clientNoteClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="field textarea-field">
        <label for="clientNoteText">Notas del cliente</label>
        <textarea id="clientNoteText" rows="6" placeholder="Agrega recordatorios, acuerdos o detalles relevantes"></textarea>
      </div>
      <div class="modal-actions">
        <button id="clientNoteCancel" class="ghost-btn">Cerrar</button>
        <button id="clientNoteSave" class="primary-btn"><i class='bx bx-save'></i>Guardar</button>
      </div>
    </div>
  </div>
  <div id="importDateModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Fecha de carga</p>
          <h3>Aplicar fecha a los clientes importados</h3>
          <p class="muted">Esta marca es opcional y te permitir谩 filtrar o exportar por d铆a.</p>
        </div>
        <button id="importDateClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="option-stack">
        <label class="option-card">
          <input type="radio" name="importDateOption" value="today" checked>
          <div>
            <strong>Usar la fecha de hoy</strong>
            <p class="muted tiny" id="importDateTodayLabel"></p>
          </div>
        </label>
        <label class="option-card">
          <input type="radio" name="importDateOption" value="custom">
          <div>
            <strong>Elegir una fecha</strong>
            <p class="muted tiny">Selecciona manualmente la fecha de carga.</p>
            <input type="date" id="importCustomDate">
          </div>
        </label>
        <label class="option-card">
          <input type="radio" name="importDateOption" value="none">
          <div>
            <strong>No insertar fecha</strong>
            <p class="muted tiny">Se conservar谩 vac铆o para estos registros.</p>
          </div>
        </label>
      </div>
      <div class="modal-actions">
        <button id="importDateCancel" class="ghost-btn">Cancelar</button>
        <button id="importDateConfirm" class="primary-btn"><i class='bx bx-check-double'></i>Confirmar</button>
      </div>
    </div>
  </div>
  <div id="importMappingModal" class="modal hidden">
    <div class="modal-content wide tall">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Comprobaci贸n de cabezales</p>
          <h3>Revisa y asigna las columnas del Excel</h3>
          <p class="muted">Selecciona d贸nde est谩 cada dato obligatorio. Solo se usar谩n las columnas asignadas.</p>
        </div>
        <button id="importMappingClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="import-mapping-hint" id="importMappingHint"></div>
      <div class="import-mapping-grid" id="importMappingFields"></div>
      <div class="modal-actions with-status">
        <div id="importMappingStatus" class="mapping-status"></div>
        <div class="action-buttons">
          <button id="importMappingCancel" class="ghost-btn">Cancelar</button>
          <button id="importMappingConfirm" class="primary-btn"><i class='bx bx-check'></i>Importar</button>
        </div>
      </div>
    </div>
  </div>
  <div id="dateFilterModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Filtrar por fecha</p>
          <h3>Rango de fechas de carga</h3>
          <p class="muted">Aplica un rango opcional seg煤n la fecha de carga al sistema.</p>
        </div>
        <button id="dateFilterClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="field">
        <label for="dateFilterFrom">Desde</label>
        <input type="date" id="dateFilterFrom">
      </div>
      <div class="field">
        <label for="dateFilterTo">Hasta</label>
        <input type="date" id="dateFilterTo">
      </div>
      <div class="modal-actions">
        <button id="clearDateFilter" class="ghost-btn">Limpiar filtro</button>
        <button id="applyDateFilter" class="primary-btn"><i class='bx bx-filter-alt'></i>Aplicar filtro</button>
      </div>
    </div>
  </div>
  <div id="quoteModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Cotizaciones previas</p>
          <h3>Guardar, cargar o eliminar</h3>
          <p class="muted">Gestiona historial con confirmaciones y copias r谩pidas.</p>
        </div>
        <button id="quoteModalClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="search-field expanded">
        <i class='bx bx-search'></i>
        <input id="quoteSearch" placeholder="Escribe cualquier contenido a buscar..." />
      </div>
      <div id="quoteList" class="quote-list"></div>
      <div class="modal-actions">
        <button id="quoteModalCancel" class="ghost-btn">Cerrar</button>
      </div>
    </div>
  </div>
  <div id="installmentModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Detalle de cuotas</p>
          <h3>Calendario y adelantos</h3>
          <p class="muted">Usa la cuota pura vigente para mostrar adelantos y coberturas.</p>
        </div>
        <button id="installmentClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div id="installmentSummary" class="folio-list"></div>
      <div id="installmentList" class="coverage-grid"></div>
      <div class="modal-actions">
        <button id="installmentCancel" class="ghost-btn">Cerrar</button>
      </div>
    </div>
  </div>
  <div id="priceFilesModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Archivos del mes</p>
          <h3>Explorador</h3>
        </div>
        <button id="priceFilesClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div id="priceFilesList" class="file-list"></div>
    </div>
  </div>
  <div id="onlineFilesModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Archivos online</p>
          <h3>Explorador general</h3>
        </div>
        <button id="onlineFilesClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="search-field compact">
        <i class='bx bx-search'></i>
        <input id="onlineFilesSearch" placeholder="Buscar por nombre..." />
      </div>
      <div id="onlineFilesList" class="file-list"></div>
    </div>
  </div>
  <div id="priceImportModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Precios del mes</p>
          <h3>Importar o exportar valores</h3>
          <p class="muted tiny">Sincroniza con precios_[marca].json del mes o carga un archivo manual.</p>
        </div>
        <button id="priceImportClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-body import-grid">
        <div class="card ghost">
          <div class="card-head compact">
            <p class="eyebrow">Carga autom谩tica</p>
            <h4>Desde la carpeta del mes</h4>
            <p class="muted tiny">Busca precios_[marca].json dentro de la carpeta activa.</p>
          </div>
          <p class="muted tiny" id="serverPricePath">Ruta: -</p>
          <div class="actions compact">
            <button id="reloadServerPrices" class="secondary-btn" type="button"><i class='bx bx-refresh'></i>Cargar desde servidor</button>
          </div>
          <p class="muted tiny" id="serverPriceStatus">Estado: sin cargar</p>
        </div>
        <div class="card ghost">
          <div class="card-head compact">
            <p class="eyebrow">Importaci贸n manual</p>
            <h4>Sube un archivo de precios</h4>
            <p class="muted tiny">Usa un archivo compatible generado por la plataforma.</p>
          </div>
          <div class="upload-box" id="priceUploadBox">
            <i class='bx bx-upload'></i>
            <p>Arrastra o haz clic para seleccionar</p>
            <p class="muted tiny">Solo archivos .json</p>
            <input type="file" id="priceFileInput" accept="application/json" />
          </div>
          <div class="actions compact">
            <button id="applyPriceFile" class="primary-btn" type="button"><i class='bx bx-check-circle'></i>Aplicar archivo</button>
          </div>
          <p class="muted tiny" id="localPriceStatus">Estado: esperando archivo</p>
        </div>
        <div class="card ghost">
          <div class="card-head compact">
            <p class="eyebrow">Respaldo inmediato</p>
            <h4>Exportar precios actuales</h4>
            <p class="muted tiny">Descarga los precios_[marca].json listos para subir al servidor.</p>
          </div>
          <div class="actions compact">
            <button id="downloadPriceFile" class="secondary-btn" type="button"><i class='bx bx-download'></i>Descargar precios por marca</button>
            <button id="copyPriceJson" class="ghost-btn" type="button"><i class='bx bx-copy'></i>Copiar JSON</button>
          </div>
          <p class="muted tiny" id="exportPriceHint">Incluye todos los importes editados.</p>
        </div>
      </div>
      <div class="modal-actions">
        <button id="priceImportCancel" class="ghost-btn">Cerrar</button>
      </div>
    </div>
  </div>
  <div id="vehicleEditorModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Modo editor</p>
          <h3>Gesti贸n de modelos y valores</h3>
          <p class="muted tiny">Edita el cat谩logo actual y exporta precios_[marca].json cuando termines.</p>
        </div>
        <div class="editor-head-actions">
          <button id="exportPricesFromEditor" class="secondary-btn"><i class='bx bx-download'></i>Descargar Archivos de Precios</button>
          <button id="vehicleEditorClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
        </div>
      </div>
      <div class="modal-body editor-body">
        <div class="editor-tabs">
          <button class="tab-btn active" type="button" data-editor-tab="models">Modelos</button>
          <button class="tab-btn" type="button" data-editor-tab="brands">Gesti贸n de Marcas</button>
        </div>
        <div class="editor-tab-panels">
          <div class="editor-tab-panel active" data-editor-panel="models">
            <div class="editor-grid">
              <aside class="editor-sidebar">
                <div class="editor-filter-row">
                  <div class="search-field compact">
                    <i class='bx bx-search'></i>
                    <input id="vehicleEditorSearch" placeholder="Buscar modelo" />
                  </div>
                  <div class="field compact">
                    <label for="vehicleEditorBrandFilter">Filtrar marca</label>
                    <select id="vehicleEditorBrandFilter"></select>
                  </div>
                </div>
                <div id="vehicleEditorList" class="editor-list"></div>
                <p id="vehicleEditorEmpty" class="muted tiny hidden">No se encontraron modelos.</p>
                <div class="actions compact center editor-list-actions">
                  <button id="addVehicle" class="secondary-btn mini"><i class='bx bx-plus'></i>Agregar modelo</button>
                  <button id="duplicateVehicle" class="ghost-btn mini"><i class='bx bx-copy'></i>Duplicar</button>
                  <button id="deleteVehicle" class="ghost-btn danger mini"><i class='bx bx-trash'></i>Eliminar</button>
                </div>
              </aside>
              <div class="editor-form">
                <div class="field">
                  <label for="editorVehicleName">Nombre del modelo</label>
                  <input id="editorVehicleName" placeholder="Ej: Tracker LT 1.2AT" />
                </div>
                <div class="form-grid two">
                  <div class="field">
                    <label for="editorBrand">Marca</label>
                    <select id="editorBrand"></select>
                  </div>
                  <div class="field">
                    <label for="editorAllocation">Modalidad de adjudicaci贸n</label>
                    <select id="editorAllocation">
                      <option value="pactada">Cuota Pactada (Llave x llave)</option>
                      <option value="sorteo_licitacion">Solo Sorteo o Licitaci贸n</option>
                    </select>
                  </div>
                </div>
                <div class="form-grid two">
                  <div class="field">
                    <label for="editorWithdrawalInstallments">Cuotas pactadas de retiro</label>
                    <input id="editorWithdrawalInstallments" placeholder="Ej: 4,6,9,12" />
                  </div>
                  <div class="field">
                    <label>Requisito de integraci贸n</label>
                    <div class="inline-field requirement-inline">
                      <select id="editorWithdrawalRequirementType">
                        <option value="percent">%</option>
                        <option value="amount">$</option>
                      </select>
                      <input id="editorWithdrawalRequirementPct" type="number" min="0" max="100" step="1" placeholder="Ej: 35" />
                      <div class="money-field hidden" id="editorWithdrawalRequirementAmountField">
                        <span class="prefix">$</span>
                        <input id="editorWithdrawalRequirementAmount" class="money" type="text" inputmode="numeric" placeholder="Ej: 750000" />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-grid three">
                  <div class="field">
                    <label for="editorBasePrice">Precio de lista</label>
                    <div class="money-field">
                      <span class="prefix">$</span>
                      <input id="editorBasePrice" class="money" type="text" inputmode="numeric" />
                    </div>
                  </div>
                  <div class="field">
                    <label for="editorIntegration">Integraci贸n</label>
                    <div class="money-field">
                      <span class="prefix">$</span>
                      <input id="editorIntegration" class="money" type="text" inputmode="numeric" />
                    </div>
                  </div>
                  <div class="field">
                    <label for="editorCuotaPura">Cuota pura</label>
                    <div class="money-field">
                      <span class="prefix">$</span>
                      <input id="editorCuotaPura" class="money" type="text" inputmode="numeric" />
                    </div>
                  </div>
                </div>
                <div class="form-grid two">
                  <div class="field">
                    <label for="editorPlanLabel">Etiqueta del plan</label>
                    <input id="editorPlanLabel" placeholder="Ej: 80/20 (120 cuotas)" />
                  </div>
                  <div class="field">
                    <label for="editorPlanMaxInstallments">M谩ximo de cuotas</label>
                    <input id="editorPlanMaxInstallments" type="number" min="1" step="1" placeholder="Ej: 84 o 120" />
                  </div>
                </div>
                <div class="form-grid three">
                  <div class="field">
                    <label for="editorPlanFinanced">Financia empresa (%)</label>
                    <input id="editorPlanFinanced" type="number" min="0" max="100" step="1" placeholder="Ej: 70" />
                  </div>
                  <div class="field">
                    <label for="editorPlanIntegration">Paga cliente (%)</label>
                    <input id="editorPlanIntegration" type="number" min="0" max="100" step="1" placeholder="Ej: 30" />
                  </div>
                  <div class="field readonly">
                    <label>Etiqueta autom谩tica</label>
                    <div class="plan-profile-cell readonly">
                      <span class="chip muted" id="editorPlanAutoLabel">Sin esquema definido</span>
                    </div>
                  </div>
                </div>
                <div class="field">
                  <label>Planes disponibles</label>
                  <p class="muted tiny">Se calculan autom谩ticamente seg煤n las cuotas m谩ximas definidas.</p>
                  <div class="chip-group">
                    <label class="chip-select"><input type="checkbox" data-editor-available value="2a12">2 a 12</label>
                    <label class="chip-select"><input type="checkbox" data-editor-available value="13a21">13 a 21</label>
                    <label class="chip-select"><input type="checkbox" data-editor-available value="22a84">22 a 84</label>
                    <label class="chip-select"><input type="checkbox" data-editor-available value="85a120">85 a 120</label>
                    <label class="chip-select"><input type="checkbox" data-editor-available value="ctapura">Cuota pura</label>
                  </div>
                </div>
                <div class="field-group compact">
                  <div class="field-head">
                    <div>
                      <p class="eyebrow">Cuotas por plan</p>
                      <p class="muted tiny">Importes de referencia por tramo.</p>
                    </div>
                  </div>
                  <div class="form-grid two" id="editorPlanRanges"></div>
                </div>
                <div class="field-group compact">
                  <div class="field-head">
                    <div>
                      <p class="eyebrow">Reservas</p>
                      <p class="muted tiny">Importes de reserva por cuota.</p>
                    </div>
                  </div>
                  <div class="form-grid three">
                    <div class="field">
                      <label>Reserva 1 cuota</label>
                      <div class="money-field">
                        <span class="prefix">$</span>
                        <input class="money" type="text" inputmode="numeric" data-editor-reserva="1" />
                      </div>
                    </div>
                    <div class="field">
                      <label>Reserva 3 cuotas</label>
                      <div class="money-field">
                        <span class="prefix">$</span>
                        <input class="money" type="text" inputmode="numeric" data-editor-reserva="3" />
                      </div>
                    </div>
                    <div class="field">
                      <label>Reserva 6 cuotas</label>
                      <div class="money-field">
                        <span class="prefix">$</span>
                        <input class="money" type="text" inputmode="numeric" data-editor-reserva="6" />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="field-group compact">
                  <div class="field-head">
                    <div>
                      <p class="eyebrow">Beneficios</p>
                      <p class="muted tiny">Texto de pactadas y bonificaciones.</p>
                    </div>
                  </div>
                  <div class="field textarea-field">
                    <label for="editorBenefitPactada">Pactada</label>
                    <textarea id="editorBenefitPactada" rows="2" placeholder="Ej: Chevroplan pactada cuota n潞6"></textarea>
                  </div>
                  <div class="field textarea-field">
                    <label for="editorBenefitBonificacion">Bonificaci贸n</label>
                    <textarea id="editorBenefitBonificacion" rows="2" placeholder="Ej: 50% desc. en las primeras 3 cuotas del seguro"></textarea>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="editor-tab-panel" data-editor-panel="brands">
            <div class="brand-manager">
              <div class="brand-manager-head">
                <div>
                  <p class="eyebrow">Gesti贸n de Marcas</p>
                  <p class="muted tiny">Define color, nombre y esquema de cuotas para cada marca disponible.</p>
                </div>
                <button id="addBrand" class="secondary-btn mini" type="button"><i class='bx bx-plus'></i>Agregar marca</button>
              </div>
              <div id="brandManagerList" class="brand-manager-list"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow" id="modalEyebrow">Confirmaci贸n</p>
          <h3 id="modalTitle"></h3>
          <p class="muted" id="modalMessage"></p>
        </div>
        <button id="modalClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-actions">
        <button id="modalCancel" class="ghost-btn">Cancelar</button>
        <button id="modalConfirm" class="primary-btn">Aceptar</button>
      </div>
    </div>
  </div>
  <div id="quoteRestoreModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Restaurar cotizaci贸n</p>
          <h3>Antes ten铆as una Cotizaci贸n abierta.</h3>
          <p class="muted">驴Quieres restaurarla y continuar edit谩ndola?</p>
        </div>
        <button id="quoteRestoreClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-actions stacked">
        <button id="quoteRestoreContinue" class="primary-btn"><i class='bx bx-rotate-right'></i>Si, Continuar la edici贸n</button>
        <button id="quoteRestoreReload" class="secondary-btn"><i class='bx bx-user'></i>No, Volver a cargar los datos del cliente</button>
        <button id="quoteRestoreReset" class="ghost-btn danger"><i class='bx bx-eraser'></i>No, Empezar desde 0 en blanco</button>
      </div>
    </div>
  </div>
  <div id="processingOverlay" class="processing-overlay hidden" aria-live="polite">
    <div class="processing-card">
      <span class="processing-spinner" aria-hidden="true"></span>
      <div>
        <p class="eyebrow">Procesando cambios</p>
        <h3>Procesando cambios... Aguarde un momento.</h3>
        <p class="muted">Estamos ajustando productos, precios y planes.</p>
      </div>
    </div>
  </div>
  <div id="quoteExportOverlay" class="processing-overlay hidden" aria-live="polite">
    <div class="processing-card export-card">
      <span class="processing-spinner" aria-hidden="true"></span>
      <div>
        <p class="eyebrow">Exportaci贸n</p>
        <h3>Generando la cotizaci贸n... Espera un momento...</h3>
        <div class="export-progress">
          <span></span>
        </div>
      </div>
    </div>
  </div>
  <script type="module" src="app.js"></script>
</body>
</html>
