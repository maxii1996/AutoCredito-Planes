<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestor de Clientes</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css">
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
</head>
<body class="auth-locked">
  <div class="app-loader" id="appLoader" aria-live="polite">
    <div class="loader-card">
      <div class="loader-header">
        <div class="loader-icon">‚ú®</div>
        <div class="loader-text">
          <p class="eyebrow" id="loaderEyebrow">Inicializando m√≥dulos...</p>
          <h2 id="loaderHeadline">Preparando el panel principal</h2>
        </div>
        <div class="loader-status-pill" id="loaderStatusPercent">0%</div>
      </div>
      <div class="loader-content">
        <div class="loader-progress">
          <div class="loader-total">
            <div class="loader-total-row">
              <span class="loader-total-label">Progreso total</span>
              <span class="loader-total-count" id="loaderStatusText">0/0</span>
            </div>
            <div class="loader-bar"><span id="loaderBar"></span></div>
          </div>
          <div class="loader-steps" id="loaderSteps"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="auth-overlay hidden" id="loginOverlay" aria-live="polite">
    <div class="auth-card">
      <div class="auth-head">
        <div class="auth-icon">üîê</div>
        <div>
          <h2>Iniciar sesi√≥n</h2>
          <p class="muted">Ingresa con tu usuario autorizado para continuar.</p>
        </div>
      </div>
      <div class="auth-body">
        <div class="auth-column auth-column-main">
          <form id="loginForm" class="auth-form">
            <label class="field">
              <span>Usuario</span>
              <input type="text" id="loginUsername" autocomplete="username" required>
            </label>
            <label class="field">
              <span>Contrase√±a</span>
              <div class="password-field">
                <input type="password" id="loginPassword" autocomplete="current-password" required>
                <button class="icon-btn" type="button" id="loginPasswordToggle" aria-label="Mostrar contrase√±a">
                  <i class='bx bx-show'></i>
                </button>
              </div>
            </label>
            <div class="auth-actions">
              <button class="primary-btn" type="submit" id="loginSubmit"><i class='bx bx-log-in'></i>Acceder</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  <div class="login-transition-overlay" id="loginTransitionOverlay" aria-live="polite" aria-hidden="true">
    <div class="login-transition-card">
      <div class="login-transition-icon">üöÄ</div>
      <div class="login-transition-text">
        <p class="eyebrow" id="loginTransitionTitle">Iniciando sesi√≥n como:</p>
        <h3 id="loginTransitionName">Usuario</h3>
        <div class="login-transition-messages">
          <p class="login-transition-pulse" id="loginTransitionMessagePrimary">Validando credenciales...</p>
          <p class="muted" id="loginTransitionMessageSecondary">Preparando tu entorno.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="profile-switch-overlay" id="profileSwitchOverlay" aria-live="polite" aria-hidden="true">
    <div class="profile-switch-card">
      <div class="profile-switch-spinner" aria-hidden="true"></div>
      <div class="profile-switch-text">
        <p class="eyebrow">Cambio de cuenta activa</p>
        <h3 id="profileSwitchTitle">Cambiando cuenta activa a:</h3>
        <p class="profile-switch-name" id="profileSwitchAccount">Cuenta</p>
        <p class="muted" id="profileSwitchSubtitle">Espera un momento...</p>
      </div>
    </div>
  </div>
  <div class="app-shell">
    <header class="topbar app-header">
      <div class="topbar-row">
        <div class="account-section">
          <div class="account-selector-card">
            <div class="account-selector-head">
              <p class="eyebrow">Cuenta activa</p>
            </div>
            <div class="account-selector-field">
              <div class="menu-field account-field-modern">
                <i class='bx bx-user-circle'></i>
                <select id="accountSelector"></select>
                <i class='bx bx-chevron-down'></i>
              </div>
            </div>
          </div>
        </div>
        <div class="top-actions">
          <div class="data-management-card">
            <div class="data-management-head">
              <p class="eyebrow">Gesti√≥n de datos</p>
            </div>
            <div class="client-file-actions">
              <label class="secondary-btn upload-btn" title="Subir archivo Excel"><i class='bx bx-upload'></i> Importar Excel<input type="file" id="clientExcel" accept=".xlsx,.xls,.csv"></label>
              <button id="exportClients" class="ghost-btn" title="Exportar clientes filtrados"><i class='bx bx-download'></i>Exportar</button>
            </div>
          </div>
          <div class="sync-status-card" id="syncStatusCard" title="Sincronizaci√≥n sin datos" role="button" tabindex="0" aria-label="Sincronizar datos con el servidor">
            <div class="sync-status-head">
              <p class="eyebrow">Sincronizaci√≥n</p>
            </div>
            <div class="sync-status-body">
              <span class="sync-status-icon" id="syncStatusIcon"><i class='bx bx-wifi'></i></span>
              <div class="sync-status-text">
                <strong id="syncStatusLabel">Sin datos</strong>
                <span class="muted tiny" id="syncStatusDetail">√öltima sincronizaci√≥n: -</span>
              </div>
            </div>
            <div class="sync-status-indicator" id="syncStatusIndicator"></div>
          </div>
          <div class="utilities-card" id="utilitiesContainer">
            <div class="utilities-head">
              <p class="eyebrow">Utilidades</p>
            </div>
            <div class="utilities-menu" id="utilitiesMenu">
              <button class="menu-trigger ghost" id="utilitiesMenuToggle"><i class='bx bx-extension'></i><span>Utilidades</span><i class='bx bx-chevron-down'></i></button>
              <div class="menu-panel" id="utilitiesMenuPanel">
                <div class="menu-head">
                  <p class="eyebrow">Utilidades</p>
                </div>
                <button class="menu-item highlight" id="openContactAssistant"><i class='bx bx-bot'></i>Modo de Contacto Express</button>
                <button class="menu-item" id="toggleEditMode"></button>
                <button class="menu-item" id="openActionCustomizer"><i class='bx bx-show-alt'></i>Personalizar acciones r√°pidas</button>
                <button class="menu-item" id="openContactLog"><i class='bx bx-time-five'></i>Registro de Contactados</button>
                <button class="menu-item" id="openImportedDataManager"><i class='bx bx-data'></i>Administrar datos importados</button>
                <button class="menu-item" id="openSmsDesigner"><i class='bx bx-message-square-dots'></i>Dise√±ador de Listas</button>
              </div>
            </div>
          </div>
          <div class="menu-cluster">
            <div class="menu-cluster-head">
              <p class="eyebrow">Ajustes y configuraciones</p>
            </div>
            <div class="menu-cluster-actions">
              <div class="action-menu" id="actionMenu">
                <button class="menu-trigger primary" id="actionMenuToggle"><i class='bx bx-collection'></i><span>Mi Perfil</span><i class='bx bx-chevron-down'></i></button>
                <div class="menu-panel" id="actionMenuPanel">
                <div class="menu-head">
                  <p class="eyebrow">Mi Perfil</p>
                </div>
                <label class="menu-item upload-btn"><i class='bx bx-upload'></i> Importar perfil<input type="file" id="importProfile" accept="application/json"></label>
                <button id="exportProfile" class="menu-item"><i class='bx bx-download'></i> Exportar perfil</button>
                <button class="menu-item" id="openModuleManagement"><i class='bx bx-grid-alt'></i>Gesti√≥n de m√≥dulos</button>
              </div>
            </div>
            <div class="icon-menu" id="settingsMenu">
              <button class="menu-trigger ghost" id="settingsToggle" title="Centro de control"><i class='bx bx-cog'></i><span>Opciones</span><i class='bx bx-dots-vertical-rounded'></i></button>
                <div class="menu-panel" id="settingsPanel">
                <div class="menu-head">
                  <p class="eyebrow">Opciones</p>
                </div>
                <button class="menu-item" id="openAccountManager"><i class='bx bx-layer-plus'></i>Gesti√≥n de cuentas</button>
                <button class="menu-item hidden" id="openAdminPanel"><i class='bx bx-shield-quarter'></i>Control de Admin</button>
                <button class="menu-item" id="openPreferences"><i class='bx bx-slider-alt'></i> Mis preferencias</button>
                <button class="menu-item" id="openPasswordModal"><i class='bx bx-key'></i> Cambiar contrase√±a</button>
                <button class="menu-item" id="openJourneyReport"><i class='bx bx-bar-chart-alt-2'></i>Informe de Jornada</button>
              </div>
            </div>
            </div>
          </div>
        </div>
      </div>
      <div class="topbar-row nav-row">
        <nav class="nav top-nav" id="mainNav">
          <button class="nav-link active" data-target="dashboard"><i class='bx bxs-dashboard'></i><span class="label"> Inicio</span></button>
          <button class="nav-link" data-target="clientManager"><i class='bx bx-group'></i><span class="label"> Gestor de Clientes</span></button>
          <button class="nav-link" data-target="scheduledClients"><i class='bx bx-calendar-check'></i><span class="label"> Clientes Programados</span></button>
          <button class="nav-link" data-target="templates"><i class='bx bx-message-dots'></i><span class="label"> Plantillas</span></button>
          <button class="nav-link" data-target="plans"><i class='bx bx-notepad'></i><span class="label"> Cotizaciones</span></button>
          <button class="nav-link" data-target="quoteGenerator" id="myQuotesToggle"><i class='bx bx-folder'></i><span class="label"> Mis Cotizaciones</span></button>
          <button class="nav-link" data-target="vehicles"><i class='bx bx-car'></i><span class="label"> Autos y Valores</span></button>
        </nav>
      </div>
    </header>
    <main class="content">

      <section id="dashboard" class="panel active">
        <div class="dashboard-hero" id="welcomeHero">
            <div class="hero-main modern">
              <div class="eyebrow">Inicio</div>
              <h2 id="dashboardHeading">Control principal</h2>
              <p class="muted" id="dashboardSubtitle"></p>
            <div class="advisor-card">
              <div class="field">
                <label>Cuenta activa</label>
                <div class="advisor-input">
                  <div class="combo-shell readonly">
                    <i class='bx bx-user-circle'></i>
                    <span id="activeAccountDisplay">Selecciona una cuenta activa en el selector superior.</span>
                  </div>
                </div>
              </div>
              <p class="muted tiny" id="advisorHelper">Selecciona la cuenta activa para personalizar el panel.</p>
              </div>
          </div>
          <div class="hero-side metrics">
            <div class="stat-tiles">
              <div class="tile" data-tone="blue">
                <div class="tile-icon">üí¨</div>
                <div>
                  <p class="label">Plantillas</p>
                  <p class="value" id="templateCount">0</p>
                </div>
              </div>
              <div class="tile" data-tone="green">
                <div class="tile-icon">üë•</div>
                <div>
                  <p class="label">Registros de clientes</p>
                  <p class="value" id="clientCount">0</p>
                </div>
              </div>
            </div>
            <div class="scheduled-summary-card">
              <p class="label">Total Clientes Programados</p>
              <p class="value" id="scheduledTotalCount">0</p>
              <div class="scheduled-summary-row">
                <span>Clientes Programados para hoy:</span>
                <strong id="scheduledTodayCount">0</strong>
              </div>
              <button class="secondary-btn mini" data-jump="scheduledClients"><i class='bx bx-right-arrow-alt'></i>Ir a Clientes Programados</button>
            </div>
          </div>
        </div>

      </section>

      <section id="templates" class="panel">
        <div class="panel-head">
          <div>
            <p class="eyebrow">Plantillas con variables</p>
            <h2>Gestor de Plantillas</h2>
            <p class="muted subtle">Permite modificar, editar y crear nuevas plantillas para copiar y utilizar r√°pidamente en los mensajes.</p>
          </div>
        </div>
        <div class="templates-layout">
          <aside class="template-list">
            <div class="template-list-head">
              <div>
                <p class="eyebrow">Plantillas guardadas</p>
                <h3>Biblioteca</h3>
              </div>
              <button id="addTemplate" class="primary-btn ghosted"><i class='bx bx-plus'></i>Nueva plantilla</button>
            </div>
            <div class="search-field template-search">
              <i class='bx bx-search'></i>
              <input id="templateSearch" placeholder="Buscar plantillas" />
            </div>
            <div class="template-list-body" id="templateList"></div>
          </aside>
          <div class="template-editor">
            <div class="preview-stack">
              <div class="preview-box">
                <p class="eyebrow">Previsualizaci√≥n</p>
                <pre id="templatePreview"></pre>
              </div>
              <div class="actions compact">
                <div class="autosave-hint">Guardado en tiempo real</div>
                <button id="copyTemplate" class="secondary-btn"><i class='bx bx-copy'></i>Copiar esta plantilla</button>
                <span id="copyStatus" class="muted"></span>
              </div>
            </div>
            <div class="variation-tabs hidden" id="initialVariations">
              <div class="variation-tabs-head">
                <div>
                  <p class="eyebrow">Plantilla inicial</p>
                  <h4>Variaciones del mensaje</h4>
                  <p class="muted tiny">Se alternan autom√°ticamente al copiar el mensaje.</p>
                </div>
                <button id="addVariation" class="ghost-btn mini"><i class='bx bx-plus'></i>Agregar variaci√≥n</button>
              </div>
              <div class="variation-tabs-list" id="variationTabs"></div>
            </div>
            <div class="field">
              <label for="templateTitle">T√≠tulo</label>
              <input id="templateTitle" placeholder="Ej: Mensaje de inicio" />
            </div>
            <div class="field textarea-field">
              <label for="templateBody">Contenido</label>
              <div class="textarea-shell">
                <div class="template-editor-toolbar">
                  <button class="ghost-btn mini" id="openDynamicData"><i class='bx bx-code-alt'></i>Agregar Dato Din√°mico...</button>
                  <div class="dynamic-data-panel hidden" id="dynamicDataPanel">
                    <div class="dynamic-data-head">
                      <div>
                        <p class="eyebrow">Datos din√°micos</p>
                        <h4>Insertar variables</h4>
                      </div>
                      <button class="ghost-btn icon-only" id="closeDynamicData" title="Cerrar"><i class='bx bx-x'></i></button>
                    </div>
                    <div class="search-field compact">
                      <i class='bx bx-search'></i>
                      <input id="dynamicDataSearch" placeholder="Buscar variable..." />
                    </div>
                    <div class="dynamic-data-list" id="dynamicDataList"></div>
                  </div>
                </div>
                <div id="templateBody" class="template-editor-input" contenteditable="true" role="textbox" aria-multiline="true" data-placeholder="Escribe el mensaje con variables"></div>
              </div>
            </div>
            <div class="variables-shell">
              <div class="variables-head">
                <p class="eyebrow">Variables activas</p>
                <p class="muted tiny">Solo las que est√°n en el mensaje.</p>
              </div>
              <div class="chips variable-chip-row" id="variableChips"></div>
              <div class="variable-actions">
                <button class="secondary-btn mini" id="refreshAutoVariables"><i class='bx bx-refresh'></i>Cargar otros valores autom√°ticos...</button>
                <span class="muted tiny" id="autoVariableHint"></span>
              </div>
              <div class="variable-grid" id="variableInputs"></div>
            </div>
          </div>
        </div>
      </section>

      <section id="vehicles" class="panel">
        <div class="panel-head">
          <div>
            <p class="eyebrow">Productos y precios</p>
            <h2>Gestor de Productos y Precios</h2>
            <p class="muted">Te damos la bienvenida al Gestor de Productos y Precios.</p>
            <p class="muted subtle" id="vehicleUpdateTag">√öltima actualizaci√≥n: Diciembre 2025</p>
          </div>
          <div class="toggles">
            <div class="field compact">
              <label for="vehicleBrandFilter">Filtrar por marca</label>
              <select id="vehicleBrandFilter"></select>
            </div>
            <button id="viewOnlineFiles" class="ghost-btn" type="button"><i class='bx bx-cloud'></i>Ver archivos online</button>
          </div>
        </div>
        <div class="price-tabs">
          <div class="tab-manager">
            <div>
              <p class="eyebrow">Marcas de precios detectadas</p>
              <p class="muted tiny" id="priceTabSubtitle">Precios en modo local</p>
            </div>
            <div id="priceAlerts" class="alert-stack compact"></div>
            <div class="actions compact price-selector">
              <div class="field compact">
                <label for="priceTabSelect">Lista disponible</label>
                <select id="priceTabSelect"></select>
              </div>
              <button class="ghost-btn" id="openVehicleEditor" type="button"><i class='bx bx-edit'></i>Modo editor</button>
            </div>
          </div>
        </div>
        <div class="vehicle-table-stack" id="vehicleTables"></div>
      </section>

      <section id="plans" class="panel">
        <div class="panel-head">
          <div>
            <p class="muted subtle">Simulador de Cotizaciones <br><h5>Advertencia: Esto es meramente experimental:</h5> Las cotizaciones se recomienda hacerlas a mano con la informaci√≥n aprendida.</p>
          </div>
          <div class="actions">
            <button id="saveClient" class="primary-btn"><i class='bx bx-save'></i>Guardar cotizaci√≥n</button>
            <button id="addQuoteToMyQuotes" class="secondary-btn" type="button"><i class='bx bx-file'></i>Agregar a "Mis Cotizaciones"</button>
            <button id="copyQuote" class="secondary-btn" type="button"><i class='bx bx-copy'></i>Copiar cotizaci√≥n</button>
            <button id="openQuoteModal" class="ghost-btn" type="button"><i class='bx bx-archive'></i>Ver cotizaciones guardadas</button>
          </div>
        </div>
        <div class="resource-row">
          <div class="resource-card">
            <div class="resource-preview" style="background-image:url('img/Template/InfoAuto.jpg');"></div>
            <div class="resource-meta">
              <p class="eyebrow">Logo InfoAuto</p>
              <p class="muted tiny">√ösalo como imagen de respaldo en env√≠os al cliente.</p>
            </div>
            <div class="actions compact">
              <button id="viewInfoAuto" class="ghost-btn" type="button"><i class='bx bx-show'></i>Ver imagen</button>
              <button id="downloadInfoAuto" class="secondary-btn" type="button"><i class='bx bx-download'></i>Descargar</button>
            </div>
          </div>
          <div class="resource-card">
            <div class="resource-preview" style="background-image:url('img/Template/FotosReferenciaParaCliente.jpg');"></div>
            <div class="resource-meta">
              <p class="eyebrow">Imagen de referencia</p>
              <p class="muted tiny">Desc√°rgala para compartir junto a la cotizaci√≥n.</p>
            </div>
            <div class="actions compact">
              <button id="viewClientReference" class="ghost-btn" type="button"><i class='bx bx-show'></i>Ver imagen</button>
              <button id="downloadClientReference" class="secondary-btn" type="button"><i class='bx bx-download'></i>Descargar imagen de Referencia para cliente</button>
            </div>
          </div>
        </div>
        <div class="quote-layout">
          <aside class="card form quote-form">
            <div class="card-head compact">
              <p class="eyebrow">Carga r√°pida</p>
              <h3>Datos de cotizaci√≥n</h3>
            </div>
            
            <!-- Secci√≥n Cliente - Ancho completo -->
            <div class="quote-section-client">
              <div class="field">
                <label for="clientName"><i class='bx bx-user-circle'></i>Cliente</label>
                <div class="picker-row dense client-picker-row">
                  <input id="clientName" placeholder="Nombre y apellido" />
                  <button id="openClientPicker" class="secondary-btn mini" type="button"><i class='bx bx-user-voice'></i>Asistente de selecci√≥n...</button>
                </div>
                <p class="muted tiny" id="selectedClientHint">Puedes escribir los datos o aplicar uno importado.</p>
              </div>
            </div>

            <!-- Secci√≥n Auto y Informaci√≥n -->
            <div class="quote-section-vehicle">
              <div class="form-grid three">
                <div class="field">
                  <div class="label-row">
                    <label for="planModel">Auto a cotizar</label>
                    <span class="muted tiny micro-tag" id="priceContextTag">Utilizando precios de: Diciembre 2025</span>
                  </div>
                  <select id="planModel"></select>
                </div>
                <div class="field readonly">
                  <label>Plan asignado autom√°ticamente</label>
                  <div class="plan-profile-cell readonly">
                    <span class="chip muted" id="planProfileChip"></span>
                    <small class="muted tiny" id="planProfileHelper">El plan se selecciona solo seg√∫n el modelo.</small>
                  </div>
                  <input type="hidden" id="planType" value="85a120" />
                </div>
                <div class="field">
                  <label class="toggle compact">
                    <input type="checkbox" id="tradeIn" checked>
                    <span>Entrega llave x llave</span>
                  </label>
                  <div class="money-field">
                    <span class="prefix">$</span>
                    <input id="tradeInValue" class="money" type="text" inputmode="numeric" placeholder="Valor estimado usado" />
                  </div>
                </div>
              </div>

              <!-- Valor del Coche -->
              <div class="field">
                <label for="customPrice">Ingresa el Valor del coche a Cotizar</label>
                <div class="money-field">
                  <span class="prefix">$</span>
                  <input id="customPrice" class="money" type="text" inputmode="numeric" placeholder="Valor del coche a cotizar" />
                </div>
              </div>

              <!-- Integraci√≥n Posible - Debajo del valor -->
              <div class="field readonly integration-card">
                <label>Integraci√≥n posible</label>
                <div class="integration-details" id="integrationDetails">
                  <p id="integration1">1 cuota promocionada: $0</p>
                  <p id="integration3">3 cuotas "sin inter√©s" de: $0 cada una</p>
                  <p id="integration6">6 cuotas "sin inter√©s" de: $0 cada una</p>
                </div>
                <input type="hidden" id="appliedReservation" value="1" />
              </div>
            </div>

            <!-- Secci√≥n Reservas -->
            <div class="field-group compact">
              <div class="field-head">
                <div>
                  <p class="eyebrow">Reservas editables</p>
                  <p class="muted tiny">Valores del mes traducidos de la lista oficial.</p>
                </div>
                <div class="reservation-actions">
                  <button id="calcReservation3" class="ghost-btn mini" type="button"><i class='bx bx-calculator'></i>3 cuotas</button>
                  <button id="calcReservation6" class="ghost-btn mini" type="button"><i class='bx bx-math'></i>6 cuotas</button>
                </div>
              </div>
              <div class="reservation-grid compact">
                <div class="field">
                  <label for="reservation1">1 cuota</label>
                  <div class="money-field">
                    <span class="prefix">$</span>
                    <input id="reservation1" class="money" type="text" inputmode="numeric" placeholder="Reserva √∫nica" />
                  </div>
                </div>
                <div class="field">
                  <label for="reservation3">3 cuotas</label>
                  <div class="money-field">
                    <span class="prefix">$</span>
                    <input id="reservation3" class="money" type="text" inputmode="numeric" placeholder="Reserva 3 pagos" />
                  </div>
                </div>
                <div class="field">
                  <label for="reservation6">6 cuotas</label>
                  <div class="money-field">
                    <span class="prefix">$</span>
                    <input id="reservation6" class="money" type="text" inputmode="numeric" placeholder="Reserva 6 pagos" />
                  </div>
                </div>
              </div>
            </div>

            <!-- Observaciones -->
            <div class="field">
              <label for="notes">Observaciones</label>
              <textarea id="notes" rows="3" placeholder="Chevrolet Onix LTZ Febrero 2026"></textarea>
            </div>
          </aside>

          <div class="quote-details">
            <section class="plan-folio">
              <div class="folio-head">
                <div>
                  <p class="eyebrow">Detalle simplificado</p>
                  <h3>Folleto del plan</h3>
                </div>
                <div class="folio-switch">
                  <label class="toggle">
                    <input type="checkbox" id="advancePayments">
                    <span>¬øEl cliente quiere adelantar cuotas?</span>
                  </label>
                  <div class="money-field compact" id="advanceAmountField">
                    <span class="prefix">$</span>
                    <input id="advanceAmount" class="money" type="text" inputmode="numeric" placeholder="Monto a adelantar" />
                  </div>
                  <p class="muted tiny">Si adelanta, se descuentan las √∫ltimas cuotas primero usando la cuota pura.</p>
                </div>
              </div>
              <div class="folio-cta-row">
                <button id="openInstallmentBreakdown" class="secondary-btn" type="button"><i class='bx bx-list-ol'></i>Ver desglose completo</button>
              </div>
              <div class="folio-body">
                <div class="folio-section">
                  <h4>Datos principales</h4>
                  <div id="planBasicsList" class="folio-list"></div>
                </div>
                <div class="folio-section">
                  <h4>Integraci√≥n y cuota 1</h4>
                  <div id="planIntegrationSummary" class="folio-list"></div>
                </div>
              </div>
              <div class="folio-body">
                <div class="folio-section">
                  <h4>Saldo y aportes</h4>
                  <div id="planBalanceSummary" class="folio-list"></div>
                </div>
                <div class="folio-section">
                  <h4>Cuotas por tramo</h4>
                  <div id="planRangeList" class="range-grid"></div>
                </div>
              </div>
              <div class="folio-section wide">
                <h4>Estado de cuotas</h4>
                <div id="planCoverageList" class="coverage-grid"></div>
              </div>
            </section>
          </div>
        </div>
      </section>
      <section id="quoteGenerator" class="panel quote-generator-panel" data-view="hub">
        <div class="panel-head">
          <div>
            <h2>Mis Cotizaciones</h2>
          </div>
          <div class="actions">
            <button id="quoteGeneratorDeleteActive" class="ghost-btn danger" type="button"><i class='bx bx-trash'></i>Eliminar esta cotizaci√≥n</button>
            <button id="quoteGeneratorReassign" class="ghost-btn" type="button"><i class='bx bx-transfer-alt'></i>Reasignar cliente</button>
            <div class="quote-export-actions">
              <span class="export-label">Exportar</span>
              <button id="quoteGeneratorExportPdf" class="secondary-btn" type="button"><i class='bx bxs-file-pdf'></i>PDF</button>
              <button id="quoteGeneratorExportPng" class="ghost-btn" type="button"><i class='bx bx-image'></i>PNG</button>
            </div>
          </div>
        </div>
        <div class="quote-generator-shell">
          <section class="quote-generator-hub" id="quoteGeneratorHub">
            <div class="card quote-hub-card">
              <div class="card-head">
                <div>
                  <p class="eyebrow">Mis Cotizaciones</p>
                  <h3>Gestiona tus cotizaciones</h3>
                </div>
                <div class="actions">
                  <button id="quoteGeneratorCreate" class="primary-btn" type="button"><i class='bx bx-plus'></i>Nueva cotizaci√≥n</button>
                </div>
              </div>
              <div class="quote-hub-toolbar">
                <div class="search-field">
                  <i class='bx bx-search'></i>
                  <input id="quoteGeneratorSearchInput" placeholder="Buscar por nombre de cliente" />
                </div>
                <div class="quote-hub-toolbar-actions">
                  <button id="quoteGeneratorSearchBtn" class="secondary-btn mini" type="button"><i class='bx bx-search'></i>Buscar</button>
                  <button id="quoteGeneratorSearchClear" class="ghost-btn mini" type="button"><i class='bx bx-x'></i>Limpiar</button>
                </div>
              </div>
              <div class="quote-hub-filter hidden" id="quoteGeneratorClientFilter"></div>
              <div class="quote-hub-empty" id="quoteGeneratorEmpty">
                <i class='bx bx-folder-open'></i>
                <div>
                  <h4>No tienes actualmente ninguna Cotizaci√≥n abierta</h4>
                  <p class="muted">Crea una nueva cotizaci√≥n o importa una existente para comenzar.</p>
                </div>
              </div>
              <div class="quote-hub-list" id="quoteGeneratorList"></div>
            </div>
          </section>
          <section class="quote-generator-workspace is-hidden" id="quoteGeneratorWorkspace">
            <div class="card quote-alias-editor">
              <div class="card-head compact">
                <p class="eyebrow">Nombre visible</p>
                <h3>Nombre de la cotizaci√≥n</h3>
                <p class="muted tiny">Modifica el nombre con el que aparecer√° esta cotizaci√≥n en ‚ÄúMis Cotizaciones‚Äù.</p>
              </div>
              <div class="field">
                <label for="quoteGeneratorAliasInput">Nombre para guardar esta cotizaci√≥n</label>
                <input id="quoteGeneratorAliasInput" placeholder="Nombre de la cotizaci√≥n" />
              </div>
            </div>
            <div class="quote-generator-layout">
              <aside class="card quote-generator-form" id="quoteGeneratorForm">
            <div class="card-head compact">
              <p class="eyebrow">Panel de control</p>
              <h3>Datos principales</h3>
            </div>
            <div class="quote-tabs">
              <div class="quote-tabs-nav" role="tablist" aria-label="Secciones de la cotizaci√≥n">
                <button class="quote-tab active" id="quote-tab-btn-main" type="button" data-tab-target="quote-tab-main" role="tab" aria-selected="true" aria-controls="quote-tab-main" title="Datos principales" aria-label="Datos principales">
                  <i class='bx bx-detail' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-client" type="button" data-tab-target="quote-tab-client" role="tab" aria-selected="false" aria-controls="quote-tab-client" title="Datos cliente" aria-label="Datos cliente">
                  <i class='bx bx-user' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-vehicle" type="button" data-tab-target="quote-tab-vehicle" role="tab" aria-selected="false" aria-controls="quote-tab-vehicle" title="Veh√≠culo usado" aria-label="Veh√≠culo usado">
                  <i class='bx bx-car' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-new-vehicle" type="button" data-tab-target="quote-tab-new-vehicle" role="tab" aria-selected="false" aria-controls="quote-tab-new-vehicle" title="Nuevo veh√≠culo" aria-label="Nuevo veh√≠culo">
                  <i class='bx bx-plus-circle' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-payments" type="button" data-tab-target="quote-tab-payments" role="tab" aria-selected="false" aria-controls="quote-tab-payments" title="Esquema de pagos" aria-label="Esquema de pagos">
                  <i class='bx bx-credit-card' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-prequote" type="button" data-tab-target="quote-tab-prequote" role="tab" aria-selected="false" aria-controls="quote-tab-prequote" title="Seleccionar modo de cotizaci√≥n" aria-label="Seleccionar modo de cotizaci√≥n">
                  <i class='bx bx-toggle-left' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-notes" type="button" data-tab-target="quote-tab-notes" role="tab" aria-selected="false" aria-controls="quote-tab-notes" title="Notas" aria-label="Notas">
                  <i class='bx bx-note' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-extras" type="button" data-tab-target="quote-tab-extras" role="tab" aria-selected="false" aria-controls="quote-tab-extras" title="Beneficios y gastos" aria-label="Beneficios y gastos">
                  <i class='bx bx-edit' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-visibility" type="button" data-tab-target="quote-tab-visibility" role="tab" aria-selected="false" aria-controls="quote-tab-visibility" title="Visibilidad" aria-label="Visibilidad">
                  <i class='bx bx-show' aria-hidden="true"></i>
                </button>
                <button class="quote-tab" id="quote-tab-btn-storage" type="button" data-tab-target="quote-tab-storage" role="tab" aria-selected="false" aria-controls="quote-tab-storage" title="Guardar y cargar" aria-label="Guardar y cargar">
                  <i class='bx bx-save' aria-hidden="true"></i>
                </button>
              </div>
              <div class="quote-tabs-panels">
                <section class="quote-tab-panel active" id="quote-tab-main" role="tabpanel" aria-labelledby="quote-tab-btn-main">
                  <div class="form-grid two">
                    <div class="field is-required">
                      <label for="quoteNumber">Cotizaci√≥n #</label>
                      <div class="auto-row">
                        <input id="quoteNumber" data-quote-field="meta.quoteNumber" placeholder="00000000" />
                        <button class="ghost-btn mini auto-btn" data-auto-field="meta.quoteNumber" type="button">Auto</button>
                      </div>
                    </div>
                    <div class="field is-required">
                      <label for="quoteDate">Fecha de Cotizaci√≥n</label>
                      <div class="auto-row">
                        <input id="quoteDate" data-quote-field="meta.quoteDate" placeholder="dd/mm/aaaa" />
                        <button class="ghost-btn mini auto-btn" data-auto-field="meta.quoteDate" type="button">Auto</button>
                      </div>
                    </div>
                    <div class="field">
                      <label for="quoteExpiry">Vencimiento</label>
                      <div class="auto-row">
                        <input id="quoteExpiry" data-quote-field="meta.quoteExpiry" placeholder="dd/mm/aaaa" />
                        <button class="ghost-btn mini auto-btn" data-auto-field="meta.quoteExpiry" type="button">Auto</button>
                      </div>
                    </div>
                    <div class="field is-required">
                      <label for="quoteAdvisor">Asesor Comercial</label>
                      <div class="auto-row">
                        <input id="quoteAdvisor" data-quote-field="meta.advisor" placeholder="Nombre del asesor" />
                        <button class="ghost-btn mini auto-btn" data-auto-field="meta.advisor" type="button">Auto</button>
                      </div>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-client" role="tabpanel" aria-labelledby="quote-tab-btn-client">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Datos Cliente</p>
                        <p class="muted tiny">Completa manualmente o usa autom√°tico.</p>
                      </div>
                      <div class="actions compact">
                        <button class="ghost-btn mini auto-btn" data-auto-fill="client" type="button">Auto cliente</button>
                      </div>
                    </div>
                    <div class="form-grid three">
                      <div class="field is-required">
                        <label for="clientFullName">Nombre</label>
                        <div class="auto-row">
                          <input id="clientFullName" data-quote-field="client.name" placeholder="Nombre completo" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="client.name" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field is-required">
                        <label for="clientDni">DNI</label>
                        <div class="auto-row">
                          <input id="clientDni" data-quote-field="client.dni" placeholder="00.000.000" inputmode="numeric" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="client.dni" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field is-required">
                        <label for="clientCuil">CUIL</label>
                        <div class="auto-row">
                          <input id="clientCuil" data-quote-field="client.cuil" placeholder="20-00000000-0" inputmode="numeric" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="client.cuil" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field is-required">
                        <label for="clientCel">CEL</label>
                        <div class="auto-row">
                          <input id="clientCel" data-quote-field="client.cel" placeholder="+54 9 11 0000 0000" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="client.cel" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field is-required">
                        <label for="clientProvince">Provincia</label>
                        <div class="auto-row">
                          <input id="clientProvince" data-quote-field="client.province" placeholder="Provincia" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="client.province" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field is-required">
                        <label for="clientCity">Localidad</label>
                        <div class="auto-row">
                          <input id="clientCity" data-quote-field="client.city" placeholder="Localidad" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="client.city" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field is-required">
                        <label for="clientPostal">CP</label>
                        <div class="auto-row">
                          <input id="clientPostal" data-quote-field="client.postalCode" placeholder="0000" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="client.postalCode" type="button">Auto</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-vehicle" role="tabpanel" aria-labelledby="quote-tab-btn-vehicle">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Datos Veh√≠culo</p>
                        <p class="muted tiny">Veh√≠culo a entregar y valores de referencia.</p>
                      </div>
                      <div class="actions compact">
                        <button class="ghost-btn mini auto-btn" data-auto-fill="vehicle" type="button">Auto veh√≠culo</button>
                      </div>
                    </div>
                    <div class="form-grid two">
                      <div class="field is-required">
                        <label for="vehicleBrand">Marca</label>
                        <div class="auto-row">
                          <input id="vehicleBrand" list="quoteBrandSuggestions" data-quote-field="vehicle.brand" placeholder="Marca" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="vehicle.brand" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field is-required">
                        <label for="vehicleModel">Modelo y Versi√≥n</label>
                        <div class="auto-row">
                          <input id="vehicleModel" data-quote-field="vehicle.model" placeholder="Modelo y versi√≥n" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="vehicle.model" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field">
                        <label for="vehicleYear">A√±o</label>
                        <input id="vehicleYear" data-quote-field="vehicle.year" placeholder="2024" />
                      </div>
                      <div class="field">
                        <label for="vehiclePlate">Patente</label>
                        <input id="vehiclePlate" data-quote-field="vehicle.plate" placeholder="ABC123" />
                      </div>
                      <div class="field">
                        <label for="vehicleKms">Kms</label>
                        <input id="vehicleKms" data-quote-field="vehicle.kms" placeholder="0 km" />
                      </div>
                      <div class="field">
                        <label for="vehicleFactoryPriceLabel">Texto del precio cotizado</label>
                        <input id="vehicleFactoryPriceLabel" data-quote-field="vehicle.factoryPriceLabel" placeholder="Precio cotizado por F√°brica" />
                      </div>
                      <div class="field">
                        <label for="vehicleFactoryPrice">Monto del precio cotizado</label>
                        <div class="money-field">
                          <span class="prefix">$</span>
                          <input id="vehicleFactoryPrice" class="money" type="text" inputmode="numeric" data-quote-field="vehicle.factoryPrice" placeholder="0" />
                        </div>
                      </div>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-new-vehicle" role="tabpanel" aria-labelledby="quote-tab-btn-new-vehicle">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Datos nuevo Veh√≠culo</p>
                        <p class="muted tiny">Informaci√≥n del 0km.</p>
                      </div>
                      <div class="actions compact">
                        <button class="ghost-btn mini auto-btn" data-auto-fill="newVehicle" type="button">Auto 0km</button>
                      </div>
                    </div>
                    <label class="toggle inline selection-mode">
                      <input type="checkbox" id="newVehicleCustomToggle">
                      <span>Otro Modelo / Personalizado</span>
                    </label>
                    <div class="form-grid two new-vehicle-auto">
                      <div class="field is-required">
                        <label for="newVehicleBrandSelect">Marca (selecci√≥n autom√°tica)</label>
                        <select id="newVehicleBrandSelect"></select>
                      </div>
                      <div class="field is-required">
                        <label for="newVehicleModelSelect">Auto (selecci√≥n autom√°tica)</label>
                        <select id="newVehicleModelSelect"></select>
                      </div>
                    </div>
                    <div class="form-grid two new-vehicle-manual is-hidden">
                      <div class="field is-required">
                        <label for="newVehicleBrand">Marca</label>
                        <div class="auto-row">
                          <input id="newVehicleBrand" list="quoteBrandSuggestions" data-quote-field="newVehicle.brand" placeholder="Marca" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="newVehicle.brand" type="button">Auto</button>
                        </div>
                      </div>
                      <div class="field is-required">
                        <label for="newVehicleModel">Modelo y Versi√≥n</label>
                        <div class="auto-row">
                          <input id="newVehicleModel" data-quote-field="newVehicle.model" placeholder="Modelo y versi√≥n" />
                          <button class="ghost-btn mini auto-btn" data-auto-field="newVehicle.model" type="button">Auto</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-payments" role="tabpanel" aria-labelledby="quote-tab-btn-payments">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Cuota pura</p>
                        <p class="muted tiny">Valor base que se imprime como una cuota adicional.</p>
                      </div>
                      <div class="actions compact">
                        <button class="ghost-btn mini auto-btn" data-auto-cuota-pura type="button">Auto cuota pura</button>
                      </div>
                    </div>
                    <div class="form-grid two">
                      <div class="field">
                        <label for="quoteCuotaPuraAmount">Monto</label>
                        <div class="money-field">
                          <span class="prefix">$</span>
                          <input id="quoteCuotaPuraAmount" class="money" type="text" inputmode="numeric" data-quote-field="cuotaPura.amount" placeholder="0" />
                        </div>
                      </div>
                      <div class="field">
                        <label for="quoteCuotaPuraDetail">Detalle</label>
                        <input id="quoteCuotaPuraDetail" data-quote-field="cuotaPura.detail" placeholder="Ej: Cuota pura base del plan" />
                      </div>
                    </div>
                  </div>
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Esquema de pagos</p>
                        <p class="muted tiny">Agrega o edita tramos seg√∫n tu propuesta.</p>
                      </div>
                      <div class="actions compact">
                        <button class="ghost-btn mini auto-btn" data-auto-payments type="button">Auto esquema</button>
                        <button class="secondary-btn mini" id="addPaymentRow" type="button"><i class='bx bx-plus'></i>Agregar cuota</button>
                      </div>
                    </div>
                    <div id="paymentRows" class="payment-rows"></div>
                  </div>
                  <div class="bonified-options">
                  <div class="field-group compact bonified-option">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Opci√≥n 1: 1 Pago Bonificado</p>
                        <p class="muted tiny">Configura la bonificaci√≥n y el valor percibido por el cliente.</p>
                      </div>
                    </div>
                    <div class="form-grid two">
                      <div class="field">
                        <label for="bonifiedOneOriginal">Valor Original</label>
                        <div class="money-field">
                          <span class="prefix">$</span>
                          <input id="bonifiedOneOriginal" class="money" type="text" inputmode="numeric" data-quote-field="bonifiedPayments.one.fakeOriginal" placeholder="0" />
                        </div>
                      </div>
                      <div class="field bonified-bonification-field">
                        <label for="bonifiedOneDiscount">Bonif.</label>
                        <div class="money-field">
                          <span class="prefix">$</span>
                          <input id="bonifiedOneDiscount" class="money" type="text" inputmode="numeric" data-quote-field="bonifiedPayments.one.bonification" placeholder="0" readonly disabled />
                        </div>
                      </div>
                      <div class="field">
                        <label for="bonifiedOneConcept">Concepto (interno)</label>
                        <input id="bonifiedOneConcept" data-quote-field="bonifiedPayments.one.concept" placeholder="Ej: Bonificaci√≥n contado" />
                      </div>
                      <div class="field">
                        <label for="bonifiedOneAmount">A pagar (1 pago)</label>
                        <div class="auto-row">
                          <div class="money-field">
                            <span class="prefix">$</span>
                            <input id="bonifiedOneAmount" class="money" type="text" inputmode="numeric" data-quote-field="bonifiedPayments.one.amount" placeholder="0" />
                          </div>
                          <button class="ghost-btn mini auto-btn" data-auto-bonified="one" type="button">Recargar</button>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="field-group compact bonified-option">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Opci√≥n 2: 3 cuotas sin interes</p>
                        <p class="muted tiny">Aplica una bonificaci√≥n distinta para pagos fraccionados.</p>
                      </div>
                    </div>
                    <div class="form-grid two">
                      <div class="field">
                        <label for="bonifiedThreeOriginal">Valor Original</label>
                        <div class="money-field">
                          <span class="prefix">$</span>
                          <input id="bonifiedThreeOriginal" class="money" type="text" inputmode="numeric" data-quote-field="bonifiedPayments.three.fakeOriginal" placeholder="0" />
                        </div>
                      </div>
                      <div class="field bonified-bonification-field">
                        <label for="bonifiedThreeDiscount">Bonif.</label>
                        <div class="money-field">
                          <span class="prefix">$</span>
                          <input id="bonifiedThreeDiscount" class="money" type="text" inputmode="numeric" data-quote-field="bonifiedPayments.three.bonification" placeholder="0" readonly disabled />
                        </div>
                      </div>
                      <div class="field">
                        <label for="bonifiedThreeConcept">Concepto (interno)</label>
                        <input id="bonifiedThreeConcept" data-quote-field="bonifiedPayments.three.concept" placeholder="Ej: Bonificaci√≥n 3 pagos" />
                      </div>
                      <div class="field">
                        <label for="bonifiedThreeAmount">A pagar (3 pagos)</label>
                        <div class="auto-row">
                          <div class="money-field">
                            <span class="prefix">$</span>
                            <input id="bonifiedThreeAmount" class="money" type="text" inputmode="numeric" data-quote-field="bonifiedPayments.three.amount" placeholder="0" />
                          </div>
                          <button class="ghost-btn mini auto-btn" data-auto-bonified="three" type="button">Recargar</button>
                        </div>
                      </div>
                    </div>
                  </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-prequote" role="tabpanel" aria-labelledby="quote-tab-btn-prequote">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Seleccionar modo de cotizaci√≥n</p>
                        <p class="muted tiny">Activa el modo Pre-Cotizaci√≥n cuando necesites validaciones adicionales.</p>
                      </div>
                    </div>
                    <label class="toggle inline">
                      <input type="checkbox" id="preQuoteEnabled" data-quote-field="preQuote.enabled">
                      <span>Activar modo Pre Cotizaci√≥n</span>
                    </label>
                    <div class="field textarea-field">
                      <label for="preQuoteMessage">Mensaje visible en el documento</label>
                      <textarea id="preQuoteMessage" data-quote-field="preQuote.message" rows="4" placeholder="Escribe la leyenda para el cliente."></textarea>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-notes" role="tabpanel" aria-labelledby="quote-tab-btn-notes">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Notas</p>
                        <p class="muted tiny">Informaci√≥n adicional del documento.</p>
                      </div>
                    </div>
                    <div class="field">
                      <label for="quoteNotes">Notas y aclaraciones</label>
                      <textarea id="quoteNotes" data-quote-field="notes" rows="4" placeholder="Escribe el detalle que quieras imprimir."></textarea>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-extras" role="tabpanel" aria-labelledby="quote-tab-btn-extras">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Beneficios y gastos</p>
                        <p class="muted tiny">Edita los beneficios visibles y los gastos de retiro.</p>
                      </div>
                    </div>
                    <div class="field textarea-field">
                      <label for="quoteBenefits">Beneficios adicionales (uno por l√≠nea)</label>
                      <textarea id="quoteBenefits" data-quote-field="benefitsText" rows="5" placeholder="Escribe cada beneficio en una l√≠nea."></textarea>
                    </div>
                    <div class="field textarea-field">
                      <label for="quoteFooter">Gastos de retiro (texto final)</label>
                      <textarea id="quoteFooter" data-quote-field="footerNote" rows="3" placeholder="Texto legal o aclaratorio."></textarea>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-visibility" role="tabpanel" aria-labelledby="quote-tab-btn-visibility">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Visibilidad de campos</p>
                        <p class="muted tiny">Oculta lo que no quieras mostrar en la cotizaci√≥n.</p>
                      </div>
                    </div>
                    <div class="visibility-grid">
                      <label class="check-pill"><input type="checkbox" data-visibility-field="meta.quoteNumber" checked> Cotizaci√≥n #</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="meta.quoteDate" checked> Fecha de cotizaci√≥n</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="meta.quoteExpiry" checked> Vencimiento</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="meta.advisor" checked> Asesor comercial</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="client.name" checked> Nombre del cliente</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="client.dni" checked> DNI</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="client.cuil" checked> CUIL</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="client.cel" checked> Celular</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="client.location" checked> Provincia y localidad</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="client.postalCode" checked> C√≥digo postal</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="vehicle.title" checked> T√≠tulo veh√≠culo a entregar</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="vehicle.brand" checked> Marca usado</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="vehicle.model" checked> Modelo y versi√≥n usado</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="vehicle.year" checked> A√±o usado</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="vehicle.plate" checked> Patente usado</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="vehicle.kms" checked> Kms usado</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="vehicle.factoryPrice" checked> Precio f√°brica usado</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="newVehicle.section" checked> Datos nuevo veh√≠culo</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="newVehicle.brand" checked> Marca 0km</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="newVehicle.model" checked> Modelo y versi√≥n 0km</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="payments" checked> Esquema de pagos</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="preQuote" checked> Modo Pre Cotizaci√≥n</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="notes" checked> Notas</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="benefits" checked> Beneficios adicionales</label>
                      <label class="check-pill"><input type="checkbox" data-visibility-field="footer" checked> Texto legal final</label>
                    </div>
                  </div>
                </section>
                <section class="quote-tab-panel" id="quote-tab-storage" role="tabpanel" aria-labelledby="quote-tab-btn-storage">
                  <div class="field-group compact">
                    <div class="field-head">
                      <div>
                        <p class="eyebrow">Guardar y cargar</p>
                        <p class="muted tiny">Administra cotizaciones guardadas.</p>
                      </div>
                    </div>
                    <div class="form-grid two">
                      <div class="field">
                        <label for="quoteGeneratorSavedList">Cotizaciones guardadas</label>
                        <select id="quoteGeneratorSavedList"></select>
                      </div>
                      <div class="field action-stack">
                        <button id="quoteGeneratorLoad" class="secondary-btn mini" type="button"><i class='bx bx-folder-open'></i>Cargar</button>
                        <button id="quoteGeneratorDelete" class="ghost-btn mini danger" type="button"><i class='bx bx-trash'></i>Eliminar</button>
                        <button id="quoteGeneratorReset" class="ghost-btn mini" type="button"><i class='bx bx-eraser'></i>Limpiar</button>
                      </div>
                    </div>
                  </div>
                </section>
              </div>
            </div>
                <datalist id="quoteBrandSuggestions"></datalist>
              </aside>
              <div class="quote-generator-preview card">
                <div class="quote-preview-shell">
                  <div class="quote-preview" id="quotePreview">
                  <div class="quote-preview-header">
                    <div>
                      <h3 data-quote-visible="meta.quoteNumber" data-focus-target="quoteNumber" data-focus-tab="quote-tab-main">Cotizaci√≥n <span id="previewQuoteNumber">00000000</span></h3>
                    </div>
                    <div class="quote-preview-meta">
                      <div data-quote-visible="meta.quoteDate" data-focus-target="quoteDate" data-focus-tab="quote-tab-main"><strong>Fecha de Cotizaci√≥n:</strong> <span id="previewQuoteDate">--/--/----</span></div>
                      <div data-quote-visible="meta.quoteExpiry" data-focus-target="quoteExpiry" data-focus-tab="quote-tab-main"><strong>Vencimiento:</strong> <span id="previewQuoteExpiry">--/--/----</span></div>
                      <div data-quote-visible="meta.advisor" data-focus-target="quoteAdvisor" data-focus-tab="quote-tab-main"><strong>Asesor Comercial:</strong> <span id="previewQuoteAdvisor">-</span></div>
                    </div>
                  </div>
                  <div class="quote-preview-alert" id="previewPreQuote" data-quote-visible="preQuote">
                    <i class='bx bx-info-circle'></i>
                    <div>
                      <p id="previewPreQuoteMessage"></p>
                    </div>
                  </div>
                  <div class="quote-preview-section">
                    <h4>Datos Cliente</h4>
                    <div class="quote-preview-grid">
                      <div data-quote-visible="client.name" data-focus-target="clientFullName" data-focus-tab="quote-tab-client"><strong>Nombre:</strong> <span id="previewClientName">-</span></div>
                      <div data-quote-visible="client.dni" data-focus-target="clientDni" data-focus-tab="quote-tab-client"><strong>DNI:</strong> <span id="previewClientDni">-</span></div>
                      <div data-quote-visible="client.cuil" data-focus-target="clientCuil" data-focus-tab="quote-tab-client"><strong>CUIL:</strong> <span id="previewClientCuil">-</span></div>
                      <div data-quote-visible="client.cel" data-focus-target="clientCel" data-focus-tab="quote-tab-client"><strong>CEL:</strong> <span id="previewClientCel">-</span></div>
                      <div data-quote-visible="client.location" data-focus-target="clientProvince" data-focus-tab="quote-tab-client"><strong>PROV. y LOCALIDAD:</strong> <span id="previewClientLocation">-</span></div>
                      <div data-quote-visible="client.postalCode" data-focus-target="clientPostal" data-focus-tab="quote-tab-client"><strong>CP:</strong> <span id="previewClientPostal">-</span></div>
                    </div>
                  </div>
                  <div class="quote-preview-divider"></div>
                  <div class="quote-preview-section">
                    <h4>Datos Veh√≠culo</h4>
                    <div class="quote-preview-title" id="previewVehicleTitle" data-quote-visible="vehicle.title">Veh√≠culo a entregar</div>
                    <div class="quote-preview-grid">
                      <div data-quote-visible="vehicle.brand" data-focus-target="vehicleBrand" data-focus-tab="quote-tab-vehicle"><strong>Marca:</strong> <span id="previewVehicleBrand">-</span></div>
                      <div data-quote-visible="vehicle.model" data-focus-target="vehicleModel" data-focus-tab="quote-tab-vehicle"><strong>Modelo y Versi√≥n:</strong> <span id="previewVehicleModel">-</span></div>
                      <div data-quote-visible="vehicle.year" data-focus-target="vehicleYear" data-focus-tab="quote-tab-vehicle"><strong>A√±o:</strong> <span id="previewVehicleYear">-</span></div>
                      <div data-quote-visible="vehicle.plate" data-focus-target="vehiclePlate" data-focus-tab="quote-tab-vehicle"><strong>Patente:</strong> <span id="previewVehiclePlate">-</span></div>
                      <div data-quote-visible="vehicle.kms" data-focus-target="vehicleKms" data-focus-tab="quote-tab-vehicle"><strong>Kms:</strong> <span id="previewVehicleKms">-</span></div>
                      <div class="quote-preview-row spaced" data-quote-visible="vehicle.factoryPrice" data-focus-target="vehicleFactoryPrice" data-focus-tab="quote-tab-vehicle"><strong id="previewVehicleFactoryLabel">Precio cotizado por F√°brica:</strong> <span id="previewVehicleFactoryPrice">-</span></div>
                    </div>
                  </div>
                  <div class="quote-preview-divider"></div>
                  <div class="quote-preview-section" data-quote-visible="newVehicle.section">
                    <h4>Datos nuevo Veh√≠culo</h4>
                    <div class="quote-preview-grid">
                      <div data-quote-visible="newVehicle.brand" data-focus-target="newVehicleBrand" data-focus-tab="quote-tab-new-vehicle"><strong>Marca:</strong> <span id="previewNewVehicleBrand">-</span></div>
                      <div data-quote-visible="newVehicle.model" data-focus-target="newVehicleModel" data-focus-tab="quote-tab-new-vehicle"><strong>Modelo y Versi√≥n:</strong> <span id="previewNewVehicleModel">-</span></div>
                    </div>
                  </div>
                  <div class="quote-preview-divider"></div>
                    <div class="quote-preview-section" data-quote-visible="payments">
                      <h4>Esquema de pagos</h4>
                      <div id="previewBonifiedPayments" class="quote-preview-bonified"></div>
                      <div id="previewPaymentList" class="quote-preview-payments"></div>
                    </div>
                  <div class="quote-preview-section" data-quote-visible="notes">
                    <h4>Notas y aclaraciones</h4>
                    <div class="quote-preview-notes" id="previewNotes" data-focus-target="quoteNotes" data-focus-tab="quote-tab-notes">
                      <p></p>
                    </div>
                  </div>
                  <div class="quote-preview-section" data-quote-visible="benefits">
                    <div class="quote-preview-title-row">
                      <h4>Benef. Adicionales otorgados</h4>
                    </div>
                    <ul class="quote-preview-list" id="previewBenefitsList" data-focus-target="quoteBenefits" data-focus-tab="quote-tab-extras"></ul>
                  </div>
                  <div class="quote-preview-footer" data-quote-visible="footer">
                    <div class="quote-preview-footer-row">
                      <span id="previewFooterText" data-focus-target="quoteFooter" data-focus-tab="quote-tab-extras">Gastos de Retiro: Acarreo, flete, patentamiento, prenda, formulario, gestor√≠a, sellado, aranceles admin. ya incluidos en valor de la cuota</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          </section>
        </div>
      </section>
      <section id="clientManager" class="panel">
        <div class="panel-head">
          <div>
            <p class="eyebrow">Clientes importados</p>
            <h2>Gestor de Clientes</h2>
          </div>
        </div>

        <div class="card">
          <div class="client-controls">
            <div class="client-actions-row">
              <div class="advisor-filters">
                <div class="toggle filter-toggle" title="Filtrar por estado de contacto">
                  <i class='bx bx-filter-alt'></i>
                  <strong id="statusFilterLabel">Mostrar todos</strong>
                  <select id="statusFilter">
                    <option value="all">Mostrar todos</option>
                    <option value="contacted">Contactado</option>
                    <option value="no_number">N√∫mero no disponible</option>
                    <option value="favorite">Favoritos</option>
                    <option value="pending">Pendientes</option>
                  </select>
                </div>
                <div class="toggle filter-toggle" title="Filtrar por tipo de estado">
                  <i class='bx bx-category-alt'></i>
                  <strong id="statusTypeFilterLabel">Todos los estados</strong>
                  <select id="statusTypeFilter">
                    <option value="all">Todos los estados</option>
                  </select>
                </div>
                <div class="toggle filter-toggle" title="Filtrar por cuenta de contacto">
                  <i class='bx bx-user-pin'></i>
                  <strong id="accountFilterLabel">Todas</strong>
                  <select id="accountFilter"></select>
                </div>
                <button class="ghost-btn" id="openDateFilter"><i class='bx bx-calendar'></i>Filtro por fecha</button>
              </div>
            </div>
          </div>
          <div id="dateFilterHelper" class="muted tiny"></div>
          <div class="column-pills" id="columnToggles"></div>
          <div class="search-notice hidden" id="clientSearchNotice">
            <div class="search-notice-text">
              <i class='bx bx-filter-alt'></i>
              <span>Se est√°n mostrando los resultados de la b√∫squeda: <strong id="clientSearchTerm"></strong></span>
            </div>
            <button class="ghost-btn mini" id="clientSearchReset">Restablecer</button>
          </div>
          <div class="table-wrapper dense">
            <div class="table-toolbar">
              <div class="search-group">
                <div class="search-field compact expandable">
                  <i class='bx bx-search'></i>
                  <input id="clientManagerSearch" placeholder="Escribe cualquier contenido a buscar..." />
                </div>
                <button class="secondary-btn" id="clientManagerSearchBtn"><i class='bx bx-search'></i>Buscar</button>
              </div>
              <div class="table-toolbar-actions">
                <div class="field compact-field inline" id="paginationToggleField">
                  <label for="clientPaginationSelect">Paginaci√≥n</label>
                  <select id="clientPaginationSelect">
                    <option value="none">Desactivada</option>
                    <option value="20">Cada 20</option>
                    <option value="50">Cada 50</option>
                    <option value="100">Cada 100</option>
                  </select>
                </div>
                <div class="pagination-bar inline hidden" id="clientPaginationBar">
                  <div class="pagination-controls">
                    <button class="ghost-btn mini" id="clientPaginationPrev"><i class='bx bx-chevron-left'></i>Anterior</button>
                    <span id="clientPaginationInfo" class="muted tiny"></span>
                    <button class="ghost-btn mini" id="clientPaginationNext">Siguiente<i class='bx bx-chevron-right'></i></button>
                  </div>
                </div>
              </div>
            </div>
            <div class="data-grid" id="clientManagerTable">
              <div class="grid-head"></div>
              <div class="grid-body"></div>
            </div>
          </div>
          <p id="clientManagerHelper" class="muted tiny"></p>
        </div>
      </section>

      <section id="smsDesigner" class="panel">
        <div class="panel-head sms-designer-head">
          <div>
            <p class="eyebrow">Utilidades conectadas</p>
            <h2>Dise√±ador de Listas</h2>
          </div>
        </div>
        <div class="sms-redesign-layout">
          <aside class="sms-left-sidebar">
            <div class="sms-sidebar-card">
              <div class="template-list-head">
                <div>
                  <h3>Mis listas</h3>
                </div>
                <button id="smsCreateList" class="primary-btn ghosted mini"><i class='bx bx-plus'></i>Nueva Lista</button>
              </div>
              <div class="search-field template-search">
                <i class='bx bx-search'></i>
                <input id="smsTemplateSearch" placeholder="Buscar listas" />
              </div>
              <div class="template-list-body" id="smsSavedLists"></div>
            </div>
          </aside>

          <div class="sms-main-editor">
            <div class="sms-editor-card">
              <div class="sms-editor-title-row">
                <div class="field sms-list-name-field">
                  <label for="smsListName">Nombre de la lista activa</label>
                  <input id="smsListName" placeholder="Ej: Campa√±a Octubre" />
                </div>
                <div class="sms-list-head-actions">
                  <button class="ghost-btn" id="smsAddColumn"><i class='bx bx-plus'></i>Agregar columna</button>
                  <button class="secondary-btn" id="smsSaveList"><i class='bx bx-save'></i>Guardar</button>
                  <button class="ghost-btn sms-dynamic-data-btn" id="openSmsDynamicData"><i class='bx bx-code-alt'></i>Datos din√°micos</button>
                </div>
              </div>

              <div class="dynamic-toolbar-row">
                <div class="dynamic-data-panel hidden" id="smsDynamicDataPanel">
                  <div class="dynamic-data-head">
                    <div>
                      <p class="eyebrow">Datos din√°micos</p>
                      <h4>Insertar variables</h4>
                    </div>
                    <button class="ghost-btn icon-only" id="closeSmsDynamicData" title="Cerrar"><i class='bx bx-x'></i></button>
                  </div>
                  <div class="search-field compact">
                    <i class='bx bx-search'></i>
                    <input id="smsDynamicDataSearch" placeholder="Buscar variable" />
                  </div>
                  <div class="dynamic-data-list" id="smsDynamicDataList"></div>
                </div>
              </div>

              <div class="sms-column-builder redesigned" id="smsColumnBuilder"></div>
            </div>
          </div>

          <aside class="sms-right-audience">
            <div class="sms-audience-card">
              <div class="card-head">
                <div>
                  <p class="eyebrow">Destinatarios</p>
                  <h3>¬øA qui√©n incluir?</h3>
                  <p class="muted tiny" id="smsAudienceSummary">Selecciona clientes para exportar.</p>
                </div>
                <div class="sms-audience-actions">
                  <button class="secondary-btn sms-download-list-btn" id="smsDownloadList"><i class='bx bx-download'></i>Descargar esta lista</button>
                  <button class="ghost-btn mini" id="smsSelectAll"><i class='bx bx-check-double'></i>Seleccionar todos</button>
                  <button class="ghost-btn mini" id="smsClearSelection"><i class='bx bx-x'></i>Limpiar</button>
                </div>
              </div>
              <div class="sms-audience-controls">
                <div class="search-group sms-audience-search-group">
                  <div class="search-field compact">
                    <i class='bx bx-search'></i>
                    <input id="smsAudienceSearch" placeholder="Buscar cliente o tel√©fono..." />
                  </div>
                  <button class="secondary-btn mini" id="smsAudienceSearchBtn"><i class='bx bx-search'></i>Buscar</button>
                </div>
                <div class="search-notice hidden" id="smsAudienceSearchNotice">
                  <div class="search-notice-text">
                    <i class='bx bx-filter-alt'></i>
                    <span>Est√°s filtrando por: <strong id="smsAudienceSearchTerm"></strong></span>
                  </div>
                  <button class="ghost-btn mini" id="smsAudienceSearchReset">Quitar filtro</button>
                </div>
                <label class="checkbox-field compact soft">
                  <input type="checkbox" id="smsExcludeWrongNumber">
                  <span>Excluir estado "N√∫mero equivocado"</span>
                </label>
                <div class="sms-exclusion-panel" id="smsExclusionPanel">
                  <div class="sms-exclusion-head">
                    <strong>Exclusiones por estado y acciones</strong>
                    <button class="ghost-btn mini" type="button" id="smsClearExclusions"><i class='bx bx-eraser'></i>Limpiar exclusiones</button>
                  </div>
                  <div class="sms-exclusion-group">
                    <p class="muted tiny">Estados de contacto</p>
                    <div class="sms-exclusion-list" id="smsExcludeStatusList"></div>
                  </div>
                  <div class="sms-exclusion-group">
                    <p class="muted tiny">Acciones personalizadas</p>
                    <div class="sms-exclusion-list" id="smsExcludeCustomList"></div>
                  </div>
                </div>
              </div>
              <div class="sms-audience-meta">
                <span class="pill subtle">Total: <strong id="smsAudienceCount">0</strong></span>
                <span class="pill subtle">Seleccionados: <strong id="smsSelectedCount">0</strong></span>
                <span class="pill subtle">Sin tel√©fono: <strong id="smsMissingCount">0</strong></span>
              </div>
              <div class="sms-audience-list" id="smsAudienceList"></div>
            </div>
          </aside>
        </div>
      </section>

      <section id="importedDataManager" class="panel">
        <div class="panel-head">
          <div>
            <p class="eyebrow">Gesti√≥n de Clientes Ingresados</p>
            <h2>Administrar Datos Importados</h2>
            <p class="muted subtle">Revisa los registros importados, organiza por fecha de carga y elimina lotes completos o filas puntuales.</p>
          </div>
        </div>
        <div class="card import-manager-card">
          <div class="import-manager-header">
            <div>
              <p class="eyebrow">Base de clientes importados</p>
              <h3>Administraci√≥n de registros</h3>
              <p class="muted tiny" id="importedManagerSummary">Selecciona registros para eliminar o auditar.</p>
            </div>
            <div class="import-manager-actions">
              <div class="search-group import-manager-search">
                <div class="search-field compact">
                  <i class='bx bx-search'></i>
                  <input id="importedManagerSearch" placeholder="Buscar por nombre..." />
                </div>
                <button class="secondary-btn mini" id="importedManagerSearchBtn"><i class='bx bx-right-arrow-alt'></i>Buscar</button>
              </div>
              <button class="ghost-btn mini" id="importedManagerClear"><i class='bx bx-check-double'></i>Limpiar selecci√≥n</button>
              <button class="secondary-btn" id="importedManagerManual"><i class='bx bx-user-plus'></i>Nuevo cliente manual</button>
              <button class="primary-btn" id="importedManagerDelete"><i class='bx bx-trash'></i>Eliminar seleccionados</button>
            </div>
          </div>
          <div class="search-notice hidden import-manager-notice" id="importedManagerSearchNotice">
            <div class="search-notice-text">
              <i class='bx bx-filter-alt'></i>
              <span>Mostrando resultados de: <strong id="importedManagerSearchTerm"></strong></span>
            </div>
            <button class="ghost-btn mini" id="importedManagerSearchReset">Restablecer</button>
          </div>
          <div class="import-manager-loader" id="importedManagerLoader" aria-live="polite">
            <div class="loader-dot"></div>
            <div class="loader-dot"></div>
            <div class="loader-dot"></div>
            <span>Obteniendo clientes...</span>
          </div>
          <div class="import-manager-content" id="importedManagerContent"></div>
        </div>
      </section>

      <section id="scheduledClients" class="panel">
        <div class="panel-head">
          <div>
            <p class="eyebrow">Agenda de recontactos</p>
            <h2>Clientes Programados</h2>
            <p class="muted subtle">Organiza tus seguimientos y mant√©n tu cronograma al d√≠a.</p>
          </div>
        </div>
        <div class="card schedule-summary">
          <div class="schedule-meta">
            <div>
              <p class="muted">Hoy es: <strong id="scheduledToday">--</strong></p>
              <p class="muted">Y son actualmente las: <strong id="scheduledNow">--</strong></p>
            </div>
            <div class="schedule-count">
              <span class="eyebrow">Clientes Programados</span>
              <p class="value" id="scheduledCount">0</p>
            </div>
          </div>
          <div class="schedule-divider"></div>
          <div class="schedule-agenda">
            <h3>Esta es tu agenda:</h3>
            <div id="scheduledTimeline" class="schedule-timeline"></div>
          </div>
        </div>
      </section>
      <section id="moduleManagement" class="panel">
        <div class="panel-head">
          <div>
            <p class="eyebrow">Gesti√≥n de Mi Perfil</p>
            <h2>Gesti√≥n de M√≥dulos</h2>
            <p class="muted subtle">Administra la importaci√≥n y exportaci√≥n individual de m√≥dulos y subm√≥dulos del sistema.</p>
          </div>
        </div>
        <div class="module-management-grid">
          <div class="card module-card">
            <div class="module-card-head">
              <div>
                <p class="eyebrow">Exportaci√≥n</p>
                <h3>Selecciona m√≥dulos y subm√≥dulos</h3>
                <p class="muted tiny">El perfil completo incluye todo, aqu√≠ puedes exportar solo lo necesario.</p>
              </div>
              <div class="module-card-actions">
                <button class="ghost-btn mini" id="moduleSelectAll">Seleccionar todo</button>
                <button class="ghost-btn mini" id="moduleClearSelection">Limpiar</button>
              </div>
            </div>
            <div id="moduleList" class="module-list"></div>
            <div class="module-export-footer">
              <span class="muted tiny" id="moduleExportCount">0 m√≥dulos seleccionados</span>
              <button class="primary-btn" id="exportModules"><i class='bx bx-download'></i>Exportar selecci√≥n</button>
            </div>
          </div>
          <div class="card module-card">
            <div class="module-card-head">
              <div>
                <p class="eyebrow">Importaci√≥n</p>
                <h3>Importar m√≥dulos y subm√≥dulos</h3>
                <p class="muted tiny">Carga un archivo y revisa lo que se reemplazar√° antes de continuar.</p>
              </div>
            </div>
            <div class="module-import-body">
              <div class="module-import-drop">
                <i class='bx bx-upload'></i>
                <div>
                  <p><strong>Arrastra aqu√≠ tu archivo o busca desde tu equipo.</strong></p>
                  <p class="muted tiny">Formatos compatibles: .json, .module</p>
                </div>
                <button class="secondary-btn" id="moduleImportTrigger"><i class='bx bx-folder-open'></i>Buscar archivo</button>
                <input type="file" id="moduleImportInput" accept="application/json,.module" hidden>
              </div>
              <div class="module-import-summary" id="moduleImportSummary">
                <div class="summary-row">
                  <span class="label">Archivo cargado:</span>
                  <strong id="moduleImportFile">Sin archivo seleccionado</strong>
                </div>
                <div class="summary-row">
                  <span class="label">Elementos detectados:</span>
                  <strong id="moduleImportItems">-</strong>
                </div>
                <p class="muted tiny" id="moduleImportHint">Una vez cargado el archivo podr√°s revisar los elementos antes de continuar.</p>
              </div>
            </div>
            <div class="module-import-footer">
              <button class="ghost-btn" id="moduleImportReset">Cancelar</button>
              <button class="primary-btn" id="moduleImportReview" disabled><i class='bx bx-check-circle'></i>Continuar</button>
            </div>
          </div>
        </div>
      </section>
    </main>
    <footer class="app-footer">
      <div>
        <p>Creado por Maximiliano Martinez | version V1.4.3 | Solo uso interno autorizado</p>
      </div>
      <div class="session-footer" id="sessionFooter">
        <span class="muted tiny" id="sessionStatus">Sesi√≥n no iniciada.</span>
        <button class="ghost-btn mini hidden" id="logoutButton"><i class='bx bx-log-out'></i>Cerrar sesi√≥n</button>
      </div>
    </footer>
  </div>
  <div class="popover-overlay fade" id="actionCustomizerOverlay">
    <div class="popover wide">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Configuraci√≥n de acciones</p>
          <h3>Personalizar acciones r√°pidas</h3>
          <p class="muted subtle">Oculta las predeterminadas o crea tus propias acciones con icono y color.</p>
        </div>
        <button class="ghost-btn icon-only" id="closeActionCustomizer"><i class='bx bx-x'></i></button>
      </div>
      <div class="customizer-content">
        <section class="action-group">
          <header class="group-head">
            <div>
              <p class="eyebrow">Acciones por defecto</p>
              <h4>Mostrar u ocultar</h4>
            </div>
          </header>
          <div class="action-list" id="defaultActionList"></div>
        </section>
        <section class="action-group">
          <header class="group-head">
            <div>
              <p class="eyebrow">Acciones personalizadas</p>
              <h4>Tus accesos r√°pidos</h4>
            </div>
          </header>
          <div class="action-list" id="customActionList"></div>
          <div class="actions center" id="customActionCreate">
            <button class="primary-btn" id="newCustomAction"><i class='bx bx-plus'></i>Crear Nueva acci√≥n Personalizada</button>
          </div>
        </section>
      </div>
    </div>
  </div>
  <div class="popover-overlay fade" id="customActionOverlay">
    <div class="popover compact" id="customActionPopover">
      <div class="popover-head">
        <div>
          <p class="eyebrow" id="customActionSubtitle">Nueva acci√≥n</p>
          <h3 id="customActionTitle">Crear acci√≥n personalizada</h3>
          <p class="muted subtle">Define icono, color y texto para tu acceso r√°pido.</p>
        </div>
        <button class="ghost-btn icon-only" id="closeCustomAction"><i class='bx bx-x'></i></button>
      </div>
      <div class="form-grid">
        <div class="field">
          <label for="customActionLabel">Texto a mostrar</label>
          <input id="customActionLabel" placeholder="Ej: Contactado por Whatsapp" />
        </div>
        <div class="field">
          <label for="customActionColor">Color a usar</label>
          <input type="color" id="customActionColor" value="#38bdf8" />
        </div>
      </div>
      <div class="field">
        <label>Icono a mostrar</label>
        <div class="icon-row">
          <div class="icon-preview" id="customIconPreview"><i class='bx bx-check-circle'></i></div>
          <button class="secondary-btn" id="openIconPicker"><i class='bx bx-grid-alt'></i>Elegir icono</button>
        </div>
      </div>
      <div class="field">
        <label for="customActionStatus">Estado autom√°tico al ejecutar</label>
        <select id="customActionStatus"></select>
      </div>
      <div class="form-actions">
        <button class="ghost-btn" id="cancelCustomAction">Cancelar</button>
        <button class="primary-btn" id="saveCustomAction"><i class='bx bx-save'></i>Guardar esta acci√≥n personalizada</button>
      </div>
    </div>
  </div>
  <div class="popover-overlay fade" id="scheduleContactOverlay">
    <div class="popover" id="scheduleContactPopover">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Programar Contacto</p>
          <h3>Agenda un nuevo recontacto</h3>
          <p class="muted subtle">Est√°s programando recontactar a: <strong id="scheduleClientName">Cliente</strong></p>
        </div>
        <button class="ghost-btn icon-only" id="closeScheduleContact"><i class='bx bx-x'></i></button>
      </div>
      <div class="form-grid two">
        <div class="field">
          <label for="scheduleDate">Selecciona una fecha</label>
          <input type="date" id="scheduleDate">
        </div>
        <div class="field">
          <label for="scheduleTime">Selecciona un horario</label>
          <input type="time" id="scheduleTime">
        </div>
      </div>
      <div class="field textarea-field">
        <label for="scheduleMessage">Motivo de Recontacto</label>
        <div class="textarea-shell">
          <textarea id="scheduleMessage" rows="4" placeholder="Escribe el mensaje o motivo principal..."></textarea>
          <div class="chips inline" id="scheduleQuickReasons">
            <button class="chip compact" type="button" data-message="Seguimiento del plan solicitado.">Seguimiento del plan</button>
            <button class="chip compact" type="button" data-message="Enviar informaci√≥n y valores actualizados.">Enviar informaci√≥n</button>
            <button class="chip compact" type="button" data-message="Confirmar documentaci√≥n y pr√≥ximos pasos.">Confirmar documentaci√≥n</button>
            <button class="chip compact" type="button" data-message="Recordatorio de propuesta y beneficios.">Recordatorio</button>
          </div>
        </div>
      </div>
      <div class="field">
        <label>Forma de Contacto</label>
        <div class="schedule-contact-options">
          <label class="toggle option-card">
            <input type="radio" name="scheduleContactMethod" value="whatsapp" checked>
            <span>Mensaje de Whatsapp</span>
          </label>
          <label class="toggle option-card">
            <input type="radio" name="scheduleContactMethod" value="phone">
            <span>Llamada telef√≥nica</span>
          </label>
          <label class="toggle option-card">
            <input type="radio" name="scheduleContactMethod" value="other">
            <span>Otro</span>
          </label>
        </div>
      </div>
      <div class="field hidden" id="scheduleOtherContactField">
        <label for="scheduleOtherContact">Especificar otra forma</label>
        <input id="scheduleOtherContact" placeholder="Ej: Videollamada, email, reuni√≥n presencial">
      </div>
      <div class="modal-actions">
        <button class="ghost-btn" id="cancelScheduleContact">Cancelar</button>
        <button class="primary-btn" id="confirmScheduleContact"><i class='bx bx-check-circle'></i>Programar</button>
      </div>
    </div>
  </div>
  <div class="popover-overlay fade" id="iconPickerOverlay">
    <div class="popover nested" id="iconPickerPopover">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Selector de iconos</p>
          <h3>Elige un √≠cono</h3>
          <p class="muted subtle">Explora la biblioteca y selecciona el que mejor identifique tu acci√≥n.</p>
        </div>
        <button class="ghost-btn icon-only" id="closeIconPicker"><i class='bx bx-x'></i></button>
      </div>
      <div class="icon-picker" id="customActionIcons"></div>
    </div>
  </div>
  <div class="popover-overlay" id="clientActionOverlay">
    <div class="popover wide" id="clientActionMenu">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Men√∫ de acciones</p>
          <h3 id="clientActionTitle">Editar contacto</h3>
          <p class="muted subtle" id="clientActionSubtitle"></p>
        </div>
        <button class="ghost-btn icon-only" id="clientActionClose"><i class='bx bx-x'></i></button>
      </div>
      <div class="action-grid" id="clientActionList"></div>
    </div>
  </div>
  <div class="popover-overlay fade" id="contactAssistantOverlay">
    <div class="popover assistant" id="contactAssistantPopover">
      <div class="popover-head">
        <div>
          <h3 class="assistant-title">Contacto Express</h3>
        </div>
        <button class="ghost-btn icon-only" id="closeContactAssistant"><i class='bx bx-x'></i></button>
      </div>
      <div class="assistant-shell">
        <div class="assistant-undo hidden" id="assistantUndo">
          <div>
            <p class="muted tiny">El cliente anterior fue:</p>
            <p class="assistant-undo-text">"<span id="assistantUndoName">-</span>" y ha sido marcado como: "<span id="assistantUndoStatus">-</span>".</p>
          </div>
          <button class="secondary-btn" id="assistantUndoBtn"><i class='bx bx-undo'></i>Deshacer esta acci√≥n</button>
        </div>
        <div class="assistant-header">
          <div class="assistant-client-block">
            <div class="assistant-client-header">
              <p class="muted tiny">Cliente</p>
              <span class="assistant-pending-pill" id="assistantPendingCount">-</span>
            </div>
            <h3 id="assistantClientName">-</h3>
            <p class="muted tiny" id="assistantHelper"></p>
          </div>
          <div class="assistant-tools">
            <div class="assistant-account">
              <label class="muted tiny" for="assistantAccountSelect">Cuenta activa</label>
              <select id="assistantAccountSelect"></select>
              <p class="muted tiny" id="assistantAccountStatus"></p>
            </div>
            <button class="secondary-btn" id="assistantQuickAdjustBtn" type="button"><i class='bx bx-tachometer'></i>Ajuste r√°pido</button>
          </div>
        </div>
        <div class="assistant-layout" id="contactAssistantCard">
          <div class="assistant-card clickable" data-tone="cyan" data-assistant-action="copy_phone" role="button" tabindex="0" aria-label="Copiar tel√©fono">
            <div class="card-head">
              <p class="eyebrow">Tel√©fono</p>
              <span class="assistant-hint">Toca para copiar</span>
            </div>
            <p class="assistant-value" id="assistantClientPhone">-</p>
          </div>
          <div class="assistant-card clickable" data-tone="purple" data-assistant-action="copy_message" role="button" tabindex="0" aria-label="Copiar mensaje">
            <div class="card-head">
              <p class="eyebrow">Copiar mensaje</p>
              <span class="assistant-hint">Toca para copiar</span>
            </div>
            <p class="muted" id="assistantMessagePreview"></p>
          </div>
          <div class="assistant-card actions" data-tone="green">
            <p class="eyebrow">Marcar como...</p>
            <div class="action-buttons">
              <button class="glow-btn" id="assistantMarkContacted" data-tone="green"><i class='bx bx-check-circle'></i> Contactado</button>
              <button class="glow-btn" id="assistantMarkNoNumber" data-tone="red"><i class='bx bx-block'></i> N√∫mero no disponible</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="popover-overlay fade" id="assistantQuickAdjustOverlay">
    <div class="popover wide" id="assistantQuickAdjustPopover">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Ajuste r√°pido</p>
          <h3>Gestor de contactos</h3>
        </div>
        <button class="ghost-btn icon-only" id="assistantQuickAdjustClose"><i class='bx bx-x'></i></button>
      </div>
      <div class="assistant-quick-layout">
        <div class="assistant-quick-search">
          <div class="search-field">
            <i class='bx bx-search'></i>
            <input id="assistantQuickSearch" placeholder="Buscar por nombre, tel√©fono, documento o modelo" />
          </div>
          <div class="assistant-quick-controls">
            <button class="primary-btn mini" id="assistantQuickSearchBtn" type="button"><i class='bx bx-search-alt'></i>Buscar</button>
            <button class="ghost-btn mini" id="assistantQuickResetBtn" type="button"><i class='bx bx-refresh'></i>Restablecer</button>
          </div>
          <div class="assistant-quick-results" id="assistantQuickResults"></div>
        </div>
        <div class="assistant-quick-detail">
          <div class="assistant-quick-detail-card" id="assistantQuickDetail"></div>
          <div class="assistant-quick-actions" id="assistantQuickActions"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="popover-overlay fade" id="preferencesOverlay">
    <div class="popover wide" id="preferencesPanel">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Mis preferencias</p>
          <h3>Personaliza tu vista</h3>
          <p class="muted subtle">Ajusta el tama√±o de texto y el formato visual de los datos.</p>
        </div>
        <button class="ghost-btn icon-only" id="closePreferences"><i class='bx bx-x'></i></button>
      </div>
      <div class="preferences-content preferences-layout">
        <aside class="preferences-nav">
          <button class="preferences-tab active" data-pref-tab="fonts"><i class='bx bx-font'></i> Tipograf√≠a</button>
          <button class="preferences-tab" data-pref-tab="context"><i class='bx bx-layout'></i> Men√∫ contextual</button>
          <button class="preferences-tab" data-pref-tab="display"><i class='bx bx-low-vision'></i> Visualizaci√≥n</button>
          <button class="preferences-tab" data-pref-tab="extras"><i class='bx bx-bell'></i> Funciones adicionales</button>
          <button class="preferences-tab" data-pref-tab="site"><i class='bx bx-cog'></i> Ajustes del sitio</button>
        </aside>
        <div class="preferences-panels">
          <section class="preferences-section pref-panel active" data-pref-panel="fonts">
            <div class="section-head">
              <div>
                <p class="eyebrow">Tama√±o de fuente</p>
                <h4>Campos del gestor</h4>
                <p class="muted tiny">Cada ajuste afecta al Gestor de Clientes y al Asistente de Contactos.</p>
              </div>
            </div>
            <div class="preferences-grid" id="fontPreferencesList"></div>
          </section>
          <section class="preferences-section pref-panel" data-pref-panel="context">
            <div class="section-head">
              <div>
                <p class="eyebrow">Men√∫ contextual</p>
                <h4>Tama√±o de fuente</h4>
                <p class="muted tiny">Define c√≥mo se muestran los textos dentro del men√∫ contextual.</p>
              </div>
            </div>
            <div class="preferences-grid" id="contextFontPreferencesList"></div>
            <div class="section-head">
              <div>
                <p class="eyebrow">Contenido visible</p>
                <h4>Elige qu√© mostrar</h4>
                <p class="muted tiny">Activa o desactiva cada dato y acci√≥n por separado.</p>
              </div>
            </div>
            <div class="preferences-grid" id="contextVisibilityList"></div>
          </section>
          <section class="preferences-section pref-panel" data-pref-panel="display">
            <div class="section-head">
              <div>
                <p class="eyebrow">Visualizaci√≥n</p>
                <h4>Celulares en formato simple</h4>
                <p class="muted tiny">Solo afecta a la tabla y al Asistente, no al copiado.</p>
              </div>
            </div>
            <div class="field">
              <label for="phoneDisplaySelect">Visualizaci√≥n sencilla de celulares</label>
              <select id="phoneDisplaySelect">
                <option value="plain">Desactivada</option>
                <option value="split2">Activada con separador de 2</option>
                <option value="split3">Activada con separador de 3</option>
              </select>
            </div>
            <div class="field">
              <label class="toggle inline" for="scrollTopToggle">
                <input type="checkbox" id="scrollTopToggle">
                <span>Mostrar bot√≥n flotante para volver arriba</span>
              </label>
              <p class="muted tiny">Aparece cuando te desplazas en la lista y permite regresar al inicio r√°pidamente.</p>
            </div>
          </section>
          <section class="preferences-section pref-panel" data-pref-panel="extras">
            <div class="section-head">
              <div>
                <p class="eyebrow">Funciones adicionales</p>
                <h4>Sistema de advertencia de mensajes masivos</h4>
                <p class="muted tiny">Supervisa el volumen de mensajes enviados por cuenta y recibe alertas personalizadas.</p>
              </div>
            </div>
            <div class="preference-row">
              <div class="preference-label">
                <strong>Activar advertencias por mensajes masivos</strong>
                <span class="muted tiny">Se controla por cuenta y solo suma al pasar de pendiente a contactado.</span>
              </div>
              <label class="toggle inline" for="bulkMessageWarningToggle">
                <input type="checkbox" id="bulkMessageWarningToggle">
                <span>Activado</span>
              </label>
            </div>
            <div class="preference-row hidden" id="bulkMessageWarningThresholdRow">
              <div class="preference-label">
                <strong>Umbral de advertencia</strong>
                <span class="muted tiny">Cantidad de mensajes antes de mostrar la alerta.</span>
              </div>
              <div class="preference-controls">
                <input type="number" min="5" max="300" step="1" id="bulkMessageWarningThreshold">
                <span class="muted tiny">mensajes</span>
              </div>
            </div>
            <div class="preference-row">
              <div class="preference-label">
                <strong>Mensajes enviados por cuenta (total y √∫ltimas 24 horas)</strong>
                <span class="muted tiny">Se actualiza al marcar contactos como contactados. Puedes restablecer cada cuenta cuando quieras.</span>
              </div>
              <div class="bulk-warning-summary" id="bulkMessageAccountSummary"></div>
            </div>
          </section>
          <section class="preferences-section pref-panel" data-pref-panel="site">
            <div class="section-head">
              <div>
                <p class="eyebrow">Ajustes del sitio</p>
                <h4>Datos locales y mantenimiento</h4>
                <p class="muted tiny">Gestiona datos guardados, restablece valores base y optimiza la experiencia.</p>
              </div>
            </div>
            <div class="preferences-actions">
              <button class="secondary-btn" id="clearStorage"><i class='bx bx-trash'></i> Limpiar datos locales</button>
              <button class="ghost-btn danger" id="resetDefaults"><i class='bx bx-refresh'></i> Restaurar valores base</button>
            </div>
          </section>
        </div>
      </div>
    </div>
  </div>
  <div class="popover-overlay fade" id="templatePickerOverlay">
    <div class="popover" id="templatePickerPanel">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Copiar plantilla</p>
          <h3>Selecciona una plantilla para copiar</h3>
          <p class="muted subtle">Elige la plantilla y se copiar√° con los datos din√°micos disponibles.</p>
        </div>
        <button class="ghost-btn icon-only" id="closeTemplatePicker"><i class='bx bx-x'></i></button>
      </div>
      <div class="template-picker-body">
        <div class="search-field">
          <i class='bx bx-search'></i>
          <input id="templatePickerSearch" placeholder="Buscar plantilla..." />
        </div>
        <div class="template-picker-list" id="templatePickerList"></div>
      </div>
    </div>
  </div>
  <div class="modal hidden" id="clientEditModal">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow" id="clientEditEyebrow">Edici√≥n</p>
          <h3 id="clientEditTitle"></h3>
          <p class="muted" id="clientEditSubtitle"></p>
        </div>
        <button id="clientEditClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="field" id="clientEditCurrent"></div>
      <div class="field" id="clientEditField"></div>
      <label class="toggle" id="uppercaseToggle" style="display:none;">
        <input type="checkbox" id="clientUppercase">
        <span>Forzar may√∫sculas</span>
      </label>
      <div class="modal-actions">
        <button id="clientEditCancel" class="ghost-btn">Cancelar</button>
        <button id="clientEditSave" class="primary-btn"><i class='bx bx-save'></i>Guardar</button>
      </div>
    </div>
  </div>
  <div class="modal hidden" id="clientStatusModal">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Modificaci√≥n de estado</p>
          <h3 id="clientStatusTitle">Actualizar estado</h3>
          <p class="muted" id="clientStatusSubtitle">Actualiza el estado del cliente seleccionado.</p>
        </div>
        <button id="clientStatusClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-body">
        <div class="status-update-card">
          <p class="muted tiny" id="clientStatusLastUpdate">√öltima actualizaci√≥n: Sin datos.</p>
          <div class="field">
            <label for="clientStatusSelect">Actualizar el estado del cliente a:</label>
            <select id="clientStatusSelect"></select>
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button id="clientStatusCancel" class="ghost-btn">Cancelar</button>
        <button id="clientStatusSave" class="primary-btn"><i class='bx bx-check-circle'></i>Actualizar estado</button>
      </div>
    </div>
  </div>
  <div class="modal hidden" id="clientReassignModal">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Reasignaci√≥n de cuenta</p>
          <h3 id="clientReassignTitle">Reasignar cliente</h3>
          <p class="muted" id="clientReassignSubtitle"></p>
        </div>
        <button id="clientReassignClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-body">
        <div class="status-update-card">
          <p class="muted" id="clientReassignStatusLine"></p>
          <p class="muted" id="clientReassignAccountLine"></p>
          <div class="field">
            <label for="clientReassignSelect">Reasignar este cliente a la cuenta:</label>
            <select id="clientReassignSelect"></select>
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button id="clientReassignCancel" class="ghost-btn">Cancelar</button>
        <button id="clientReassignSave" class="primary-btn"><i class='bx bx-refresh'></i>Reasignar cuenta</button>
      </div>
    </div>
  </div>
  <div class="modal hidden" id="quoteClientModal">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Mis Cotizaciones</p>
          <h3 id="quoteClientModalTitle">Reasignar cotizaci√≥n</h3>
          <p class="muted subtle" id="quoteClientModalSubtitle">Selecciona el cliente al que deseas vincular la cotizaci√≥n.</p>
        </div>
        <button id="quoteClientClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-body">
        <div class="quote-client-search">
          <label for="quoteClientSearchInput">Buscar cliente por nombre</label>
          <div class="search-field search-field-inline">
            <i class='bx bx-search'></i>
            <input id="quoteClientSearchInput" placeholder="Escribe el nombre del cliente" />
            <button class="primary-btn mini" id="quoteClientSearchBtn" type="button">Buscar...</button>
          </div>
          <p class="muted subtle helper-text">Usa el bot√≥n para filtrar y elegir un cliente espec√≠fico.</p>
        </div>
        <div class="quote-client-results" id="quoteClientResults"></div>
        <div class="quote-client-selection" id="quoteClientSelection">
          <p class="muted subtle">Cliente seleccionado</p>
          <div class="selection-card">
            <div>
              <p class="selection-title" id="quoteClientSelectedName">Sin clasificar</p>
              <p class="muted subtle" id="quoteClientSelectedMeta">Sin selecci√≥n activa.</p>
            </div>
            <button class="ghost-btn mini" id="quoteClientClearSelection" type="button">Quitar selecci√≥n</button>
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button id="quoteClientCancel" class="ghost-btn">Cancelar</button>
        <button id="quoteClientSave" class="primary-btn"><i class='bx bx-refresh'></i>Reasignar</button>
      </div>
    </div>
  </div>
  <div class="popover-overlay" id="contactLogOverlay">
    <div class="popover wide" id="contactLogPanel">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Registro de Contactados</p>
          <h3>Seguimiento en tiempo real</h3>
          <p class="muted subtle">√öltimas acciones marcadas: contactado, n√∫mero no disponible o favoritos.</p>
        </div>
        <button class="ghost-btn icon-only" id="contactLogClose"><i class='bx bx-x'></i></button>
      </div>
      <div class="contact-log-tabs" id="contactLogRangeTabs">
        <button class="tab-pill" type="button" data-contact-range="24h">
          √öltimas 24hs
          <span class="tab-count" data-range-count>0</span>
        </button>
        <button class="tab-pill" type="button" data-contact-range="7d">
          √öltima Semana
          <span class="tab-count" data-range-count>0</span>
        </button>
        <button class="tab-pill" type="button" data-contact-range="30d">
          √öltimo Mes
          <span class="tab-count" data-range-count>0</span>
        </button>
      </div>
      <div class="contact-log-filters">
        <div class="search-field">
          <i class='bx bx-search'></i>
          <input id="contactLogSearch" placeholder="Buscar por nombre, estado o tel√©fono" />
        </div>
        <div class="field compact-field inline">
          <label for="contactLogStatusFilter">Por estado</label>
          <select id="contactLogStatusFilter"></select>
        </div>
      </div>
      <div class="contact-log-body" id="contactLogList"></div>
      <div id="contactLogEmpty" class="empty-state hidden">
        <i class='bx bx-time-five'></i>
        <p class="muted">A√∫n no hay registros de contacto. Marca clientes como contactados, n√∫mero no disponible o favoritos para verlos aqu√≠.</p>
      </div>
    </div>
  </div>
  <div id="journeyReportModal" class="modal hidden">
    <div class="modal-content wide journey-report-modal">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Informe de Jornada</p>
          <h3>Control de gesti√≥n por periodo</h3>
          <p class="muted subtle">Selecciona el rango de fechas para generar un informe detallado y descargarlo en PDF.</p>
        </div>
        <button id="journeyReportClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-body">
        <div class="journey-report-grid">
          <div class="journey-report-filters">
            <h4>Selecciona el rango de fecha que deseas obtener el informe:</h4>
            <div class="journey-date-row">
              <label for="journeyReportFrom">Desde:</label>
              <input type="date" id="journeyReportFrom" />
              <label for="journeyReportTo">Hasta:</label>
              <input type="date" id="journeyReportTo" />
            </div>
            <div class="journey-quick-buttons">
              <button class="ghost-btn mini" data-range="0">Hoy</button>
              <button class="ghost-btn mini" data-range="3">√öltimos 3 d√≠as</button>
              <button class="ghost-btn mini" data-range="7">√öltimos 7 d√≠as</button>
              <button class="ghost-btn mini" data-range="15">√öltimos 15 d√≠as</button>
              <button class="ghost-btn mini" data-range="30">√öltimos 30 d√≠as</button>
            </div>
            <div class="journey-report-options">
              <label class="pill pill-toggle" title="Incluye el registro completo de acciones realizadas en la jornada">
                <input type="checkbox" id="journeyReportDetailedMode" />
                <span>Modo Informe detallado</span>
              </label>
              <div class="journey-report-notes">
                <label for="journeyReportNotes">Notas adicionales</label>
                <textarea id="journeyReportNotes" rows="3" placeholder="Agrega observaciones, pendientes o informaci√≥n clave para el informe."></textarea>
              </div>
              <div class="journey-report-fields">
                <div class="journey-report-fields-head">
                  <h5>Campos personalizados</h5>
                  <button class="ghost-btn mini" type="button" id="journeyReportAddField"><i class='bx bx-plus'></i>Agregar campo</button>
                </div>
                <div id="journeyReportFields"></div>
              </div>
            </div>
            <div class="journey-report-actions">
              <button id="journeyReportDownload" class="primary-btn"><i class='bx bx-download'></i>Descargar PDF</button>
            </div>
          </div>
          <div class="journey-report-summary">
            <div class="journey-summary-card">
              <p class="eyebrow">Informe de Jornada</p>
              <h4 id="journeyReportAdvisor">Informe del asesor: -</h4>
              <p class="muted" id="journeyReportPeriod">Periodo del informe: -</p>
              <div class="journey-stat">
                <span>Cantidad de tel√©fonos contactados en el periodo</span>
                <strong id="journeyReportTotal">0</strong>
              </div>
            </div>
            <div class="journey-report-metrics" id="journeyReportMetrics"></div>
            <div class="journey-report-custom" id="journeyReportCustom"></div>
            <div class="journey-report-detail">
              <h4>Detalle del informe</h4>
              <div class="journey-report-list" id="journeyReportList"></div>
            </div>
            <div class="journey-report-activity hidden" id="journeyReportActivitySection">
              <h4>Registro detallado de acciones</h4>
              <div class="journey-report-activity-list" id="journeyReportActivityList"></div>
              <div id="journeyReportActivityEmpty" class="empty-state hidden">
                <i class='bx bx-spreadsheet'></i>
                <p class="muted">No hay acciones registradas para el periodo seleccionado.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button id="journeyReportCloseFooter" class="ghost-btn">Cerrar</button>
      </div>
    </div>
  </div>
  <div class="context-menu hidden" id="clientContextMenu">
    <div class="context-menu-head">
      <div>
        <p class="eyebrow">Seleccionaste a:</p>
        <h4 id="contextClientName">Cliente</h4>
        <p class="muted tiny" id="contextClientModel"></p>
      </div>
      <button class="ghost-btn icon-only" id="closeContextMenu"><i class='bx bx-x'></i></button>
    </div>
    <div class="context-menu-body" id="contextMenuContent"></div>
  </div>
  <div id="toastContainer" class="toast-container"></div>
  <div id="exportModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Exportar clientes</p>
          <h3>Elige c√≥mo quieres exportar</h3>
          <p class="muted" id="exportHelperText">Configura el m√©todo y las columnas a incluir.</p>
        </div>
        <button id="exportClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-actions top">
        <button id="exportCancel" class="ghost-btn">Cancelar</button>
        <button id="exportConfirm" class="primary-btn"><i class='bx bx-download'></i>Exportar ahora</button>
      </div>
      <div class="option-stack two-cols">
        <label class="option-card">
          <input type="radio" name="exportMode" value="local" checked>
          <div>
            <strong>Excel - Datos Ordenados por este Sistema</strong>
            <p class="muted tiny">Usa los campos locales y respeta el orden que definas abajo.</p>
          </div>
        </label>
        <label class="option-card">
          <input type="radio" name="exportMode" value="preset">
          <div>
            <strong>Excel - Igualar Cabezales Predet.</strong>
            <p class="muted tiny">Exporta con encabezados fijos: CUIT0, DOC, FECNAC, NOMBRE, OLOC, OPCIA, CP, CELULAR12, FECHA1, MARCA, MODELO, TIPO, ESTADO.</p>
          </div>
        </label>
      </div>
      <div class="export-options">
        <div class="export-options-head">
          <div>
            <p class="eyebrow">Contenido a exportar</p>
            <h4>Activa, desactiva y reordena columnas</h4>
            <p class="muted tiny">Todo est√° seleccionado por defecto. Usa las flechas para mover cada columna.</p>
          </div>
          <button id="exportSelectAll" class="ghost-btn"><i class='bx bx-check-double'></i>Seleccionar todo</button>
        </div>
        <div id="exportColumnsList" class="export-columns"></div>
      </div>
    </div>
  </div>
  <div id="clientPickerModal" class="modal hidden">
    <div class="modal-content wide wizard">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Asistente de selecci√≥n</p>
          <h3>Cliente y cotizaci√≥n</h3>
          <p class="muted" id="clientWizardSubtitle">Elige c√≥mo deseas buscar al cliente.</p>
        </div>
        <button id="clientPickerClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="wizard-track" id="clientWizardTrack">
        <section class="wizard-panel" data-step="1">
          <div class="wizard-choice">
            <h4>¬øC√≥mo deseas buscar al cliente?</h4>
            <div class="wizard-choice-group">
              <p class="wizard-choice-title">Usando mis clientes...</p>
              <div class="wizard-choice-grid">
                <button class="wizard-choice-card" type="button" data-client-wizard-choice="search">
                  <div>
                    <strong>B√∫squeda por nombre</strong>
                    <p class="muted tiny">Escribe y confirma la b√∫squeda manualmente.</p>
                  </div>
                  <i class='bx bx-search-alt-2'></i>
                </button>
                <button class="wizard-choice-card" type="button" data-client-wizard-choice="all">
                  <div>
                    <strong>Ver todos los clientes</strong>
                    <p class="muted tiny">Lista alfab√©tica completa para elegir.</p>
                  </div>
                  <i class='bx bx-list-ul'></i>
                </button>
              </div>
            </div>
            <div class="wizard-choice-group alt">
              <p class="wizard-choice-title">No utilizar ning√∫n cliente registrado</p>
              <div class="wizard-choice-grid">
                <button class="wizard-choice-card" type="button" data-client-wizard-choice="external">
                  <div>
                    <strong>Cotizaci√≥n Externa...</strong>
                    <p class="muted tiny">Usa un nombre manual sin datos asociados.</p>
                  </div>
                  <i class='bx bx-id-card'></i>
                </button>
              </div>
            </div>
          </div>
        </section>
        <section class="wizard-panel" data-step="2">
          <div class="wizard-panel-head">
            <h4 id="clientWizardModeTitle">B√∫squeda por nombre</h4>
            <p class="muted" id="clientWizardModeSubtitle">Escribe el nombre del cliente a buscar y presiona Buscar.</p>
          </div>
          <div class="wizard-search" id="clientWizardSearchSection">
            <div class="search-field expanded">
              <i class='bx bx-search'></i>
              <input id="clientWizardSearchInput" placeholder="Escribe el nombre del cliente a buscar..." />
            </div>
            <button id="clientWizardSearchBtn" class="primary-btn" type="button"><i class='bx bx-loader-circle'></i>Buscar...</button>
          </div>
          <div class="wizard-search" id="clientWizardExternalSection">
            <div class="field">
              <label for="clientWizardExternalName">Ingresa el nombre del cliente que quieres utilizar.</label>
              <input id="clientWizardExternalName" placeholder="Ej: Juan P√©rez" />
            </div>
          </div>
          <p class="muted tiny" id="clientWizardSearchStatus">Selecciona un cliente para continuar.</p>
          <div id="clientWizardList" class="picker-list wizard-list"></div>
        </section>
        <section class="wizard-panel" data-step="3">
          <div class="wizard-panel-head">
            <h4>Selecciona el auto a cotizar</h4>
            <p class="muted">Elige marca y modelo. El plan se ajusta autom√°ticamente.</p>
          </div>
          <div class="form-grid two wizard-form-grid">
            <div class="field">
              <label for="clientWizardBrand">Marca</label>
              <select id="clientWizardBrand"></select>
            </div>
            <div class="field">
              <label for="clientWizardModel">Modelo</label>
              <select id="clientWizardModel"></select>
            </div>
          </div>
          <div class="wizard-plan-card" id="clientWizardPlanCard">
            <div class="wizard-plan-head">
              <div>
                <p class="eyebrow">Detalles del plan</p>
                <h4 id="clientWizardPlanTitle">Plan sugerido</h4>
              </div>
              <span class="wizard-plan-badge" id="clientWizardPlanBadge">Plan</span>
            </div>
            <div class="wizard-plan-grid" id="clientWizardPlanDetails"></div>
          </div>
        </section>
        <section class="wizard-panel" data-step="4">
          <div class="wizard-panel-head">
            <h4>¬øEl cliente usar√° Llave x Llave?</h4>
            <p class="muted">Define si se tomar√° un usado como parte de pago.</p>
          </div>
          <div class="wizard-choice-grid compact">
            <button class="wizard-choice-card small" type="button" data-trade-in-choice="yes">
              <strong>Si</strong>
              <p class="muted tiny">Registrar el valor del usado.</p>
            </button>
            <button class="wizard-choice-card small" type="button" data-trade-in-choice="no">
              <strong>No</strong>
              <p class="muted tiny">Continuar sin usado.</p>
            </button>
          </div>
          <div class="field wizard-money-field" id="clientWizardTradeInField">
            <label for="clientWizardTradeInValue">¬øEn cu√°nto se lo tomar√°n?</label>
            <div class="money-field">
              <span class="prefix">$</span>
              <input id="clientWizardTradeInValue" class="money" type="text" inputmode="numeric" placeholder="Ej: 1.000.000" />
            </div>
          </div>
        </section>
        <section class="wizard-panel" data-step="5">
          <div class="wizard-panel-head">
            <h4>Valor del coche en sistema</h4>
            <p class="muted" id="clientWizardPriceInfo">Seg√∫n precios actualizados.</p>
          </div>
          <div class="wizard-choice-grid compact">
            <button class="wizard-choice-card small" type="button" data-price-choice="yes">
              <strong>Si, usar valores por defecto</strong>
              <p class="muted tiny">Tomar el valor oficial del cat√°logo.</p>
            </button>
            <button class="wizard-choice-card small" type="button" data-price-choice="no">
              <strong>No, usar√© otro</strong>
              <p class="muted tiny">Cambio de versi√≥n o ajuste manual.</p>
            </button>
          </div>
          <div class="field wizard-money-field" id="clientWizardCustomPriceField">
            <label for="clientWizardCustomPrice">Ingresar otro valor</label>
            <div class="money-field">
              <span class="prefix">$</span>
              <input id="clientWizardCustomPrice" class="money" type="text" inputmode="numeric" placeholder="Valor del coche a cotizar" />
            </div>
            <p class="muted tiny">Ejemplo: versi√≥n superior o ajustes personalizados.</p>
          </div>
        </section>
        <section class="wizard-panel" data-step="6">
          <div class="wizard-panel-head">
            <h4>Confirmar operaci√≥n</h4>
            <p class="muted">Revisa y confirma los datos seleccionados.</p>
          </div>
          <div class="wizard-summary" id="clientWizardSummary"></div>
        </section>
      </div>
      <div class="modal-actions wizard-actions">
        <div class="wizard-progress wizard-progress-footer" id="clientWizardProgress">
          <div class="wizard-progress-step" data-step="1">
            <span>1</span>
            <small>Buscar</small>
          </div>
          <div class="wizard-progress-step" data-step="2">
            <span>2</span>
            <small>Cliente</small>
          </div>
          <div class="wizard-progress-step" data-step="3">
            <span>3</span>
            <small>Auto</small>
          </div>
          <div class="wizard-progress-step" data-step="4">
            <span>4</span>
            <small>Llave</small>
          </div>
          <div class="wizard-progress-step" data-step="5">
            <span>5</span>
            <small>Valor</small>
          </div>
          <div class="wizard-progress-step" data-step="6">
            <span>6</span>
            <small>Confirmar</small>
          </div>
        </div>
        <div class="wizard-actions-buttons">
          <button id="clientWizardBack" class="ghost-btn">Atr√°s</button>
          <div class="wizard-actions-right">
            <button id="clientWizardNext" class="primary-btn">Siguiente</button>
            <button id="clientWizardConfirm" class="primary-btn"><i class='bx bx-check'></i>Continuar</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="clientVehicleModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Modelo asociado</p>
          <h3>Confirmar veh√≠culo del cliente</h3>
          <p class="muted" id="clientVehicleContext">Selecciona el veh√≠culo vinculado al cliente.</p>
        </div>
        <button id="clientVehicleClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="field">
        <label for="clientVehicleOptions">El cliente tiene asociado el auto:</label>
        <select id="clientVehicleOptions"></select>
      </div>
      <div class="modal-actions">
        <button id="clientVehicleCancel" class="ghost-btn">Cancelar</button>
        <button id="clientVehicleApply" class="primary-btn"><i class='bx bx-check'></i>Utilizar selecci√≥n</button>
      </div>
    </div>
  </div>
  <div id="clientNoteModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Notas</p>
          <h3 id="clientNoteTitle"></h3>
          <p class="muted" id="clientNoteSubtitle"></p>
        </div>
        <button id="clientNoteClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="field textarea-field">
        <label for="clientNoteText">Notas del cliente</label>
        <textarea id="clientNoteText" rows="6" placeholder="Agrega recordatorios, acuerdos o detalles relevantes"></textarea>
      </div>
      <div class="modal-actions">
        <button id="clientNoteCancel" class="ghost-btn">Cerrar</button>
        <button id="clientNoteSave" class="primary-btn"><i class='bx bx-save'></i>Guardar</button>
      </div>
    </div>
  </div>
  <div id="accountInfoModal" class="modal hidden">
    <div class="modal-content account-info-modal">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Cuenta activa</p>
          <h3>Detalles de la cuenta</h3>
        </div>
        <button id="accountInfoClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="account-info-body">
        <div class="account-info-avatar"><i class='bx bx-user'></i></div>
        <h4 id="accountInfoName">Cuenta</h4>
        <div class="account-info-sections">
          <div class="info-block">
            <h5>Informaci√≥n de la cuenta</h5>
            <div class="info-row">
              <span>N√∫mero de Tel√©fono de esta cuenta:</span>
              <strong id="accountInfoPhone">-</strong>
            </div>
            <div class="info-row">
              <span>Dispositivo de esta cuenta:</span>
              <strong id="accountInfoDevice">-</strong>
            </div>
          </div>
          <div class="info-block">
            <h5>Detalles de la operaci√≥n</h5>
            <p class="muted" id="accountInfoContact">Contacto realizado el d√≠a: -</p>
          </div>
        </div>
        <div class="modal-actions">
          <button id="accountInfoDismiss" class="primary-btn">Cerrar</button>
        </div>
      </div>
    </div>
  </div>
  <div id="accountManagerModal" class="modal hidden">
    <div class="modal-content wide account-manager-modal">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Cuentas m√∫ltiples</p>
          <h3>Gesti√≥n de Cuentas</h3>
        </div>
        <button id="closeAccountManager" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="account-manager-body">
        <aside class="account-manager-nav">
          <div class="account-manager-actions">
            <button class="primary-btn ghosted" id="addAccount"><i class='bx bx-plus'></i>Agregar nueva cuenta</button>
          </div>
          <div class="account-manager-list" id="accountManagerList"></div>
        </aside>
        <div class="account-manager-panel">
          <div class="field">
            <label for="accountNameInput">Nombre de la cuenta</label>
            <input id="accountNameInput" placeholder="Ej: Juli√°n Alvarez" />
          </div>
          <div class="field">
            <label for="accountAliasInput">Alias de la cuenta (Nombre Asesor)</label>
            <input id="accountAliasInput" placeholder="Ej: Juli√°n Alvarez" />
          </div>
          <div class="field">
            <label for="accountPhoneInput">N√∫mero de tel√©fono asociado a esta cuenta</label>
            <input id="accountPhoneInput" placeholder="Ej: 11 2345 6789" />
          </div>
          <div class="field">
            <label for="accountDeviceInput">Referencia del Dispositivo</label>
            <input id="accountDeviceInput" placeholder="Ej. Samsung Galaxy A33" />
          </div>
          <div class="account-manager-hint muted tiny">Los cambios se guardan al cerrar este panel.</div>
          <div class="modal-actions with-status">
            <span class="muted tiny" id="accountManagerStatus"></span>
            <div class="action-buttons">
              <button class="secondary-btn" id="applyAccountToClients"><i class='bx bx-group'></i>Aplicar esta cuenta a Mis Clientes...</button>
              <button class="ghost-btn danger" id="deleteAccount"><i class='bx bx-trash'></i>Eliminar esta cuenta</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="bulkMessageWarningModal" class="modal hidden">
    <div class="modal-content bulk-warning-modal">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Advertencia</p>
          <h3>Mensajes masivos detectados</h3>
          <p class="muted" id="bulkWarningMessage">-</p>
          <p class="muted tiny">Si quieres apagar esta funcionalidad, puedes hacerlo desde el men√∫ de Mis Preferencias.</p>
        </div>
      </div>
      <div class="modal-actions stacked">
        <button class="secondary-btn" id="bulkWarningRemind5"><i class='bx bx-bell'></i>Recordarme dentro de 5 mensajes m√°s</button>
        <button class="secondary-btn" id="bulkWarningRemind20"><i class='bx bx-bell'></i>Recordarme dentro de 20 mensajes m√°s</button>
        <button class="ghost-btn" id="bulkWarningSnooze"><i class='bx bx-time-five'></i>No recordarme m√°s hasta dentro de 1 hora</button>
      </div>
    </div>
  </div>
  <div id="bulkMessageResetModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Restablecer conteo</p>
          <h3>Confirmar reinicio de mensajes</h3>
          <p class="muted">Vas a reiniciar el conteo de mensajes para la cuenta <strong id="bulkResetAccountLabel">-</strong>.</p>
          <p class="muted tiny">Esta acci√≥n no se puede deshacer.</p>
        </div>
        <button id="bulkResetClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-actions">
        <button id="bulkResetCancel" class="ghost-btn">Cancelar</button>
        <button id="bulkResetConfirm" class="primary-btn danger"><i class='bx bx-refresh'></i>Restablecer</button>
      </div>
    </div>
  </div>
  <div id="accountApplyModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Asignaci√≥n masiva</p>
          <h3>Aplicar cuenta a todos los contactos</h3>
          <p class="muted">Esta funci√≥n asignar√° a TODOS TUS CONTACTOS importados la vinculaci√≥n a esta cuenta. Usar esta opci√≥n con precauci√≥n.</p>
        </div>
        <button id="accountApplyClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="option-stack compact">
        <label class="option-card checkbox-card">
          <input type="checkbox" id="accountApplyConfirmCheck">
          <div>
            <strong>Se lo que estoy haciendo</strong>
            <p class="muted tiny">Confirmo que deseo aplicar la vinculaci√≥n masiva.</p>
          </div>
        </label>
      </div>
      <div class="modal-actions">
        <button id="accountApplyCancel" class="ghost-btn">Cancelar</button>
        <button id="accountApplyConfirm" class="primary-btn" disabled>Aplicar</button>
      </div>
    </div>
  </div>
  <div id="importDateModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Fecha de carga</p>
          <h3>Aplicar fecha a los clientes importados</h3>
          <p class="muted">Esta marca es opcional y te permitir√° filtrar o exportar por d√≠a.</p>
        </div>
        <button id="importDateClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="option-stack">
        <label class="option-card">
          <input type="radio" name="importDateOption" value="today" checked>
          <div>
            <strong>Usar la fecha de hoy</strong>
            <p class="muted tiny" id="importDateTodayLabel"></p>
          </div>
        </label>
        <label class="option-card">
          <input type="radio" name="importDateOption" value="custom">
          <div>
            <strong>Elegir una fecha</strong>
            <p class="muted tiny">Selecciona manualmente la fecha de carga.</p>
            <input type="date" id="importCustomDate">
          </div>
        </label>
        <label class="option-card">
          <input type="radio" name="importDateOption" value="none">
          <div>
            <strong>No insertar fecha</strong>
            <p class="muted tiny">Se conservar√° vac√≠o para estos registros.</p>
          </div>
        </label>
      </div>
      <div class="modal-actions">
        <button id="importDateCancel" class="ghost-btn">Cancelar</button>
        <button id="importDateConfirm" class="primary-btn"><i class='bx bx-check-double'></i>Confirmar</button>
      </div>
    </div>
  </div>
  <div id="importMappingModal" class="modal hidden">
    <div class="modal-content wide tall">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Comprobaci√≥n de cabezales</p>
          <h3>Revisa y asigna las columnas del Excel</h3>
          <p class="muted">Selecciona d√≥nde est√° cada dato obligatorio. Solo se usar√°n las columnas asignadas.</p>
        </div>
        <button id="importMappingClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="import-mapping-hint" id="importMappingHint"></div>
      <div class="import-mapping-grid" id="importMappingFields"></div>
      <div class="modal-actions with-status">
        <div id="importMappingStatus" class="mapping-status"></div>
        <div class="action-buttons">
          <button id="importMappingCancel" class="ghost-btn">Cancelar</button>
          <button id="importMappingConfirm" class="primary-btn"><i class='bx bx-check'></i>Importar</button>
        </div>
      </div>
    </div>
  </div>
  <div id="manualImportModal" class="modal hidden">
    <div class="modal-content wide manual-import-modal">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Ingreso manual de datos</p>
          <h3>Nuevo cliente manual</h3>
          <p class="muted">Completa todos los datos que necesites para registrar un cliente en el paquete correspondiente.</p>
        </div>
        <button id="manualImportClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <form id="manualImportForm" class="modal-body">
        <div class="form-grid three manual-import-grid">
          <div class="field">
            <label for="manualName">Nombre del cliente</label>
            <input id="manualName" name="name" required placeholder="Nombre completo" />
          </div>
          <div class="field">
            <label for="manualDocument">DNI</label>
            <input id="manualDocument" name="document" required placeholder="Documento" />
          </div>
          <div class="field">
            <label for="manualPhone">Tel√©fono</label>
            <input id="manualPhone" name="phone" required placeholder="Celular" />
          </div>
          <div class="field">
            <label for="manualBirthDate">Fecha de nacimiento</label>
            <input id="manualBirthDate" name="birthDate" type="date" />
          </div>
          <div class="field">
            <label for="manualCity">Localidad</label>
            <input id="manualCity" name="city" placeholder="Localidad" />
          </div>
          <div class="field">
            <label for="manualProvince">Provincia</label>
            <input id="manualProvince" name="province" placeholder="Provincia" />
          </div>
          <div class="field">
            <label for="manualPostalCode">C√≥digo Postal</label>
            <input id="manualPostalCode" name="postalCode" placeholder="CP" />
          </div>
          <div class="field">
            <label for="manualBrand">Marca</label>
            <input id="manualBrand" name="brand" placeholder="Marca del coche" />
          </div>
          <div class="field">
            <label for="manualModel">Modelo</label>
            <input id="manualModel" name="model" placeholder="Modelo del coche" />
          </div>
          <div class="field">
            <label for="manualPurchaseDate">Fecha de compra</label>
            <input id="manualPurchaseDate" name="purchaseDate" type="date" />
          </div>
          <div class="field">
            <label for="manualCuit">CUIT</label>
            <input id="manualCuit" name="cuit" placeholder="CUIT" />
          </div>
          <div class="field">
            <label for="manualContactDate">Fecha/Hora de contacto</label>
            <input id="manualContactDate" name="contactDate" type="datetime-local" />
          </div>
          <div class="field">
            <label for="manualSystemDate">Fecha de carga (paquete)</label>
            <input id="manualSystemDate" name="systemDate" type="date" />
          </div>
          <div class="field wide">
            <label for="manualNotes">Notas</label>
            <textarea id="manualNotes" name="type" rows="2" placeholder="Notas o comentarios"></textarea>
          </div>
        </div>
        <p class="muted tiny">Los campos obligatorios son Nombre, DNI y Tel√©fono.</p>
        <div class="modal-actions">
          <button type="button" class="ghost-btn" id="manualImportCancel">Cancelar</button>
          <button type="submit" class="primary-btn"><i class='bx bx-save'></i>Guardar cliente</button>
        </div>
      </form>
    </div>
  </div>
  <div id="dateFilterModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Filtrar por fecha</p>
          <h3>Filtros avanzados de fecha</h3>
          <p class="muted">Combina tipo de fecha, rangos manuales y botones r√°pidos.</p>
        </div>
        <button id="dateFilterClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="field">
        <label for="dateFilterType">Tipo de filtro de fecha</label>
        <select id="dateFilterType">
          <option value="systemDate">Por Fecha de carga</option>
          <option value="lastModified">Por Fecha de modificaci√≥n</option>
        </select>
      </div>
      <div class="field">
        <label for="dateFilterQuickMode">Atajo de tiempo</label>
        <select id="dateFilterQuickMode">
          <option value="custom">Por rango personalizado</option>
          <option value="last_x">Modificados hace menos de X tiempo</option>
          <option value="today">Modificados hoy</option>
          <option value="yesterday">Modificados ayer</option>
        </select>
      </div>
      <div id="dateFilterRelativeFields" class="field-grid hidden">
        <div class="field">
          <label for="dateFilterRelativeValue">Cantidad de tiempo</label>
          <input type="number" id="dateFilterRelativeValue" min="1" step="1" value="5">
        </div>
        <div class="field">
          <label for="dateFilterRelativeUnit">Unidad de tiempo</label>
          <select id="dateFilterRelativeUnit">
            <option value="minutes">Minutos</option>
            <option value="hours">Horas</option>
            <option value="days">D√≠as</option>
          </select>
        </div>
      </div>
      <div id="dateFilterCustomRangeFields">
        <div class="field">
          <label for="dateFilterFrom">Desde</label>
          <input type="date" id="dateFilterFrom">
        </div>
        <div class="field">
          <label for="dateFilterTo">Hasta</label>
          <input type="date" id="dateFilterTo">
        </div>
      </div>
      <div class="modal-actions">
        <button id="clearDateFilter" class="ghost-btn">Limpiar filtro</button>
        <button id="applyDateFilter" class="primary-btn"><i class='bx bx-filter-alt'></i>Aplicar filtro</button>
      </div>
    </div>
  </div>
  <div id="quoteModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Cotizaciones previas</p>
          <h3>Guardar, cargar o eliminar</h3>
          <p class="muted">Gestiona historial con confirmaciones y copias r√°pidas.</p>
        </div>
        <button id="quoteModalClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="search-field expanded">
        <i class='bx bx-search'></i>
        <input id="quoteSearch" placeholder="Escribe cualquier contenido a buscar..." />
      </div>
      <div id="quoteList" class="quote-list"></div>
      <div class="modal-actions">
        <button id="quoteModalCancel" class="ghost-btn">Cerrar</button>
      </div>
    </div>
  </div>
  <div id="installmentModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Detalle de cuotas</p>
          <h3>Calendario y adelantos</h3>
          <p class="muted">Usa la cuota pura vigente para mostrar adelantos y coberturas.</p>
        </div>
        <button id="installmentClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div id="installmentSummary" class="folio-list"></div>
      <div id="installmentList" class="coverage-grid"></div>
      <div class="modal-actions">
        <button id="installmentCancel" class="ghost-btn">Cerrar</button>
      </div>
    </div>
  </div>
  <div id="priceFilesModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Archivos del mes</p>
          <h3>Explorador</h3>
        </div>
        <button id="priceFilesClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div id="priceFilesList" class="file-list"></div>
    </div>
  </div>
  <div id="onlineFilesModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Archivos online</p>
          <h3>Explorador general</h3>
        </div>
        <button id="onlineFilesClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="search-field compact">
        <i class='bx bx-search'></i>
        <input id="onlineFilesSearch" placeholder="Buscar por nombre..." />
      </div>
      <div id="onlineFilesList" class="file-list"></div>
    </div>
  </div>
  <div id="priceImportModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Precios del mes</p>
          <h3>Importar o exportar valores</h3>
          <p class="muted tiny">Sincroniza con precios_[marca].json del mes o carga un archivo manual.</p>
        </div>
        <button id="priceImportClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-body import-grid">
        <div class="card ghost">
          <div class="card-head compact">
            <p class="eyebrow">Carga autom√°tica</p>
            <h4>Desde la carpeta del mes</h4>
            <p class="muted tiny">Busca precios_[marca].json dentro de la carpeta activa.</p>
          </div>
          <p class="muted tiny" id="serverPricePath">Ruta: -</p>
          <div class="actions compact">
            <button id="reloadServerPrices" class="secondary-btn" type="button"><i class='bx bx-refresh'></i>Cargar desde servidor</button>
          </div>
          <p class="muted tiny" id="serverPriceStatus">Estado: sin cargar</p>
        </div>
        <div class="card ghost">
          <div class="card-head compact">
            <p class="eyebrow">Importaci√≥n manual</p>
            <h4>Sube un archivo de precios</h4>
            <p class="muted tiny">Usa un archivo compatible generado por la plataforma.</p>
          </div>
          <div class="upload-box" id="priceUploadBox">
            <i class='bx bx-upload'></i>
            <p>Arrastra o haz clic para seleccionar</p>
            <p class="muted tiny">Solo archivos .json</p>
            <input type="file" id="priceFileInput" accept="application/json" />
          </div>
          <div class="actions compact">
            <button id="applyPriceFile" class="primary-btn" type="button"><i class='bx bx-check-circle'></i>Aplicar archivo</button>
          </div>
          <p class="muted tiny" id="localPriceStatus">Estado: esperando archivo</p>
        </div>
        <div class="card ghost">
          <div class="card-head compact">
            <p class="eyebrow">Respaldo inmediato</p>
            <h4>Exportar precios actuales</h4>
            <p class="muted tiny">Descarga los precios_[marca].json listos para subir al servidor.</p>
          </div>
          <div class="actions compact">
            <button id="downloadPriceFile" class="secondary-btn" type="button"><i class='bx bx-download'></i>Descargar precios por marca</button>
            <button id="copyPriceJson" class="ghost-btn" type="button"><i class='bx bx-copy'></i>Copiar JSON</button>
          </div>
          <p class="muted tiny" id="exportPriceHint">Incluye todos los importes editados.</p>
        </div>
      </div>
      <div class="modal-actions">
        <button id="priceImportCancel" class="ghost-btn">Cerrar</button>
      </div>
    </div>
  </div>
  <div id="vehicleEditorModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Modo editor</p>
          <h3>Gesti√≥n de modelos y valores</h3>
          <p class="muted tiny">Edita el cat√°logo actual y exporta precios_[marca].json cuando termines.</p>
        </div>
        <div class="editor-head-actions">
          <button id="exportPricesFromEditor" class="secondary-btn"><i class='bx bx-download'></i>Descargar Archivos de Precios</button>
          <button id="vehicleEditorClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
        </div>
      </div>
      <div class="modal-body editor-body">
        <div class="editor-tabs">
          <button class="tab-btn active" type="button" data-editor-tab="models">Modelos</button>
          <button class="tab-btn" type="button" data-editor-tab="brands">Gesti√≥n de Marcas</button>
        </div>
        <div class="editor-tab-panels">
          <div class="editor-tab-panel active" data-editor-panel="models">
            <div class="editor-grid">
              <aside class="editor-sidebar">
                <div class="editor-filter-row">
                  <div class="search-field compact">
                    <i class='bx bx-search'></i>
                    <input id="vehicleEditorSearch" placeholder="Buscar modelo" />
                  </div>
                  <div class="field compact">
                    <label for="vehicleEditorBrandFilter">Filtrar marca</label>
                    <select id="vehicleEditorBrandFilter"></select>
                  </div>
                </div>
                <div id="vehicleEditorList" class="editor-list"></div>
                <p id="vehicleEditorEmpty" class="muted tiny hidden">No se encontraron modelos.</p>
                <div class="actions compact center editor-list-actions">
                  <button id="addVehicle" class="secondary-btn mini"><i class='bx bx-plus'></i>Agregar modelo</button>
                  <button id="duplicateVehicle" class="ghost-btn mini"><i class='bx bx-copy'></i>Duplicar</button>
                  <button id="deleteVehicle" class="ghost-btn danger mini"><i class='bx bx-trash'></i>Eliminar</button>
                </div>
              </aside>
              <div class="editor-form">
                <div class="field">
                  <label for="editorVehicleName">Nombre del modelo</label>
                  <input id="editorVehicleName" placeholder="Ej: Tracker LT 1.2AT" />
                </div>
                <div class="form-grid two">
                  <div class="field">
                    <label for="editorBrand">Marca</label>
                    <select id="editorBrand"></select>
                  </div>
                  <div class="field">
                    <label for="editorAllocation">Modalidad de adjudicaci√≥n</label>
                    <select id="editorAllocation">
                      <option value="pactada">Cuota Pactada (Llave x llave)</option>
                      <option value="sorteo_licitacion">Solo Sorteo o Licitaci√≥n</option>
                    </select>
                  </div>
                </div>
                <div class="form-grid two">
                  <div class="field">
                    <label for="editorWithdrawalInstallments">Cuotas pactadas de retiro</label>
                    <input id="editorWithdrawalInstallments" placeholder="Ej: 4,6,9,12" />
                  </div>
                  <div class="field">
                    <label>Requisito de integraci√≥n</label>
                    <div class="inline-field requirement-inline">
                      <select id="editorWithdrawalRequirementType">
                        <option value="percent">%</option>
                        <option value="amount">$</option>
                      </select>
                      <input id="editorWithdrawalRequirementPct" type="number" min="0" max="100" step="1" placeholder="Ej: 35" />
                      <div class="money-field hidden" id="editorWithdrawalRequirementAmountField">
                        <span class="prefix">$</span>
                        <input id="editorWithdrawalRequirementAmount" class="money" type="text" inputmode="numeric" placeholder="Ej: 750000" />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-grid three">
                  <div class="field">
                    <label for="editorBasePrice">Precio de lista</label>
                    <div class="money-field">
                      <span class="prefix">$</span>
                      <input id="editorBasePrice" class="money" type="text" inputmode="numeric" />
                    </div>
                  </div>
                  <div class="field">
                    <label for="editorIntegration">Integraci√≥n</label>
                    <div class="money-field">
                      <span class="prefix">$</span>
                      <input id="editorIntegration" class="money" type="text" inputmode="numeric" />
                    </div>
                  </div>
                  <div class="field">
                    <label for="editorCuotaPura">Cuota pura</label>
                    <div class="money-field">
                      <span class="prefix">$</span>
                      <input id="editorCuotaPura" class="money" type="text" inputmode="numeric" />
                    </div>
                  </div>
                </div>
                <div class="form-grid two">
                  <div class="field">
                    <label for="editorPlanLabel">Etiqueta del plan</label>
                    <input id="editorPlanLabel" placeholder="Ej: 80/20 (120 cuotas)" />
                  </div>
                  <div class="field">
                    <label for="editorPlanMaxInstallments">M√°ximo de cuotas</label>
                    <input id="editorPlanMaxInstallments" type="number" min="1" step="1" placeholder="Ej: 84 o 120" />
                  </div>
                </div>
                <div class="form-grid three">
                  <div class="field">
                    <label for="editorPlanFinanced">Financia empresa (%)</label>
                    <input id="editorPlanFinanced" type="number" min="0" max="100" step="1" placeholder="Ej: 70" />
                  </div>
                  <div class="field">
                    <label for="editorPlanIntegration">Paga cliente (%)</label>
                    <input id="editorPlanIntegration" type="number" min="0" max="100" step="1" placeholder="Ej: 30" />
                  </div>
                  <div class="field readonly">
                    <label>Etiqueta autom√°tica</label>
                    <div class="plan-profile-cell readonly">
                      <span class="chip muted" id="editorPlanAutoLabel">Sin esquema definido</span>
                    </div>
                  </div>
                </div>
                <div class="field">
                  <label>Planes disponibles</label>
                  <p class="muted tiny">Se calculan autom√°ticamente seg√∫n las cuotas m√°ximas definidas.</p>
                  <div class="chip-group">
                    <label class="chip-select"><input type="checkbox" data-editor-available value="2a12">2 a 12</label>
                    <label class="chip-select"><input type="checkbox" data-editor-available value="13a21">13 a 21</label>
                    <label class="chip-select"><input type="checkbox" data-editor-available value="22a84">22 a 84</label>
                    <label class="chip-select"><input type="checkbox" data-editor-available value="85a120">85 a 120</label>
                    <label class="chip-select"><input type="checkbox" data-editor-available value="ctapura">Cuota pura</label>
                  </div>
                </div>
                <div class="field-group compact">
                  <div class="field-head">
                    <div>
                      <p class="eyebrow">Cuotas por plan</p>
                      <p class="muted tiny">Importes de referencia por tramo.</p>
                    </div>
                  </div>
                  <div class="form-grid two" id="editorPlanRanges"></div>
                </div>
                <div class="field-group compact">
                  <div class="field-head">
                    <div>
                      <p class="eyebrow">Reservas</p>
                      <p class="muted tiny">Importes de reserva por cuota.</p>
                    </div>
                  </div>
                  <div class="form-grid three">
                    <div class="field">
                      <label>Reserva 1 cuota</label>
                      <div class="money-field">
                        <span class="prefix">$</span>
                        <input class="money" type="text" inputmode="numeric" data-editor-reserva="1" />
                      </div>
                    </div>
                    <div class="field">
                      <label>Reserva 3 cuotas</label>
                      <div class="money-field">
                        <span class="prefix">$</span>
                        <input class="money" type="text" inputmode="numeric" data-editor-reserva="3" />
                      </div>
                    </div>
                    <div class="field">
                      <label>Reserva 6 cuotas</label>
                      <div class="money-field">
                        <span class="prefix">$</span>
                        <input class="money" type="text" inputmode="numeric" data-editor-reserva="6" />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="field-group compact">
                  <div class="field-head">
                    <div>
                      <p class="eyebrow">Beneficios</p>
                      <p class="muted tiny">Texto de pactadas y bonificaciones.</p>
                    </div>
                  </div>
                  <div class="field textarea-field">
                    <label for="editorBenefitPactada">Pactada</label>
                    <textarea id="editorBenefitPactada" rows="2" placeholder="Ej: Chevroplan pactada cuota n¬∫6"></textarea>
                  </div>
                  <div class="field textarea-field">
                    <label for="editorBenefitBonificacion">Bonificaci√≥n</label>
                    <textarea id="editorBenefitBonificacion" rows="2" placeholder="Ej: 50% desc. en las primeras 3 cuotas del seguro"></textarea>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="editor-tab-panel" data-editor-panel="brands">
            <div class="brand-manager">
              <div class="brand-manager-head">
                <div>
                  <p class="eyebrow">Gesti√≥n de Marcas</p>
                  <p class="muted tiny">Define color, nombre y esquema de cuotas para cada marca disponible.</p>
                </div>
                <button id="addBrand" class="secondary-btn mini" type="button"><i class='bx bx-plus'></i>Agregar marca</button>
              </div>
              <div id="brandManagerList" class="brand-manager-list"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow" id="modalEyebrow">Confirmaci√≥n</p>
          <h3 id="modalTitle"></h3>
          <p class="muted" id="modalMessage"></p>
        </div>
        <button id="modalClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-actions">
        <button id="modalCancel" class="ghost-btn">Cancelar</button>
        <button id="modalConfirm" class="primary-btn">Aceptar</button>
      </div>
    </div>
  </div>
  <div id="quoteAliasModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Mis Cotizaciones</p>
          <h3>Ingresa el nombre para guardar esta cotizaci√≥n</h3>
          <p class="muted">Puedes editarlo luego desde el editor.</p>
        </div>
        <button id="quoteAliasClose" class="ghost-btn icon-only" aria-label="Cerrar"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-body">
        <div class="field">
          <label for="quoteAliasInputModal">Nombre de la cotizaci√≥n</label>
          <input id="quoteAliasInputModal" placeholder="Ej: MARTINEZ MAXIMILIANO - PEUGEOT 2008 - 02/01/2026" />
        </div>
      </div>
      <div class="modal-actions">
        <button id="quoteAliasCancel" class="ghost-btn">Cancelar</button>
        <button id="quoteAliasSave" class="primary-btn"><i class='bx bx-save'></i>Guardar</button>
      </div>
    </div>
  </div>
  <div id="dataResetModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Advertencia</p>
          <h3 id="dataResetTitle">Advertencia</h3>
          <p class="muted data-reset-message">
            Esto eliminar√° toda la configuraci√≥n guardada localmente, te recomendamos hacer una copia de seguridad de tu perfil para no perder los datos. Esto tambien limpiar√° tus datos "en linea", si no tienes copia de respaldo, podrias perder todo.
          </p>
        </div>
        <button id="dataResetClose" class="ghost-btn icon-only" aria-label="Cerrar advertencia"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-body data-reset-body">
        <label class="checkbox-row data-reset-check">
          <input type="checkbox" id="dataResetCheck">
          <span>Entiendo lo que estoy haciendo.</span>
        </label>
      </div>
      <div class="modal-actions data-reset-actions">
        <button id="dataResetExport" class="secondary-btn"><i class='bx bx-download'></i>Exportar Mi Perfil</button>
        <button id="dataResetConfirm" class="primary-btn" disabled>Continuar</button>
      </div>
    </div>
  </div>
  <div id="syncConflictModal" class="modal hidden">
    <div class="modal-content wide sync-conflict-modal">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Sincronizaci√≥n</p>
          <h3>Se detect√≥ informaci√≥n diferente</h3>
          <p class="muted">Elige qu√© versi√≥n quieres usar antes de continuar.</p>
          <p class="muted tiny">Haz clic en cualquier elemento para ver su detalle y peso de diferencia.</p>
        </div>
      </div>
      <div class="modal-body sync-conflict-body">
        <div class="sync-conflict-card" data-source="local">
          <div class="sync-conflict-head">
            <i class='bx bx-hard-drive'></i>
            <div>
              <strong>Datos locales</strong>
              <p class="muted tiny" id="syncLocalUpdated">Actualizado: -</p>
            </div>
          </div>
          <div class="sync-conflict-list" id="syncLocalSummary"></div>
        </div>
        <div class="sync-conflict-card" data-source="remote">
          <div class="sync-conflict-head">
            <i class='bx bx-cloud'></i>
            <div>
              <strong>Datos online</strong>
              <p class="muted tiny" id="syncRemoteUpdated">Actualizado: -</p>
            </div>
          </div>
          <div class="sync-conflict-list" id="syncRemoteSummary"></div>
        </div>
      </div>
      <div class="modal-actions">
        <button id="syncConflictLocal" class="secondary-btn"><i class='bx bx-hard-drive'></i>Usar datos locales</button>
        <button id="syncConflictRemote" class="primary-btn"><i class='bx bx-cloud'></i>Usar datos online</button>
      </div>
    </div>
  </div>
  <div id="moduleImportModal" class="modal hidden">
    <div class="modal-content wide module-import-modal">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Gesti√≥n de m√≥dulos</p>
          <h3>Estas por importar elementos</h3>
          <p class="muted" id="moduleImportModalSubtitle">Revisa los m√≥dulos y confirma para continuar.</p>
        </div>
        <button id="moduleImportClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-body">
        <div class="module-import-modal-list" id="moduleImportModalList"></div>
        <div class="module-import-warning">
          <p><strong>Esto reemplazar√° la configuraci√≥n actual.</strong></p>
          <p class="muted tiny">Si no tienes copia hecha se reemplazar√°n y se perder√°n.</p>
        </div>
        <label class="checkbox-row">
          <input type="checkbox" id="moduleImportAcknowledge">
          <span>Entiendo lo que estoy haciendo.</span>
        </label>
      </div>
      <div class="modal-actions">
        <button class="ghost-btn" id="moduleImportCancel">Cancelar</button>
        <button class="primary-btn" id="moduleImportConfirm" disabled>Continuar</button>
      </div>
    </div>
  </div>
  <div id="quoteRestoreModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Restaurar cotizaci√≥n</p>
          <h3>Antes ten√≠as una Cotizaci√≥n abierta.</h3>
          <p class="muted">¬øQuieres restaurarla y continuar edit√°ndola?</p>
        </div>
        <button id="quoteRestoreClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-actions stacked">
        <button id="quoteRestoreContinue" class="primary-btn"><i class='bx bx-rotate-right'></i>Si, Continuar la edici√≥n</button>
        <button id="quoteRestoreReload" class="secondary-btn"><i class='bx bx-user'></i>No, Volver a cargar los datos del cliente</button>
        <button id="quoteRestoreReset" class="ghost-btn danger"><i class='bx bx-eraser'></i>No, Empezar desde 0 en blanco</button>
      </div>
    </div>
  </div>
  <div id="processingOverlay" class="processing-overlay hidden" aria-live="polite">
    <div class="processing-card">
      <span class="processing-spinner" aria-hidden="true"></span>
      <div>
        <p class="eyebrow">Procesando cambios</p>
        <h3>Procesando cambios... Aguarde un momento.</h3>
        <p class="muted">Estamos ajustando productos, precios y planes.</p>
      </div>
    </div>
  </div>
  <div id="accountApplyOverlay" class="processing-overlay hidden" aria-live="polite">
    <div class="processing-card">
      <span class="processing-spinner" aria-hidden="true"></span>
      <div>
        <p class="eyebrow">Asignaci√≥n masiva</p>
        <h3>Aplicando... Aguarda un momento.</h3>
        <p class="muted">Estamos vinculando la cuenta a tus contactos.</p>
      </div>
    </div>
  </div>
  <div id="quoteExportOverlay" class="processing-overlay hidden" aria-live="polite">
    <div class="processing-card export-card">
      <span class="processing-spinner" aria-hidden="true"></span>
      <div>
        <p class="eyebrow">Exportaci√≥n</p>
        <h3>Generando la cotizaci√≥n... Espera un momento...</h3>
        <div class="export-progress">
          <span></span>
        </div>
      </div>
    </div>
  </div>
  <div id="importOverlay" class="processing-overlay hidden import-overlay" aria-live="polite">
    <div class="processing-card import-card">
      <div class="import-card-head">
        <span class="processing-spinner" aria-hidden="true"></span>
        <div>
          <p class="eyebrow" id="importOverlayEyebrow">Importaci√≥n</p>
          <h3 id="importOverlayTitle">Preparando importaci√≥n...</h3>
          <p class="muted" id="importOverlaySubtitle">Espera un momento...</p>
          <p class="muted tiny" id="importOverlayHelper">Estamos leyendo los datos para la importaci√≥n...</p>
        </div>
      </div>
      <div class="import-progress">
        <div class="import-progress-bar"><span id="importOverlayBar"></span></div>
        <div class="import-progress-steps" id="importOverlaySteps"></div>
      </div>
    </div>
  </div>
  <div id="adminPanelModal" class="modal hidden">
    <div class="modal-content wide admin-modal">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Control de acceso</p>
          <h3>Administraci√≥n de usuarios</h3>
          <p class="muted">Crea, edita permisos y controla las sesiones en tiempo real.</p>
        </div>
        <button id="adminPanelClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-body">
        <div class="admin-tabs" id="adminTabs">
          <button class="admin-tab active" data-admin-tab="overview"><i class='bx bx-group'></i>Usuarios</button>
          <button class="admin-tab" data-admin-tab="connected"><i class='bx bx-wifi'></i>Conectados</button>
          <button class="admin-tab" data-admin-tab="create"><i class='bx bx-user-plus'></i>Crear usuario</button>
        </div>
        <div class="admin-tab-panels">
          <div class="admin-tab-panel active" data-admin-panel="overview">
            <div class="admin-panel-grid">
              <section class="admin-user-list">
                <header>
                  <div>
                    <h4>Usuarios activos</h4>
                    <p class="muted tiny">Selecciona un usuario para ver su detalle completo.</p>
                  </div>
                  <div class="admin-toolbar">
                    <span class="pill" id="adminUserCount">0 usuarios</span>
                    <button class="ghost-btn mini" id="adminRefreshList"><i class='bx bx-refresh'></i>Actualizar</button>
                  </div>
                </header>
                <div class="admin-user-cards" id="adminUserList"></div>
              </section>
              <section class="admin-user-detail">
                <header>
                  <div>
                    <h4 id="adminDetailTitle">Detalle de usuario</h4>
                    <p class="muted tiny" id="adminDetailSubtitle">Selecciona un usuario para comenzar.</p>
                  </div>
                  <button class="ghost-btn mini" id="adminRefreshUserData"><i class='bx bx-cloud-download'></i>Recargar datos</button>
                </header>
                <div class="admin-user-scroll">
                  <div class="admin-user-meta" id="adminUserMeta"></div>
                  <div class="admin-metrics-grid" id="adminUserMetrics"></div>
                  <form id="adminEditForm" data-uid="">
                    <div class="form-grid">
                      <label class="field">
                        <span>Usuario</span>
                        <input type="text" id="adminEditUsername" readonly>
                      </label>
                      <label class="field">
                        <span>Nombre visible</span>
                        <input type="text" id="adminEditName" required>
                      </label>
                      <label class="field">
                        <span>Rol</span>
                        <select id="adminEditRole" required>
                          <option value="Administrador">Administrador</option>
                          <option value="Team Leader">Team Leader</option>
                          <option value="Usuario">Usuario</option>
                        </select>
                      </label>
                      <label class="field">
                        <span>Estado</span>
                        <select id="adminEditStatus">
                          <option value="active">Activo</option>
                          <option value="disabled">Desactivado</option>
                        </select>
                      </label>
                      <label class="field">
                        <span>Nueva contrase√±a (opcional)</span>
                        <input type="password" id="adminEditPassword" autocomplete="new-password">
                      </label>
                    </div>
                    <div class="modal-actions">
                      <button type="submit" class="primary-btn"><i class='bx bx-save'></i>Guardar cambios</button>
                      <button type="button" class="ghost-btn danger" id="adminDeleteUser"><i class='bx bx-trash'></i>Eliminar usuario</button>
                    </div>
                  </form>
                </div>
              </section>
            </div>
          </div>
          <div class="admin-tab-panel" data-admin-panel="connected">
            <section class="admin-connected">
              <header>
                <div>
                  <h4>Usuarios conectados</h4>
                  <p class="muted tiny">Conexiones activas en tiempo real.</p>
                </div>
                <div class="admin-toolbar">
                  <span class="pill" id="adminConnectedCount">0 conectados</span>
                  <button class="ghost-btn mini" id="adminRefreshConnected"><i class='bx bx-refresh'></i>Actualizar</button>
                  <button class="ghost-btn mini danger" id="adminForceLogoutAll"><i class='bx bx-log-out-circle'></i>Cerrar todas</button>
                </div>
              </header>
              <div class="admin-connected-list" id="adminConnectedList"></div>
            </section>
          </div>
          <div class="admin-tab-panel" data-admin-panel="create">
            <section class="admin-user-form">
              <header>
                <h4>Crear nuevo usuario</h4>
                <p class="muted tiny">Completa los datos y guarda para habilitar su acceso.</p>
              </header>
              <form id="adminCreateForm">
                <div class="form-grid">
                  <label class="field">
                    <span>Usuario</span>
                    <input type="text" id="adminCreateUsername" required>
                  </label>
                  <label class="field">
                    <span>Nombre visible</span>
                    <input type="text" id="adminCreateName" required>
                  </label>
                  <label class="field">
                    <span>Rol</span>
                    <select id="adminCreateRole" required>
                      <option value="Administrador">Administrador</option>
                      <option value="Team Leader">Team Leader</option>
                      <option value="Usuario">Usuario</option>
                    </select>
                  </label>
                  <label class="field">
                    <span>Contrase√±a inicial</span>
                    <input type="password" id="adminCreatePassword" required>
                  </label>
                  <label class="field">
                    <span>Estado</span>
                    <select id="adminCreateStatus">
                      <option value="active">Activo</option>
                      <option value="disabled">Desactivado</option>
                    </select>
                  </label>
                </div>
                <div class="modal-actions">
                  <button type="reset" class="ghost-btn" id="adminCreateReset">Limpiar</button>
                  <button type="submit" class="primary-btn"><i class='bx bx-save'></i>Crear usuario</button>
                </div>
              </form>
            </section>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="passwordModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Seguridad</p>
          <h3>Cambiar contrase√±a</h3>
          <p class="muted">Actualiza tu acceso personal para mantener tu cuenta segura.</p>
        </div>
        <button id="passwordModalClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <form id="passwordForm">
        <div class="form-grid">
          <label class="field">
            <span>Contrase√±a actual</span>
            <input type="password" id="passwordCurrent" autocomplete="current-password" required>
          </label>
          <label class="field">
            <span>Nueva contrase√±a</span>
            <input type="password" id="passwordNew" autocomplete="new-password" required>
          </label>
          <label class="field">
            <span>Confirmar nueva contrase√±a</span>
            <input type="password" id="passwordConfirm" autocomplete="new-password" required>
          </label>
        </div>
        <div class="modal-actions">
          <button type="button" class="ghost-btn" id="passwordCancel">Cancelar</button>
          <button type="submit" class="primary-btn"><i class='bx bx-lock'></i>Actualizar contrase√±a</button>
        </div>
      </form>
    </div>
  </div>
  <button class="scroll-top-btn" id="scrollTopButton" aria-label="Volver arriba" aria-hidden="true">
    <i class='bx bx-chevron-up'></i>
  </button>
  <script type="module" src="firebase-config.js"></script>
  <script type="module" src="app.js"></script>
</body>
</html>
