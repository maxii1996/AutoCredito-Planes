<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chevrolet Plan Manager 2025</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css">
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
  <div class="app-shell">
    <aside class="sidebar">
      <div class="brand">
        <div class="brand-icon">游뚱</div>
        <div>
          <p class="brand-title">Asesor:</p>
          <p class="brand-subtitle" id="sidebarAdvisor">Chevrolet Argentina</p>
        </div>
      </div>
      <nav class="nav">
        <button class="nav-link active" data-target="dashboard"><i class='bx bxs-dashboard'></i><span class="label"> Inicio</span></button>
        <button class="nav-link" data-target="clientManager"><i class='bx bx-group'></i><span class="label"> Gestor de Clientes</span></button>
        <button class="nav-link" data-target="templates"><i class='bx bx-message-dots'></i><span class="label"> Plantillas</span></button>
        <button class="nav-link" data-target="plans"><i class='bx bx-notepad'></i><span class="label"> Cotizaciones</span></button>
        <button class="nav-link" data-target="vehicles"><i class='bx bx-car'></i><span class="label"> Autos y Valores</span></button>
      </nav>
     
    </aside>
    <main class="content">
      <header class="topbar">
        <div class="title-area">
          <button id="sidebarToggle" class="ghost-btn icon-only menu-toggle" title="Mostrar u ocultar men칰"><i class='bx bx-menu-alt-left'></i></button>
          <div>
            <h1 id="sectionTitle">Inicio</h1>
          </div>
        </div>
        <div class="top-actions">
          <div class="client-file-actions">
            <label class="secondary-btn upload-btn" title="Subir archivo Excel"><i class='bx bx-upload'></i> Importar Excel<input type="file" id="clientExcel" accept=".xlsx,.xls,.csv"></label>
            <button id="exportClients" class="ghost-btn" title="Exportar clientes filtrados"><i class='bx bx-download'></i>Exportar</button>
          </div>
          <div class="menu-cluster">
            <div class="action-menu" id="actionMenu">
              <button class="menu-trigger primary" id="actionMenuToggle"><i class='bx bx-collection'></i><span>Mi Perfil</span><i class='bx bx-chevron-down'></i></button>
              <div class="menu-panel" id="actionMenuPanel">
                <div class="menu-head">
                  <p class="eyebrow">Mi Perfil</p>
                  <h4>Mi Perfil</h4>
                </div>
                                <label class="menu-item upload-btn"><i class='bx bx-upload'></i> Importar perfil<input type="file" id="importProfile" accept="application/json"></label>
                <button id="exportProfile" class="menu-item"><i class='bx bx-download'></i> Exportar perfil</button>
              </div>
            </div>
            <div class="icon-menu" id="settingsMenu">
              <button class="menu-trigger ghost" id="settingsToggle" title="Centro de control"><i class='bx bx-cog'></i><span>Opciones</span><i class='bx bx-dots-vertical-rounded'></i></button>
              <div class="menu-panel" id="settingsPanel">
                <div class="menu-head">
                  <p class="eyebrow">Opciones</p>
                  <h4>Opciones</h4>
                </div>
                <button class="menu-item" id="openPreferences"><i class='bx bx-slider-alt'></i> Mis preferencias</button>
                <button class="menu-item" id="clearStorage"><i class='bx bx-trash'></i> Limpiar datos locales</button>
                <button class="menu-item" id="resetDefaults"><i class='bx bx-refresh'></i> Restaurar valores base</button>
              </div>
            </div>
          </div>
        </div>
      </header>

      <section id="dashboard" class="panel active">
        <div class="dashboard-hero" id="welcomeHero">
            <div class="hero-main modern">
              <div class="eyebrow">Inicio</div>
              <h2 id="dashboardHeading">Control principal</h2>
              <p class="muted" id="dashboardSubtitle">Define qui칠n atiende y ajusta tu jornada.</p>
              <div class="advisor-card">
                <div class="field">
                  <label for="advisorInput">Nombre del vendedor</label>
                  <div class="advisor-input">
                    <input id="advisorInput" list="advisorSuggestions" placeholder="Ej: Sof칤a Alvarez" />
                    <datalist id="advisorSuggestions"></datalist>
                  </div>
                </div>
              <p class="muted tiny" id="advisorHelper">Selecciona el nombre de Vendedor que quieres utilizar para Primer Contacto.</p>
              </div>
            <div class="hero-actions tight">
              <button class="primary-btn" data-jump="clientManager"><i class='bx bx-group'></i>Gestor de clientes</button>
              <button class="secondary-btn" data-jump="plans"><i class='bx bx-notepad'></i>Crear plan</button>
              <button class="ghost-btn" data-jump="templates"><i class='bx bx-message-dots'></i>Plantillas</button>
            </div>
          </div>
          <div class="hero-side metrics">
            <div class="stat-tiles">
              <div class="tile" data-tone="blue">
                <div class="tile-icon">游눫</div>
                <div>
                  <p class="label">Plantillas</p>
                  <p class="value" id="templateCount">0</p>
                </div>
              </div>
              <div class="tile" data-tone="green">
                <div class="tile-icon">游논</div>
                <div>
                  <p class="label">Registros de clientes</p>
                  <p class="value" id="clientCount">0</p>
                </div>
              </div>
            </div>
          </div>
        </div>

      </section>

      <section id="templates" class="panel">
        <div class="panel-head">
          <div>
            <p class="eyebrow">Plantillas con variables</p>
            <h2>Gestor de Plantillas</h2>
            <p class="muted subtle">Permite modificar, editar y crear nuevas plantillas para copiar y utilizar r치pidamente en los mensajes.</p>
          </div>
          <div class="actions">
            <div class="search-field">
              <i class='bx bx-search'></i>
              <input id="templateSearch" placeholder="Buscar plantillas" />
            </div>
            <button id="addTemplate" class="ghost-btn"><i class='bx bx-plus'></i>Nueva plantilla</button>
          </div>
        </div>
        <div class="templates-layout">
          <aside class="template-list" id="templateList"></aside>
          <div class="template-editor">
            <div class="preview-stack">
              <div class="preview-box">
                <p class="eyebrow">Previsualizaci칩n</p>
                <pre id="templatePreview"></pre>
              </div>
              <div class="actions compact">
                <div class="autosave-hint">Guardado en tiempo real</div>
                <button id="copyTemplate" class="secondary-btn"><i class='bx bx-copy'></i>Copiar esta plantilla</button>
                <span id="copyStatus" class="muted"></span>
              </div>
            </div>
            <div class="field">
              <label for="templateTitle">T칤tulo</label>
              <input id="templateTitle" placeholder="Ej: Mensaje de inicio" />
            </div>
            <div class="field textarea-field">
              <label for="templateBody">Contenido</label>
              <div class="textarea-shell">
                <textarea id="templateBody" rows="10" placeholder="Escribe el mensaje con variables"></textarea>
                <div class="chips inline" id="variableChips"></div>
              </div>
            </div>
            <div class="variables-head">
              <p class="eyebrow">Variables activas</p>
              <p class="muted tiny">Solo las que est치n en el mensaje.</p>
            </div>
            <div class="variable-grid" id="variableInputs"></div>
          </div>
        </div>
      </section>

      <section id="vehicles" class="panel">
        <div class="panel-head">
          <div>
            <p class="eyebrow">Tabla de Autos Disponibles en Cat치logo</p>
            <h2>Tabla Chevrolet</h2>
            <p class="muted">Basada en la lista oficial: Onix, Onix Plus, Montana, S10, Tracker y Spin. Ajusta los importes a conveniencia.</p>
            <p class="muted subtle">Los autos que est치n aqu칤 podr칤an cambiar en el futuro, no basarse 100% en esta informaci칩n.</p>
            <p class="muted subtle" id="vehicleUpdateTag">칔ltima actualizaci칩n: Diciembre 2025</p>
          </div>
          <div class="toggles">
            <button id="viewPriceImage" class="ghost-btn" type="button"><i class='bx bx-image'></i>Ver imagen online</button>
            <button id="viewMonthFiles" class="ghost-btn" type="button"><i class='bx bx-folder'></i>Ver otros archivos del mes...</button>
            <button id="importPrices" class="ghost-btn" type="button"><i class='bx bx-import'></i>Importar precios</button>
            <button id="exportPrices" class="ghost-btn" type="button"><i class='bx bx-export'></i>Exportar precios</button>
            <label class="toggle">
              <input type="checkbox" id="showReservations" checked>
              <span>Ver reservas (1, 3 y 6 cuotas)</span>
            </label>
            <label class="toggle">
              <input type="checkbox" id="showIntegration" checked>
              <span>Ver integraci칩n</span>
            </label>
          </div>
        </div>
        <div class="price-tabs">
          <div class="tab-manager">
            <div>
              <p class="eyebrow">Hist칩rico de listas</p>
              <p class="muted tiny" id="priceTabSubtitle">Precios en modo local</p>
            </div>
            <div id="priceAlerts" class="alert-stack compact"></div>
            <div class="actions compact">
              <button class="ghost-btn" id="addPriceTab"><i class='bx bx-duplicate'></i>Nueva pesta침a</button>
              <button class="ghost-btn" id="renamePriceTab"><i class='bx bx-edit-alt'></i>Renombrar</button>
              <button class="ghost-btn danger" id="deletePriceTab"><i class='bx bx-trash'></i>Borrar</button>
            </div>
          </div>
          <div class="tab-list" id="priceTabList"></div>
        </div>
        <div class="table-wrapper">
          <table id="vehicleTable">
            <thead></thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section id="plans" class="panel">
        <div class="panel-head">
          <div>
            <p class="muted subtle">Simulador de Cotizaciones <br><h5>Advertencia: Esto es meramente experimental:</h5> Las cotizaciones se recomienda hacerlas a mano con la informaci칩n aprendida.</p>
          </div>
          <div class="actions">
            <button id="saveClient" class="primary-btn"><i class='bx bx-save'></i>Guardar cotizaci칩n</button>
            <button id="copyQuote" class="secondary-btn" type="button"><i class='bx bx-copy'></i>Copiar cotizaci칩n</button>
            <button id="openQuoteModal" class="ghost-btn" type="button"><i class='bx bx-archive'></i>Ver cotizaciones guardadas</button>
          </div>
        </div>
        <div class="resource-row">
          <div class="resource-card">
            <div class="resource-preview" style="background-image:url('img/Template/InfoAuto.jpg');"></div>
            <div class="resource-meta">
              <p class="eyebrow">Logo InfoAuto</p>
              <p class="muted tiny">칔salo como imagen de respaldo en env칤os al cliente.</p>
            </div>
            <div class="actions compact">
              <button id="viewInfoAuto" class="ghost-btn" type="button"><i class='bx bx-show'></i>Ver imagen</button>
              <button id="downloadInfoAuto" class="secondary-btn" type="button"><i class='bx bx-download'></i>Descargar</button>
            </div>
          </div>
          <div class="resource-card">
            <div class="resource-preview" style="background-image:url('img/Template/FotosReferenciaParaCliente.jpg');"></div>
            <div class="resource-meta">
              <p class="eyebrow">Imagen de referencia</p>
              <p class="muted tiny">Desc치rgala para compartir junto a la cotizaci칩n.</p>
            </div>
            <div class="actions compact">
              <button id="viewClientReference" class="ghost-btn" type="button"><i class='bx bx-show'></i>Ver imagen</button>
              <button id="downloadClientReference" class="secondary-btn" type="button"><i class='bx bx-download'></i>Descargar imagen de Referencia para cliente</button>
            </div>
          </div>
        </div>
        <div class="quote-layout">
          <aside class="card form quote-form">
            <div class="card-head compact">
              <p class="eyebrow">Carga r치pida</p>
              <h3>Datos de cotizaci칩n</h3>
            </div>
            <div class="field">
              <label for="clientName">Cliente</label>
              <div class="picker-row dense">
                <input id="clientName" placeholder="Nombre y apellido" />
                <button id="openClientPicker" class="secondary-btn mini" type="button"><i class='bx bx-user-voice'></i>Cliente</button>
              </div>
              <p class="muted tiny" id="selectedClientHint">Puedes escribir los datos o aplicar uno importado.</p>
            </div>
            <div class="form-grid three">
              <div class="field">
                <div class="label-row">
                  <label for="planModel">Auto a cotizar</label>
                  <span class="muted tiny micro-tag" id="priceContextTag">Utilizando precios de: Diciembre 2025</span>
                </div>
                <select id="planModel"></select>
              </div>
              <div class="field readonly">
                <label>Plan asignado autom치ticamente</label>
                <div class="plan-profile-cell readonly">
                  <span class="chip muted" id="planProfileChip"></span>
                  <small class="muted tiny" id="planProfileHelper">El plan se selecciona solo seg칰n el modelo.</small>
                </div>
                <input type="hidden" id="planType" value="85a120" />
              </div>
              <div class="field">
                <label class="toggle compact">
                  <input type="checkbox" id="tradeIn" checked>
                  <span>Entrega llave x llave</span>
                </label>
                <div class="money-field">
                  <span class="prefix">$</span>
                  <input id="tradeInValue" class="money" type="text" inputmode="numeric" placeholder="Valor estimado usado" />
                </div>
              </div>
            </div>
            <div class="form-grid two">
              <div class="field">
                <label for="versionSelect">Versi칩n</label>
                <select id="versionSelect">
                  <option value="base">Versi칩n base</option>
                  <option value="upgrade">Versi칩n mejorada</option>
                </select>
              </div>
              <div class="field">
                <label for="versionUpgrade">Ajuste por versi칩n</label>
                <div class="money-field">
                  <span class="prefix">$</span>
                  <input id="versionUpgrade" class="money" type="text" inputmode="numeric" placeholder="Importe extra a financiar" />
                </div>
              </div>
            </div>
            <div class="form-grid two">
              <div class="field">
                <label for="customPrice">Precio personalizado</label>
                <div class="money-field">
                  <span class="prefix">$</span>
                  <input id="customPrice" class="money" type="text" inputmode="numeric" placeholder="Ej: 32.500.000" />
                </div>
              </div>
              <div class="field readonly">
                <label>Integraci칩n posible</label>
                <div class="integration-details" id="integrationDetails">
                  <p id="integration1">1 cuota promocionada: $0</p>
                  <p id="integration3">3 cuotas "sin inter칠s" de: $0 cada una</p>
                  <p id="integration6">6 cuotas "sin inter칠s" de: $0 cada una</p>
                </div>
                <input type="hidden" id="appliedReservation" value="1" />
              </div>
            </div>
            <div class="field-group compact">
              <div class="field-head">
                <div>
                  <p class="eyebrow">Reservas editables</p>
                  <p class="muted tiny">Valores del mes traducidos de la lista oficial.</p>
                </div>
                <div class="reservation-actions">
                  <button id="calcReservation3" class="ghost-btn mini" type="button"><i class='bx bx-calculator'></i>3 cuotas</button>
                  <button id="calcReservation6" class="ghost-btn mini" type="button"><i class='bx bx-math'></i>6 cuotas</button>
                </div>
              </div>
              <div class="reservation-grid compact">
                <div class="field">
                  <label for="reservation1">1 cuota</label>
                  <div class="money-field">
                    <span class="prefix">$</span>
                    <input id="reservation1" class="money" type="text" inputmode="numeric" placeholder="Reserva 칰nica" />
                  </div>
                </div>
                <div class="field">
                  <label for="reservation3">3 cuotas</label>
                  <div class="money-field">
                    <span class="prefix">$</span>
                    <input id="reservation3" class="money" type="text" inputmode="numeric" placeholder="Reserva 3 pagos" />
                  </div>
                </div>
                <div class="field">
                  <label for="reservation6">6 cuotas</label>
                  <div class="money-field">
                    <span class="prefix">$</span>
                    <input id="reservation6" class="money" type="text" inputmode="numeric" placeholder="Reserva 6 pagos" />
                  </div>
                </div>
              </div>
            </div>
            <div class="field">
              <label for="notes">Notas internas</label>
              <textarea id="notes" rows="3" placeholder="Condiciones, color elegido, plazos, etc."></textarea>
            </div>
          </aside>

          <div class="quote-details">
            <section class="plan-folio">
              <div class="folio-head">
                <div>
                  <p class="eyebrow">Detalle simplificado</p>
                  <h3>Folleto del plan</h3>
                </div>
                <div class="folio-switch">
                  <label class="toggle">
                    <input type="checkbox" id="advancePayments">
                    <span>쮼l cliente quiere adelantar cuotas?</span>
                  </label>
                  <div class="money-field compact" id="advanceAmountField">
                    <span class="prefix">$</span>
                    <input id="advanceAmount" class="money" type="text" inputmode="numeric" placeholder="Monto a adelantar" />
                  </div>
                  <p class="muted tiny">Si adelanta, se descuentan las 칰ltimas cuotas primero usando la cuota pura.</p>
                </div>
              </div>
              <div class="folio-cta-row">
                <button id="openInstallmentBreakdown" class="secondary-btn" type="button"><i class='bx bx-list-ol'></i>Ver desglose completo</button>
              </div>
              <div class="folio-body">
                <div class="folio-section">
                  <h4>Datos principales</h4>
                  <div id="planBasicsList" class="folio-list"></div>
                </div>
                <div class="folio-section">
                  <h4>Integraci칩n y cuota 1</h4>
                  <div id="planIntegrationSummary" class="folio-list"></div>
                </div>
              </div>
              <div class="folio-body">
                <div class="folio-section">
                  <h4>Saldo y aportes</h4>
                  <div id="planBalanceSummary" class="folio-list"></div>
                </div>
                <div class="folio-section">
                  <h4>Cuotas por tramo</h4>
                  <div id="planRangeList" class="range-grid"></div>
                </div>
              </div>
              <div class="folio-section wide">
                <h4>Estado de cuotas</h4>
                <div id="planCoverageList" class="coverage-grid"></div>
              </div>
            </section>
          </div>
        </div>
      </section>
      <section id="clientManager" class="panel">
        <div class="panel-head">
          <div>
            <p class="eyebrow">Clientes importados</p>
            <h2>Gestor de Clientes</h2>
          </div>
        </div>

        <div class="card">
          <div class="client-controls">
            <div class="client-top-row">
              <div class="advisor-combo">
                <div class="combo-head">Asesor activo</div>
                <div class="combo-shell">
                  <i class='bx bx-user-voice'></i>
                  <select id="advisorSelector" disabled></select>
                </div>
              </div>
              <div class="advisor-filters">
                <div class="toggle filter-toggle" title="Filtrar por estado de contacto">
                  <i class='bx bx-filter-alt'></i>
                  <div class="filter-label">
                    <span class="muted tiny">Mostrar:</span>
                    <strong id="statusFilterLabel">Todos</strong>
                  </div>
                  <select id="statusFilter">
                    <option value="all">Todos</option>
                    <option value="contacted">Contactado</option>
                    <option value="no_number">N칰mero no disponible</option>
                    <option value="favorite">Favoritos</option>
                    <option value="pending">Pendientes</option>
                  </select>
                </div>
                <button class="ghost-btn" id="openDateFilter"><i class='bx bx-calendar'></i>Filtro por fecha</button>
              </div>
            </div>
            <div class="control-bar">
              <div class="control-group secondary">
                <button class="secondary-btn" id="toggleEditMode"><i class='bx bx-edit-alt'></i>Activar Modo Edici칩n</button>
                <button class="secondary-btn" id="openActionCustomizer"><i class='bx bx-show-alt'></i>Personalizar Acciones</button>
                <button class="primary-btn" id="openContactAssistant"><i class='bx bx-bot'></i>Asistente de Contactos</button>
                <button class="secondary-btn" id="openContactLog"><i class='bx bx-time-five'></i>Registro de contactados</button>
              </div>
            </div>
          </div>
          <div id="dateFilterHelper" class="muted tiny"></div>
          <div class="column-pills" id="columnToggles"></div>
          <div class="search-notice hidden" id="clientSearchNotice">
            <div class="search-notice-text">
              <i class='bx bx-filter-alt'></i>
              <span>Se est치n mostrando los resultados de la b칰squeda: <strong id="clientSearchTerm"></strong></span>
            </div>
            <button class="ghost-btn mini" id="clientSearchReset">Restablecer</button>
          </div>
          <div class="pagination-bar hidden" id="clientPaginationBar">
            <div class="pagination-controls">
              <button class="ghost-btn mini" id="clientPaginationPrev"><i class='bx bx-chevron-left'></i>Anterior</button>
              <span id="clientPaginationInfo" class="muted tiny"></span>
              <button class="ghost-btn mini" id="clientPaginationNext">Siguiente<i class='bx bx-chevron-right'></i></button>
            </div>
          </div>
          <div class="table-wrapper dense">
            <div class="table-toolbar">
              <div class="search-group">
                <div class="search-field compact expandable">
                  <i class='bx bx-search'></i>
                  <input id="clientManagerSearch" placeholder="Escribe cualquier contenido a buscar..." />
                </div>
                <button class="secondary-btn" id="clientManagerSearchBtn"><i class='bx bx-search'></i>Buscar</button>
              </div>
              <div class="table-toolbar-actions">
                <div class="field compact-field inline" id="paginationToggleField">
                  <label for="clientPaginationSelect">Paginaci칩n</label>
                  <select id="clientPaginationSelect">
                    <option value="none">Desactivada</option>
                    <option value="20">Cada 20</option>
                    <option value="50">Cada 50</option>
                    <option value="100">Cada 100</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="data-grid" id="clientManagerTable">
              <div class="grid-head"></div>
              <div class="grid-body"></div>
            </div>
          </div>
          <p id="clientManagerHelper" class="muted tiny"></p>
        </div>
      </section>
    </main>
    <footer class="app-footer">
      <p>Creado por Maximiliano Martinez | version 1.0.8 | Solo uso interno autorizado</p>
    </footer>
  </div>
  <div class="popover-overlay fade" id="actionCustomizerOverlay">
    <div class="popover wide">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Configuraci칩n de acciones</p>
          <h3>Personalizar acciones r치pidas</h3>
          <p class="muted subtle">Oculta las predeterminadas o crea tus propias acciones con icono y color.</p>
        </div>
        <button class="ghost-btn icon-only" id="closeActionCustomizer"><i class='bx bx-x'></i></button>
      </div>
      <div class="customizer-content">
        <section class="action-group">
          <header class="group-head">
            <div>
              <p class="eyebrow">Acciones por defecto</p>
              <h4>Mostrar u ocultar</h4>
            </div>
          </header>
          <div class="action-list" id="defaultActionList"></div>
        </section>
        <section class="action-group">
          <header class="group-head">
            <div>
              <p class="eyebrow">Acciones personalizadas</p>
              <h4>Tus accesos r치pidos</h4>
            </div>
          </header>
          <div class="action-list" id="customActionList"></div>
          <div class="actions center" id="customActionCreate">
            <button class="primary-btn" id="newCustomAction"><i class='bx bx-plus'></i>Crear Nueva acci칩n Personalizada</button>
          </div>
        </section>
      </div>
    </div>
  </div>
  <div class="popover-overlay fade" id="customActionOverlay">
    <div class="popover compact" id="customActionPopover">
      <div class="popover-head">
        <div>
          <p class="eyebrow" id="customActionSubtitle">Nueva acci칩n</p>
          <h3 id="customActionTitle">Crear acci칩n personalizada</h3>
          <p class="muted subtle">Define icono, color y texto para tu acceso r치pido.</p>
        </div>
        <button class="ghost-btn icon-only" id="closeCustomAction"><i class='bx bx-x'></i></button>
      </div>
      <div class="form-grid">
        <div class="field">
          <label for="customActionLabel">Texto a mostrar</label>
          <input id="customActionLabel" placeholder="Ej: Contactado por Whatsapp" />
        </div>
        <div class="field">
          <label for="customActionColor">Color a usar</label>
          <input type="color" id="customActionColor" value="#38bdf8" />
        </div>
      </div>
      <div class="field">
        <label>Icono a mostrar</label>
        <div class="icon-row">
          <div class="icon-preview" id="customIconPreview"><i class='bx bx-check-circle'></i></div>
          <button class="secondary-btn" id="openIconPicker"><i class='bx bx-grid-alt'></i>Elegir icono</button>
        </div>
      </div>
      <div class="form-actions">
        <button class="ghost-btn" id="cancelCustomAction">Cancelar</button>
        <button class="primary-btn" id="saveCustomAction"><i class='bx bx-save'></i>Guardar esta acci칩n personalizada</button>
      </div>
    </div>
  </div>
  <div class="popover-overlay fade" id="iconPickerOverlay">
    <div class="popover nested" id="iconPickerPopover">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Selector de iconos</p>
          <h3>Elige un 칤cono</h3>
          <p class="muted subtle">Explora la biblioteca y selecciona el que mejor identifique tu acci칩n.</p>
        </div>
        <button class="ghost-btn icon-only" id="closeIconPicker"><i class='bx bx-x'></i></button>
      </div>
      <div class="icon-picker" id="customActionIcons"></div>
    </div>
  </div>
  <div class="popover-overlay" id="clientActionOverlay">
    <div class="popover wide" id="clientActionMenu">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Men칰 de acciones</p>
          <h3 id="clientActionTitle">Editar contacto</h3>
          <p class="muted subtle" id="clientActionSubtitle"></p>
        </div>
        <button class="ghost-btn icon-only" id="clientActionClose"><i class='bx bx-x'></i></button>
      </div>
      <div class="action-grid" id="clientActionList"></div>
    </div>
  </div>
  <div class="popover-overlay fade" id="contactAssistantOverlay">
    <div class="popover assistant" id="contactAssistantPopover">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Ronda de pendientes</p>
          <h3>Asistente de Contactos</h3>
          <p class="muted subtle">Gestiona cada cliente pendiente de forma manual y ordenada.</p>
        </div>
        <button class="ghost-btn icon-only" id="closeContactAssistant"><i class='bx bx-x'></i></button>
      </div>
      <div class="assistant-shell">
        <div class="assistant-header">
          <p class="muted tiny">Cliente actual</p>
          <h3 id="assistantClientName">-</h3>
          <p class="muted tiny" id="assistantHelper"></p>
        </div>
        <div class="assistant-layout" id="contactAssistantCard">
          <div class="assistant-card" data-tone="cyan">
            <div class="card-head">
              <p class="eyebrow">Tel칠fono</p>
              <button class="glow-btn icon-only" id="assistantCopyPhone" data-tone="cyan" title="Copiar celular"><i class='bx bx-copy'></i></button>
            </div>
            <p class="assistant-value" id="assistantClientPhone">-</p>
          </div>
          <div class="assistant-card" data-tone="purple">
            <div class="card-head">
              <p class="eyebrow">Copiar mensaje</p>
              <button class="glow-btn icon-only" id="assistantCopyMessage" data-tone="purple" title="Copiar mensaje"><i class='bx bx-message-square-dots'></i></button>
            </div>
            <p class="muted" id="assistantMessagePreview"></p>
          </div>
          <div class="assistant-card actions" data-tone="green">
            <p class="eyebrow">Marcar como...</p>
            <div class="action-buttons">
              <button class="glow-btn" id="assistantMarkContacted" data-tone="green"><i class='bx bx-check-circle'></i> Contactado</button>
              <button class="glow-btn" id="assistantMarkNoNumber" data-tone="red"><i class='bx bx-block'></i> N칰mero no disponible</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="popover-overlay fade" id="preferencesOverlay">
    <div class="popover wide" id="preferencesPanel">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Mis preferencias</p>
          <h3>Personaliza tu vista</h3>
          <p class="muted subtle">Ajusta el tama침o de texto y el formato visual de los datos.</p>
        </div>
        <button class="ghost-btn icon-only" id="closePreferences"><i class='bx bx-x'></i></button>
      </div>
      <div class="preferences-content">
        <section class="preferences-section">
          <div class="section-head">
            <div>
              <p class="eyebrow">Tama침o de fuente</p>
              <h4>Campos del gestor</h4>
              <p class="muted tiny">Cada ajuste afecta al Gestor de Clientes y al Asistente de Contactos.</p>
            </div>
          </div>
          <div class="preferences-grid" id="fontPreferencesList"></div>
        </section>
        <section class="preferences-section">
          <div class="section-head">
            <div>
              <p class="eyebrow">Visualizaci칩n</p>
              <h4>Celulares en formato simple</h4>
              <p class="muted tiny">Solo afecta a la tabla y al Asistente, no al copiado.</p>
            </div>
          </div>
          <div class="field">
            <label for="phoneDisplaySelect">Visualizaci칩n sencilla de celulares</label>
            <select id="phoneDisplaySelect">
              <option value="plain">Desactivada</option>
              <option value="split2">Activada con separador de 2</option>
              <option value="split3">Activada con separador de 3</option>
            </select>
          </div>
        </section>
      </div>
    </div>
  </div>
  <div class="modal hidden" id="clientEditModal">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow" id="clientEditEyebrow">Edici칩n</p>
          <h3 id="clientEditTitle"></h3>
          <p class="muted" id="clientEditSubtitle"></p>
        </div>
        <button id="clientEditClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="field" id="clientEditCurrent"></div>
      <div class="field" id="clientEditField"></div>
      <label class="toggle" id="uppercaseToggle" style="display:none;">
        <input type="checkbox" id="clientUppercase">
        <span>Forzar may칰sculas</span>
      </label>
      <div class="modal-actions">
        <button id="clientEditCancel" class="ghost-btn">Cancelar</button>
        <button id="clientEditSave" class="primary-btn"><i class='bx bx-save'></i>Guardar</button>
      </div>
    </div>
  </div>
  <div class="popover-overlay" id="contactLogOverlay">
    <div class="popover wide" id="contactLogPanel">
      <div class="popover-head">
        <div>
          <p class="eyebrow">Registro de Contactados</p>
          <h3>Seguimiento en tiempo real</h3>
          <p class="muted subtle">칔ltimas acciones marcadas: contactado, n칰mero no disponible o favoritos.</p>
        </div>
        <button class="ghost-btn icon-only" id="contactLogClose"><i class='bx bx-x'></i></button>
      </div>
      <div class="search-field">
        <i class='bx bx-search'></i>
        <input id="contactLogSearch" placeholder="Buscar por nombre, estado o tel칠fono" />
      </div>
      <div class="contact-log-body" id="contactLogList"></div>
      <div id="contactLogEmpty" class="empty-state hidden">
        <i class='bx bx-time-five'></i>
        <p class="muted">A칰n no hay registros de contacto. Marca clientes como contactados, n칰mero no disponible o favoritos para verlos aqu칤.</p>
      </div>
    </div>
  </div>
  <div class="context-menu hidden" id="clientContextMenu">
    <div class="context-menu-head">
      <div>
        <p class="eyebrow">Seleccionaste a:</p>
        <h4 id="contextClientName">Cliente</h4>
        <p class="muted tiny" id="contextClientModel"></p>
      </div>
      <button class="ghost-btn icon-only" id="closeContextMenu"><i class='bx bx-x'></i></button>
    </div>
    <div class="context-menu-body" id="contextMenuContent"></div>
  </div>
  <div id="toastContainer" class="toast-container"></div>
  <div id="exportModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Exportar clientes</p>
          <h3>Elige c칩mo quieres exportar</h3>
          <p class="muted" id="exportHelperText">Configura el m칠todo y las columnas a incluir.</p>
        </div>
        <button id="exportClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-actions top">
        <button id="exportCancel" class="ghost-btn">Cancelar</button>
        <button id="exportConfirm" class="primary-btn"><i class='bx bx-download'></i>Exportar ahora</button>
      </div>
      <div class="option-stack two-cols">
        <label class="option-card">
          <input type="radio" name="exportMode" value="local" checked>
          <div>
            <strong>Excel - Datos Ordenados por este Sistema</strong>
            <p class="muted tiny">Usa los campos locales y respeta el orden que definas abajo.</p>
          </div>
        </label>
        <label class="option-card">
          <input type="radio" name="exportMode" value="preset">
          <div>
            <strong>Excel - Igualar Cabezales Predet.</strong>
            <p class="muted tiny">Exporta con encabezados fijos: CUIT0, DOC, FECNAC, NOMBRE, OLOC, OPCIA, CP, CELULAR12, FECHA1, MARCA, MODELO, TIPO, ESTADO.</p>
          </div>
        </label>
      </div>
      <div class="export-options">
        <div class="export-options-head">
          <div>
            <p class="eyebrow">Contenido a exportar</p>
            <h4>Activa, desactiva y reordena columnas</h4>
            <p class="muted tiny">Todo est치 seleccionado por defecto. Usa las flechas para mover cada columna.</p>
          </div>
          <button id="exportSelectAll" class="ghost-btn"><i class='bx bx-check-double'></i>Seleccionar todo</button>
        </div>
        <div id="exportColumnsList" class="export-columns"></div>
      </div>
    </div>
  </div>
  <div id="clientPickerModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Seleccionar cliente</p>
          <h3>Contactos importados</h3>
          <p class="muted">Busca en la lista de clientes importados y aplica sus datos al plan.</p>
        </div>
        <button id="clientPickerClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="search-field expanded">
        <i class='bx bx-search'></i>
        <input id="clientPickerSearch" placeholder="Escribe cualquier contenido a buscar..." />
      </div>
      <div id="clientPickerList" class="picker-list"></div>
      <div class="modal-actions">
        <button id="clientPickerCancel" class="ghost-btn">Cerrar</button>
      </div>
    </div>
  </div>
  <div id="clientVehicleModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Modelo asociado</p>
          <h3>Confirmar veh칤culo del cliente</h3>
          <p class="muted" id="clientVehicleContext">Selecciona el veh칤culo vinculado al cliente.</p>
        </div>
        <button id="clientVehicleClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="field">
        <label for="clientVehicleOptions">El cliente tiene asociado el auto:</label>
        <select id="clientVehicleOptions"></select>
      </div>
      <div class="modal-actions">
        <button id="clientVehicleCancel" class="ghost-btn">Cancelar</button>
        <button id="clientVehicleApply" class="primary-btn"><i class='bx bx-check'></i>Utilizar selecci칩n</button>
      </div>
    </div>
  </div>
  <div id="clientNoteModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Notas</p>
          <h3 id="clientNoteTitle"></h3>
          <p class="muted" id="clientNoteSubtitle"></p>
        </div>
        <button id="clientNoteClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="field textarea-field">
        <label for="clientNoteText">Notas del cliente</label>
        <textarea id="clientNoteText" rows="6" placeholder="Agrega recordatorios, acuerdos o detalles relevantes"></textarea>
      </div>
      <div class="modal-actions">
        <button id="clientNoteCancel" class="ghost-btn">Cerrar</button>
        <button id="clientNoteSave" class="primary-btn"><i class='bx bx-save'></i>Guardar</button>
      </div>
    </div>
  </div>
  <div id="importDateModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Fecha de carga</p>
          <h3>Aplicar fecha a los clientes importados</h3>
          <p class="muted">Esta marca es opcional y te permitir치 filtrar o exportar por d칤a.</p>
        </div>
        <button id="importDateClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="option-stack">
        <label class="option-card">
          <input type="radio" name="importDateOption" value="today" checked>
          <div>
            <strong>Usar la fecha de hoy</strong>
            <p class="muted tiny" id="importDateTodayLabel"></p>
          </div>
        </label>
        <label class="option-card">
          <input type="radio" name="importDateOption" value="custom">
          <div>
            <strong>Elegir una fecha</strong>
            <p class="muted tiny">Selecciona manualmente la fecha de carga.</p>
            <input type="date" id="importCustomDate">
          </div>
        </label>
        <label class="option-card">
          <input type="radio" name="importDateOption" value="none">
          <div>
            <strong>No insertar fecha</strong>
            <p class="muted tiny">Se conservar치 vac칤o para estos registros.</p>
          </div>
        </label>
      </div>
      <div class="modal-actions">
        <button id="importDateCancel" class="ghost-btn">Cancelar</button>
        <button id="importDateConfirm" class="primary-btn"><i class='bx bx-check-double'></i>Confirmar</button>
      </div>
    </div>
  </div>
  <div id="importMappingModal" class="modal hidden">
    <div class="modal-content wide tall">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Comprobaci칩n de cabezales</p>
          <h3>Revisa y asigna las columnas del Excel</h3>
          <p class="muted">Selecciona d칩nde est치 cada dato obligatorio. Solo se usar치n las columnas asignadas.</p>
        </div>
        <button id="importMappingClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="import-mapping-hint" id="importMappingHint"></div>
      <div class="import-mapping-grid" id="importMappingFields"></div>
      <div class="modal-actions with-status">
        <div id="importMappingStatus" class="mapping-status"></div>
        <div class="action-buttons">
          <button id="importMappingCancel" class="ghost-btn">Cancelar</button>
          <button id="importMappingConfirm" class="primary-btn"><i class='bx bx-check'></i>Importar</button>
        </div>
      </div>
    </div>
  </div>
  <div id="dateFilterModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Filtrar por fecha</p>
          <h3>Rango de fechas de carga</h3>
          <p class="muted">Aplica un rango opcional seg칰n la fecha de carga al sistema.</p>
        </div>
        <button id="dateFilterClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="field">
        <label for="dateFilterFrom">Desde</label>
        <input type="date" id="dateFilterFrom">
      </div>
      <div class="field">
        <label for="dateFilterTo">Hasta</label>
        <input type="date" id="dateFilterTo">
      </div>
      <div class="modal-actions">
        <button id="clearDateFilter" class="ghost-btn">Limpiar filtro</button>
        <button id="applyDateFilter" class="primary-btn"><i class='bx bx-filter-alt'></i>Aplicar filtro</button>
      </div>
    </div>
  </div>
  <div id="quoteModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Cotizaciones previas</p>
          <h3>Guardar, cargar o eliminar</h3>
          <p class="muted">Gestiona historial con confirmaciones y copias r치pidas.</p>
        </div>
        <button id="quoteModalClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="search-field expanded">
        <i class='bx bx-search'></i>
        <input id="quoteSearch" placeholder="Escribe cualquier contenido a buscar..." />
      </div>
      <div id="quoteList" class="quote-list"></div>
      <div class="modal-actions">
        <button id="quoteModalCancel" class="ghost-btn">Cerrar</button>
      </div>
    </div>
  </div>
  <div id="priceTabModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Gesti칩n de pesta침as</p>
          <h3 id="priceTabModalTitle">Nueva pesta침a de precios</h3>
        </div>
        <button id="priceTabClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-body">
        <div class="field inline">
          <div class="field">
            <label for="priceTabMonth">Mes</label>
            <select id="priceTabMonth"></select>
          </div>
          <div class="field">
            <label for="priceTabYear">A침o</label>
            <input id="priceTabYear" type="number" min="2020" placeholder="2025">
          </div>
        </div>
        <div class="field">
          <label for="priceTabCustomName">Nombre personalizado</label>
          <input id="priceTabCustomName" placeholder="Ej: Lista especial" />
        </div>
        <div class="field">
          <label for="priceTabBase">Crear nueva usando valores del mes de:</label>
          <select id="priceTabBase"></select>
        </div>
      </div>
      <div class="modal-actions">
        <button id="priceTabCancel" class="ghost-btn">Cancelar</button>
        <button id="priceTabSubmit" class="primary-btn">Crear pesta침a</button>
      </div>
    </div>
  </div>
  <div id="installmentModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Detalle de cuotas</p>
          <h3>Calendario y adelantos</h3>
          <p class="muted">Usa la cuota pura vigente para mostrar adelantos y coberturas.</p>
        </div>
        <button id="installmentClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div id="installmentSummary" class="folio-list"></div>
      <div id="installmentList" class="coverage-grid"></div>
      <div class="modal-actions">
        <button id="installmentCancel" class="ghost-btn">Cerrar</button>
      </div>
    </div>
  </div>
  <div id="priceFilesModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Archivos del mes</p>
          <h3>Explorador</h3>
        </div>
        <button id="priceFilesClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div id="priceFilesList" class="file-list"></div>
    </div>
  </div>
  <div id="priceImportModal" class="modal hidden">
    <div class="modal-content wide">
      <div class="modal-head">
        <div>
          <p class="eyebrow">Precios del mes</p>
          <h3>Importar o exportar valores</h3>
          <p class="muted tiny">Sincroniza con precios.json del mes o carga un archivo manual.</p>
        </div>
        <button id="priceImportClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-body import-grid">
        <div class="card ghost">
          <div class="card-head compact">
            <p class="eyebrow">Carga autom치tica</p>
            <h4>Desde la carpeta del mes</h4>
            <p class="muted tiny">Busca precios.json dentro de la carpeta activa.</p>
          </div>
          <p class="muted tiny" id="serverPricePath">Ruta: -</p>
          <div class="actions compact">
            <button id="reloadServerPrices" class="secondary-btn" type="button"><i class='bx bx-refresh'></i>Cargar desde servidor</button>
          </div>
          <p class="muted tiny" id="serverPriceStatus">Estado: sin cargar</p>
        </div>
        <div class="card ghost">
          <div class="card-head compact">
            <p class="eyebrow">Importaci칩n manual</p>
            <h4>Sube un precios.json</h4>
            <p class="muted tiny">Usa un archivo compatible generado por la plataforma.</p>
          </div>
          <div class="upload-box" id="priceUploadBox">
            <i class='bx bx-upload'></i>
            <p>Arrastra o haz clic para seleccionar</p>
            <p class="muted tiny">Solo archivos .json</p>
            <input type="file" id="priceFileInput" accept="application/json" />
          </div>
          <div class="actions compact">
            <button id="applyPriceFile" class="primary-btn" type="button"><i class='bx bx-check-circle'></i>Aplicar archivo</button>
          </div>
          <p class="muted tiny" id="localPriceStatus">Estado: esperando archivo</p>
        </div>
        <div class="card ghost">
          <div class="card-head compact">
            <p class="eyebrow">Respaldo inmediato</p>
            <h4>Exportar precios actuales</h4>
            <p class="muted tiny">Descarga precios.json listo para subir al servidor.</p>
          </div>
          <div class="actions compact">
            <button id="downloadPriceFile" class="secondary-btn" type="button"><i class='bx bx-download'></i>Descargar precios.json</button>
            <button id="copyPriceJson" class="ghost-btn" type="button"><i class='bx bx-copy'></i>Copiar JSON</button>
          </div>
          <p class="muted tiny" id="exportPriceHint">Incluye todos los importes editados.</p>
        </div>
      </div>
      <div class="modal-actions">
        <button id="priceImportCancel" class="ghost-btn">Cerrar</button>
      </div>
    </div>
  </div>
  <div id="modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <p class="eyebrow" id="modalEyebrow">Confirmaci칩n</p>
          <h3 id="modalTitle"></h3>
          <p class="muted" id="modalMessage"></p>
        </div>
        <button id="modalClose" class="ghost-btn icon-only"><i class='bx bx-x'></i></button>
      </div>
      <div class="modal-actions">
        <button id="modalCancel" class="ghost-btn">Cancelar</button>
        <button id="modalConfirm" class="primary-btn">Aceptar</button>
      </div>
    </div>
  </div>
  <script type="module" src="app.js"></script>
</body>
</html>
